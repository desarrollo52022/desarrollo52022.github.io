"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[6839],{36839:(e,a,l)=>{l.r(a),l.d(a,{default:()=>$});var t=l(59835),i=l(86970);const o={class:"row"},r={class:"col col-xs-12 col-sm-4"},n={class:"row"},c={class:"col"},s={key:0,class:"q-pb-sm"},u={key:1,class:"q-pb-sm"},d={class:"row q-mt-sm"},m={class:"col-xs-12 col-sm-7 col-md-6 col-lg-4"},p={class:"col-xs-12 col-sm-5 col-md-5"},v={class:"row full-height"},w={class:"col col-xs-12 col-sm-12"},f={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},b={class:"row"},h={class:"text-center col-2"},g={class:"text-subtitle2"},C={class:"text-center col-2 border-All"},_={class:"col"};function q(e,a,l,q,D,F){const k=(0,t.up)("KeyPageDetect"),y=(0,t.up)("q-select"),Z=(0,t.up)("q-date"),x=(0,t.up)("q-input"),H=(0,t.up)("q-btn"),V=(0,t.up)("q-icon"),z=(0,t.up)("q-card-section"),S=(0,t.up)("q-card"),W=(0,t.up)("q-table"),Q=(0,t.up)("q-page-sticky"),Y=(0,t.up)("q-page");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(k),(0,t.Wm)(Y,{class:"q-pa-sm"},{default:(0,t.w5)((()=>{var l,q,D,F;return[(0,t._)("div",o,[(0,t._)("div",r,[(0,t._)("div",n,[(0,t._)("div",c,[(0,t.Wm)(y,{filled:"",modelValue:e.series,"onUpdate:modelValue":a[0]||(a[0]=a=>e.series=a),options:e.seriesVendedor,"use-chips":"","stack-label":"",label:"Series de facturación",multiple:""},null,8,["modelValue","options"])])]),(0,t.Uk)(" "+(0,i.zw)(e.factura)+" - "+(0,i.zw)(e.serie),1)])]),e.dates?((0,t.wg)(),(0,t.iD)("div",s," Del: "+(0,i.zw)(null!==(l=e.dates["from"])&&void 0!==l?l:null!==(q=e.dates)&&void 0!==q?q:"")+" al "+(0,i.zw)(null!==(D=e.dates["to"])&&void 0!==D?D:null!==(F=e.dates)&&void 0!==F?F:""),1)):((0,t.wg)(),(0,t.iD)("div",u," Sin fechas ")),(0,t._)("div",d,[(0,t._)("div",m,[(0,t.Wm)(Z,{modelValue:e.dates,"onUpdate:modelValue":a[1]||(a[1]=a=>e.dates=a),range:"","today-btn":"",landscape:""},null,8,["modelValue"])]),(0,t._)("div",p,[(0,t.Wm)(x,{class:"q-mt-lg",modelValue:e.nombreCliente,"onUpdate:modelValue":a[2]||(a[2]=a=>e.nombreCliente=a),type:"text",label:"Nombre del cliente"},null,8,["modelValue"]),(0,t.Wm)(H,{class:"q-pa-sm",color:"primary",icon:"search",label:"Buscar",onClick:e.loadData},null,8,["onClick"])])]),(0,t._)("div",v,[(0,t._)("div",w,[(0,t.Wm)(W,{grid:"",title:"Historial de facturas",filter:e.filter,rows:e.data,columns:e.columns,onRowClick:e.selectFact,"virtual-scroll":"","virtual-scroll-item-size":48,"virtual-scroll-sticky-size-start":48,"rows-per-page-options":[0],pagination:{rowsPerPage:0},loading:e.recargarLoad},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(x,{borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":a[3]||(a[3]=a=>e.filter=a),placeholder:"Buscar factura",clearable:""},{append:(0,t.w5)((()=>[(0,t.Wm)(V,{name:"search"})])),_:1},8,["modelValue"])])),item:(0,t.w5)((a=>[(0,t._)("div",f,[(0,t.Wm)(S,{class:(0,i.C_)(["cursor-pointer q-hoverable",e.factura===a.row.Factura?"shadow-24 bg-grey":""]),onClick:l=>e.selectFact(null,a.row,a.rowIndex)},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{class:"q-pa-none"},{default:(0,t.w5)((()=>[(0,t._)("div",b,[(0,t._)("div",h,[(0,t._)("div",null,(0,i.zw)(e.date.formatDate(a.row.Fecha,"MMM")),1),(0,t._)("div",g,(0,i.zw)(e.date.formatDate(a.row.Fecha,"DD")),1),(0,t._)("div",null,(0,i.zw)(e.date.formatDate(a.row.Fecha,"YYYY")),1)]),(0,t._)("div",C,[(0,t._)("div",null,(0,i.zw)(a.row.Serie),1),(0,t._)("div",null,(0,i.zw)(a.row.Factura),1)]),(0,t._)("div",_,[(0,t._)("div",null,(0,i.zw)(a.row.NitCliente),1),(0,t._)("div",null,(0,i.zw)(a.row.NombreCliente),1),(0,t._)("div",null,"Q."+(0,i.zw)(a.row.Total),1)])])])),_:2},1024)])),_:2},1032,["class","onClick"])])])),_:1},8,["filter","rows","columns","onRowClick","loading"])])]),(0,t.Wm)(Q,{position:"top",offset:[25,40]},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{disable:0===e.factura,class:"q-ma-xs",color:"primary",icon:"send",label:"Enviar Factura: "+e.factura+" - "+e.serie,onClick:e.send},null,8,["disable","label","onClick"]),(0,t.Wm)(H,{disable:0===e.factura,class:"q-ma-xs",color:"primary",icon:"print",label:"Reimprimir "+e.factura+" - "+e.serie,onClick:e.reimprimir},null,8,["disable","label","onClick"]),(0,t.Wm)(H,{disable:0===e.factura,class:"q-ma-xs",color:"primary",icon:"print",label:"Reimprimir directo "+e.factura+" - "+e.serie,onClick:e.imprimir},null,8,["disable","label","onClick"])])),_:1})]})),_:1})],64)}var D=l(34136),F=l(68651),k=l(60499),y=l(30336),Z=l(54170),x=l(67825),H=l(37655),V=l(78618),z=l(17779),S=function(e,a,l,t){function i(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,o){function r(e){try{c(t.next(e))}catch(a){o(a)}}function n(e){try{c(t["throw"](e))}catch(a){o(a)}}function c(e){e.done?l(e.value):i(e.value).then(r,n)}c((t=t.apply(e,a||[])).next())}))};const W=[{name:"Fecha",label:"Fecha",field:"Fecha",align:"center",format:(e,a)=>`${Z.ZP.formatDate(e,"DD-MM-YYYY hh:mm aa")}`},{name:"Nit",label:"Nit",field:"NitCliente",align:"center"},{name:"Cliente",label:"Cliente",field:"NombreCliente",align:"center"},{name:"Total",label:"Total",field:"Total",align:"center"},{name:"Serie",label:"Serie",field:"Serie",align:"center"},{name:"Factura",label:"Factura",field:"Factura",align:"center"},{name:"UUID",label:"UUID",field:"Uuid",align:"center"}],Q=(0,t.aZ)({name:"HistorialFacturas",components:{KeyPageDetect:y.Z},setup(e,{emit:a}){const l=(0,k.iH)([]),t=(0,k.iH)(""),i=(0,k.iH)(0),o=(0,k.iH)(""),r=(0,k.iH)(!1),n=(0,k.iH)(!1),c=(0,k.iH)(""),s=((0,k.iH)(""),(0,k.iH)(!1)),u=(0,k.iH)(""),d=(0,k.iH)([]),m=(0,k.iH)([]),p=Z.ZP.formatDate(Date.now(),"YYYY/MM/DD"),v=(0,k.iH)(p);(0,x.JT)()&&m.value.push((0,x.JT)()),(0,x.V6)()&&m.value.push((0,x.V6)()),(0,x.dS)()&&m.value.push((0,x.dS)()),(0,x.nZ)()&&m.value.push((0,x.nZ)()),d.value=m.value;const w=()=>{var e,a;if(i.value=0,o.value="",r.value=!0,null==v.value)return;const t={FechaInicial:null!==(e=v.value["from"])&&void 0!==e?e:v.value,FechaFinal:null!==(a=v.value["to"])&&void 0!==a?a:v.value,NombreCliente:u.value,Series:d.value};D.api.post(D.endPoints.FACTURAS,t).then((e=>{l.value=e.data.Encabezado})).catch((e=>{(0,F.L1)(e)})).finally((()=>{r.value=!1}))},f=(e,a,l)=>{i.value=0,o.value=a.Serie,c.value=a.Uuid,i.value=a.Factura},b=()=>{window.open(x.qC+c.value,"Facturawt")},h=()=>S(this,void 0,void 0,(function*(){b(),yield(0,V._R)(500),i.value=0,o.value=""})),g=()=>{let e=x.qC+c.value,a="Puede ver tú factura en el siguiente enlace \n "+e;var l="https://wa.me/?text="+a;window.open(l,"Facturawt")},C=()=>{let e={printer:(0,x.LX)(),url:x.qC+c.value,filename:"factura.pdf"};(0,H.Q)("Imprimiendo..."),D.api.post("http://localhost:8001",e).then((e=>{z.log(e.data),(0,F.dF)(e.data)})).catch((e=>{z.log(e),(0,F.L1)(e)})).finally((()=>{(0,H.E)()}))};return{date:Z.ZP,loadData:w,selectFact:f,reimprimir:h,send:g,imprimir:C,factura:i,serie:o,data:l,loadError:n,recargarLoad:r,columns:W,filter:t,showImprimir:s,dates:v,nombreCliente:u,series:d,seriesVendedor:m}},created(){this.loadData()}});var Y=l(11639),P=l(69885),U=l(68879),T=l(26384),I=l(92952),N=l(13119),M=l(84277),R=l(22857),L=l(44458),E=l(63190),A=l(50926),B=l(30627),J=l(69984),K=l.n(J);const X=(0,Y.Z)(Q,[["render",q]]),$=X;K()(Q,"components",{QPage:P.Z,QBtn:U.Z,QSelect:T.Z,QDate:I.Z,QInput:N.Z,QTable:M.Z,QIcon:R.Z,QCard:L.Z,QCardSection:E.Z,QSeparator:A.Z,QPageSticky:B.Z})}}]);