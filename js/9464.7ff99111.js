"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[9464],{39464:(e,o,a)=>{a.r(o),a.d(o,{default:()=>ba});var l=a(59835),i=a(86970),t=a(61957);const n=e=>((0,l.dD)("data-v-6eb4c562"),e=e(),(0,l.Cn)(),e),d={class:"row items-center"},r=(0,l.Uk)(" Nueva Orden "),s=(0,l.Uk)(" (Ctrl+Espacio) "),u=(0,l.Uk)(" Anular Orden "),c=(0,l.Uk)(" (Delete/Supr) "),v=n((()=>(0,l._)("div",{class:"q-ml-md cursor-pointer non-selectable",id:"layout-anular-pedido"},null,-1))),p=n((()=>(0,l._)("div",{class:"no-pointer non-selectable"},null,-1))),m={class:"text-h5"},g={class:"text-h6"},h={class:"row q-gutter-md q-pb-md"},b={class:"row"},f={class:"col col-xs-12 col-sm-8",style:{}},P={class:"row items-center no-wrap",id:"pos-opcion-ticket"},D={class:"text-center"},w=n((()=>(0,l._)("br",null,null,-1))),C={class:"row items-center no-wrap",id:"pos-opcion-may"},y={class:"text-center"},E=n((()=>(0,l._)("br",null,null,-1))),_={class:"row justify-center"},k={key:0,class:"col-12 row"},O={class:"col-xs-12 col-sm-5 col-md-4"},N={class:"q-ma-sm row"},I={key:1},T={key:2,class:"col col-xs-12 col-sm-12 col-md-12 col-lg-6"},x={class:"row"},S={class:"col-sm-8 col-md-5"},V={key:0,class:"text-red text-caption border-radius-inherit",style:{display:"inline-block"}},R={class:"row"},H={class:"col-sm-12 col-md-6"},A={class:"col-sm-12 col-md-6"},L={class:"row"},W={class:"col-sm-12 col-md-6"},q={class:"col-sm-12 col-md-6"},F={class:"row"},M={class:"col-sm-12 col-md-6"},U={class:"col-sm-12 col-md-6"},z={class:"col col-xs-12 col-sm-4 q-pl-lg"},Z={class:"row"},Q={class:"col-xs-12 col-md-6"},Y=n((()=>(0,l._)("div",{class:"text-subtitle2"},"No. Orden de Instalación",-1))),B={class:"text-h4"},j={key:0,class:"text-h6"},G=n((()=>(0,l._)("div",{class:"col-xs-12 col-md-6"},null,-1))),K=n((()=>(0,l._)("div",{class:"text-subtitle2"},"Subtotal",-1))),$={class:"text-h4"},X={class:"row q-pa-sm"},J=n((()=>(0,l._)("h6",null,"Datos de Orden de Instalación",-1))),ee={class:"row"},oe={class:"q-ma-xs col-xs-12 col-md-3"},ae={class:"q-ma-xs col-xs-12 col-md-5"},le={class:"q-ma-xs col-xs-12 col-md-3"},ie={class:"row"},te={class:"q-ma-xs col-xs-11 col-md-11"},ne={class:"row q-pa-sm"},de={class:"row"},re={key:0},se=(0,l.Uk)(" (Mostrar Productos Sugeridos) "),ue={key:0,class:"q-pl-md"},ce={key:0},ve={key:2},pe=n((()=>(0,l._)("thead",{class:"bg-secondary"},[(0,l._)("tr",null,[(0,l._)("th",{class:"text-center bg-grey"},"Código"),(0,l._)("th",{class:"text-center bg-grey"},"Descripción"),(0,l._)("th",{class:"text-center bg-grey"},"Factor")])],-1))),me=["onDblclick"],ge={class:"text-center"},he={class:"text-center"},be={class:"text-center"},fe={key:0,class:"row"},Pe={class:"col-xs-12 col-sm-4 border-R"},De={class:"text-h4 text-center"},we={class:"col-xs-9 col-sm-5 border-R"},Ce={class:"text-h4 text-center"},ye=n((()=>(0,l._)("div",{class:"col-3 text-center"},null,-1))),Ee={class:"row"},_e={class:"col-xs-12 col-sm-12 col-md-5"},ke={key:0,class:"bg-red text-h6 q-ma-xs"},Oe={class:"row"},Ne={class:"col col-xs-12 col-sm-8"},Ie={class:"col col-xs-12 col-sm-3 q-mr-sm q-mt-xs"},Te=n((()=>(0,l._)("br",null,null,-1))),xe={key:1,class:"col col-5 text-subtitle2 q-pa-xs"},Se=n((()=>(0,l._)("br",null,null,-1))),Ve=(0,l.Uk)(" Subtotal:"),Re={class:"bg-secondary q-pa-xs",style:{display:"inline-block"}},He={class:"col-xs-12 col-sm-7 col-md-4 q-pa-sm",id:"pos-precios"},Ae=n((()=>(0,l._)("thead",{class:"bg-secondary"},[(0,l._)("tr",null,[(0,l._)("th",{class:"text-center"},"Inicial"),(0,l._)("th",{class:"text-center"},"Final"),(0,l._)("th",{class:"text-center"},"Precio"),(0,l._)("th",{class:"text-center"},"Existencia"),(0,l._)("th",{class:"text-center"},"Reserva")])],-1))),Le={class:"text-center"},We={class:"text-center"},qe={class:"text-center"},Fe=["rowspan"],Me=["rowspan"],Ue={key:0,class:"col-xs-12 col-sm-4 col-md-3 q-pa-sm",id:"pos-ums"},ze=n((()=>(0,l._)("thead",{class:"bg-secondary"},[(0,l._)("tr",null,[(0,l._)("th",{class:"text-center bg-grey"},"Código"),(0,l._)("th",{class:"text-center bg-grey"},"Descripción"),(0,l._)("th",{class:"text-center bg-grey"},"Factor")])],-1))),Ze=["onDblclick"],Qe={class:"text-center"},Ye={class:"text-center"},Be={class:"text-center"},je={class:"row q-ma-md"},Ge={class:"row"},Ke={class:"q-gutter-md row items-start"},$e={class:"col"},Xe={class:"col"},Je={class:"q-gutter-md row items-start"},eo={class:"col"},oo={class:"col"};function ao(e,o,a,n,ao,lo){const io=(0,l.up)("q-tooltip"),to=(0,l.up)("q-space"),no=(0,l.up)("q-bar"),ro=(0,l.up)("KeyPageDetect"),so=(0,l.up)("ProductosOfertadosDialog"),uo=(0,l.up)("q-card-section"),co=(0,l.up)("q-input"),vo=(0,l.up)("q-btn"),po=(0,l.up)("q-card-actions"),mo=(0,l.up)("q-card"),go=(0,l.up)("q-dialog"),ho=(0,l.up)("OrdenesPendientes"),bo=(0,l.up)("q-icon"),fo=(0,l.up)("q-btn-toggle"),Po=(0,l.up)("q-option-group"),Do=(0,l.up)("ClientesDialog"),wo=(0,l.up)("PuntosCliente"),Co=(0,l.up)("AClientesDialog"),yo=(0,l.up)("q-checkbox"),Eo=(0,l.up)("q-form"),_o=(0,l.up)("DespacharPendientes"),ko=(0,l.up)("q-separator"),Oo=(0,l.up)("q-select"),No=(0,l.up)("q-td"),Io=(0,l.up)("q-table"),To=(0,l.up)("ReservasDialog"),xo=(0,l.up)("ProductosBuscados"),So=(0,l.up)("qrscannerVue"),Vo=(0,l.up)("q-markup-table"),Ro=(0,l.up)("ProductsDialog"),Ho=(0,l.up)("q-popup-edit"),Ao=(0,l.up)("q-date"),Lo=(0,l.up)("q-time"),Wo=(0,l.up)("q-page"),qo=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(no,{dark:"",class:"bg-primary text-white"},{default:(0,l.w5)((()=>[(0,l._)("div",d,[e.$q.platform.is.mobile?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:"q-ml-md cursor-pointer non-selectable",onClick:o[0]||(o[0]=(...o)=>e.abrirCaja&&e.abrirCaja(...o)),id:"layout-abrir-caja"}," Abrir caja ")),(0,l._)("div",{class:"q-ml-md cursor-pointer non-selectable",onClick:o[1]||(o[1]=()=>{e.numeroPedido=0,e.numeroOrden=0}),id:"layout-nuevo-pedido"},[r,(0,l.Wm)(io,null,{default:(0,l.w5)((()=>[s])),_:1})]),0!==e.numeroOrden&&"C"===e.estadoOrden?((0,l.wg)(),(0,l.iD)("div",{key:1,class:"q-ml-md cursor-pointer non-selectable",onClick:o[2]||(o[2]=(...o)=>e.anularPedido&&e.anularPedido(...o)),id:"layout-anular-pedido"},[u,(0,l.Wm)(io,null,{default:(0,l.w5)((()=>[c])),_:1})])):(0,l.kq)("",!0),v,(0,l.Wm)(to),p])])),_:1}),(0,l.Wm)(Wo,{padding:""},{default:(0,l.w5)((()=>[(0,l.Wm)(ro,{keys:["F3","C+A","C+ ","Delete","C+R","C+D"],onMyKeyDown:e.pageKey},null,8,["onMyKeyDown"]),(0,l.Wm)(so,{NivelPrecio:e.nivelPrecio,onSelectProd:e.productoDialog},null,8,["NivelPrecio","onSelectProd"]),(0,l.Wm)(go,{modelValue:e.prompt,"onUpdate:modelValue":o[5]||(o[5]=o=>e.prompt=o),onHide:o[6]||(o[6]=o=>e.numeroReimp=null)},{default:(0,l.w5)((()=>[(0,l.Wm)(mo,{style:{"min-width":"350px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(uo,null,{default:(0,l.w5)((()=>[(0,l._)("div",m," Reimpresión de "+(0,i.zw)(e.textReimpresion),1)])),_:1}),(0,l.Wm)(uo,null,{default:(0,l.w5)((()=>[(0,l._)("div",g," Número de "+(0,i.zw)(e.textReimpresion),1)])),_:1}),(0,l.Wm)(uo,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(co,{dense:"",modelValue:e.numeroReimp,"onUpdate:modelValue":o[3]||(o[3]=o=>e.numeroReimp=o),autofocus:"",onKeyup:o[4]||(o[4]=(0,t.D2)((()=>{e.prompt=!1,e.reimprimirFactDoc()}),["enter"]))},null,8,["modelValue"])])),_:1}),(0,l.Wm)(po,{align:"right",class:"text-primary"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(vo,{flat:"",label:"Cancel"},null,512),[[qo]]),(0,l.wy)((0,l.Wm)(vo,{flat:"",label:"Reimprimir",onClick:e.reimprimirFactDoc},null,8,["onClick"]),[[qo]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l._)("div",h,[(0,l.Wm)(ho,{onSetPedido:e.setNumeroPedido},null,8,["onSetPedido"]),(0,l.Wm)(vo,{label:"Detalle Ordenes",dense:"",outline:"",color:"green",icon:"event_note",onClick:o[7]||(o[7]=o=>e.$router.push({name:"EstadoOrdenes"}))}),(0,l.Wm)(vo,{label:"Historial Ordenes",dense:"",outline:"",color:"blue",icon:"work_history",onClick:o[8]||(o[8]=o=>e.$router.push({name:"HistorialOrdenes"}))})]),(0,l._)("div",b,[(0,l._)("div",f,[(0,l.Wm)(fo,{disable:e.numeroPedido>0,class:"q-ma-xs",modelValue:e.tipoPedido,"onUpdate:modelValue":o[9]||(o[9]=o=>e.tipoPedido=o),push:"",spread:"",rounded:"","toggle-color":"negative",color:"white","text-color":"black",options:[{value:1,slot:"ticket",disable:!e.enableTicket},{value:2,slot:"mayorista",disable:!e.enableMayorista}]},{ticket:(0,l.w5)((()=>[(0,l._)("div",P,[(0,l._)("div",D,[(0,l.Uk)(" Ordenes - "+(0,i.zw)(e.clientePOS)+" ",1),w,1===e.tipoPedido?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Uk)(" Nivel: "+(0,i.zw)(e.nivelPrecio)+" - "+(0,i.zw)(e.descripcionNivel),1)],64)):(0,l.kq)("",!0)]),(0,l.Wm)(bo,{right:"",name:"handyman"})])])),mayorista:(0,l.w5)((()=>[(0,l._)("div",C,[(0,l._)("div",y,[(0,l.Uk)(" Mayorista - "+(0,i.zw)(e.codigoCliente),1),E,2===e.tipoPedido?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Uk)(" Nivel: "+(0,i.zw)(e.nivelPrecio)+" - "+(0,i.zw)(e.descripcionNivel),1)],64)):(0,l.kq)("",!0)]),(0,l.Wm)(bo,{right:"",name:"credit_score"})])])),_:1},8,["disable","modelValue","options"]),(0,l._)("div",_,[2===e.tipoPedido?((0,l.wg)(),(0,l.j4)(Po,{key:0,for:"pos-tipo",disable:e.numeroPedido>0,class:"q-ml-md",modelValue:e.opcion,"onUpdate:modelValue":o[10]||(o[10]=o=>e.opcion=o),options:[{label:"Pedido",value:"S"},{label:"Cotización",value:"M"}],color:"negative",inline:""},null,8,["disable","modelValue"])):(0,l.kq)("",!0)]),(0,l.Wm)(Eo,{ref:"formEncRef"},{default:(0,l.w5)((()=>[2===e.tipoPedido?((0,l.wg)(),(0,l.iD)("div",k,[(0,l.Wm)(Do,{id:"pos-buscar-clientes",clienteTicket:e.clientePOS,onSelectCliente:e.clienteDialog,ref:"botonClientes"},null,8,["clienteTicket","onSelectCliente"]),(0,l.Wm)(co,{for:"pos-codigo-cliente",disable:e.numeroPedido>0,class:"col-xs-10 col-sm-5 col-md-7",outlined:"",label:"Codigo de cliente",modelValue:e.codigoCliente,"onUpdate:modelValue":o[11]||(o[11]=o=>e.codigoCliente=o),dense:"",type:"number",debounce:"500",ref:"codigoClienteRef",rules:[e=>!!e||"Debe ingresar el código",o=>o!==e.clientePOS.toString()||"El cliente no puede ser el cliente Ticket"],"hide-bottom-space":"",onKeydownCapture:o[12]||(o[12]=o=>e.keyDownCliente(o)),standout:""},null,8,["disable","modelValue","rules"]),(0,l._)("div",O,[(0,l.Wm)(wo,{Cliente:e.codigoCliente!==e.clientePOS?e.codigoCliente:null},null,8,["Cliente"])])])):(0,l.kq)("",!0),(0,l._)("div",N,[1===e.tipoPedido?((0,l.wg)(),(0,l.j4)(Co,{key:0,id:"pos-buscar-aclientes","cliente-ticket":e.clientePOS,onSelectCliente:e.aclienteDialog},null,8,["cliente-ticket","onSelectCliente"])):(0,l.kq)("",!0),e.$q.platform.is.mobile?((0,l.wg)(),(0,l.iD)("div",I,[1===e.tipoPedido?((0,l.wg)(),(0,l.j4)(vo,{key:0,color:"negative",label:"CF",onClick:o[13]||(o[13]=o=>e.nuevoCF()),outline:""})):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l.Wm)(Po,{modelValue:e.tipo_especial,"onUpdate:modelValue":o[14]||(o[14]=o=>e.tipo_especial=o),color:"secondary",inline:"",class:"q-mr-sm",options:[{label:"NIT",value:"NIT"},{label:"DPI",value:"DPI"}]},null,8,["modelValue"]),(0,l._)("div",{class:(0,i.C_)([2===e.tipoPedido?"col col-xs-12":"col-xs-12","row"])},[(0,l.Wm)(co,{autofocus:"",for:"pos-nit",disable:e.numeroPedido>0||2===e.tipoPedido,class:"col-xs-7 col-sm-8 col-md-9",outlined:"",label:"NIT/DPI",ref:"NITRef",modelValue:e.NIT,"onUpdate:modelValue":o[16]||(o[16]=o=>e.NIT=o),loading:e.loadingNit,dense:"",debounce:"500",onKeydownCapture:o[17]||(o[17]=o=>e.setCF(o)),onKeypress:(0,t.D2)(e.consultarNit,["enter"]),rules:[e=>!!e||"Debe ingresar el Nit del cliente"],"hide-bottom-space":""},(0,l.Nv)({append:(0,l.w5)((()=>[])),_:2},[e.NIT&&0===e.numeroPedido&&1===e.tipoPedido?{name:"prepend",fn:(0,l.w5)((()=>[(0,l.Wm)(bo,{name:"cancel",onClick:o[15]||(o[15]=(0,t.iM)((o=>e.NIT=null),["stop"])),class:"cursor-pointer"})]))}:void 0]),1032,["disable","modelValue","loading","onKeypress","rules"]),(0,l.Wm)(yo,{id:"pos-validaNit",class:"text-subtitle2",modelValue:e.validarNit,"onUpdate:modelValue":o[18]||(o[18]=o=>e.validarNit=o),label:"Validar NIT","checked-icon":"task_alt","unchecked-icon":"highlight_off"},null,8,["modelValue"])],2),2===e.tipoPedido?((0,l.wg)(),(0,l.iD)("div",T,[e.tieneRuteros?((0,l.wg)(),(0,l.j4)(yo,{key:0,disable:e.numeroPedido>0,"left-label":"",modelValue:e.pedidoRuteros,"onUpdate:modelValue":o[19]||(o[19]=o=>e.pedidoRuteros=o),label:"Pedido Ruta"},null,8,["disable","modelValue"])):(0,l.kq)("",!0),e.pedidoRuteros?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(Po,{key:1,style:{display:"inline-block"},disable:e.numeroPedido>0,modelValue:e.creditoContado,"onUpdate:modelValue":o[20]||(o[20]=o=>e.creditoContado=o),inline:"",options:[{label:"Contado",value:!1,checkedIcon:"task_alt",uncheckedIcon:"panorama_fish_eye"},{label:"Credito",value:!0,checkedIcon:"task_alt",uncheckedIcon:"panorama_fish_eye"}],color:"negative"},null,8,["disable","modelValue"])),(0,l._)("div",x,[(0,l._)("div",S,[(0,l.Wm)(t.uT,{appear:"","enter-active-class":"animated heartBeat"},{default:(0,l.w5)((()=>[e.errorCreditoContado?((0,l.wg)(),(0,l.iD)("div",V," Debe seleccionar la condición de crédito ")):(0,l.kq)("",!0)])),_:1})])])])):(0,l.kq)("",!0)]),(0,l._)("div",R,[(0,l._)("div",H,[(0,l.Wm)(co,{for:"pos-nombre",readonly:e.numeroPedido>0||2===e.tipoPedido,class:"q-ma-sm",outlined:"",label:"Nombre del cliente",modelValue:e.nombreCliente,"onUpdate:modelValue":o[21]||(o[21]=o=>e.nombreCliente=o),dense:"",rules:[e=>"Nit no valido"!==e||"Debe ingresar un Nit valido",e=>!!e||"Debe ingresar el nombre a facturar",e=>e.length<=60||"El nombre no puede ser mayor a 60 caracteres"],"hide-bottom-space":""},null,8,["readonly","modelValue","rules"])]),(0,l._)("div",A,[(0,l.Wm)(co,{for:"pos-direccion",readonly:e.numeroPedido>0||2===e.tipoPedido,class:"q-ma-sm",outlined:"",label:"Dirección de Facturación",modelValue:e.direccionCliente,"onUpdate:modelValue":o[22]||(o[22]=o=>e.direccionCliente=o),dense:"",rules:[e=>!!e||"Debe ingresar la dirección del cliente a facturar",e=>e.length<=60||"La dirección no puede ser mayor a 60 caracteres"],"hide-bottom-space":""},null,8,["readonly","modelValue","rules"])])]),(0,l.Wm)(co,{modelValue:e.observacion,"onUpdate:modelValue":o[23]||(o[23]=o=>e.observacion=o),class:"q-ma-sm",type:"text",label:"Observaciones Ordenes",outlined:"",dense:"",rules:[e=>e.length<=70||"La observación no puede ser mayor a 70 caracteres"],"hide-bottom-space":""},(0,l.Nv)({_:2},[e.numeroPedido>0?{name:"append",fn:(0,l.w5)((()=>[(0,l.Wm)(vo,{round:"",dense:"",flat:"",icon:"save","text-color":"green",onClick:e.guardarObservacion},null,8,["onClick"])]))}:void 0]),1032,["modelValue","rules"]),(0,l._)("div",L,[(0,l._)("div",W,[(0,l.Wm)(co,{modelValue:e.telefonoCliente,"onUpdate:modelValue":o[24]||(o[24]=o=>e.telefonoCliente=o),readonly:e.numeroPedido>0||2===e.tipoPedido,type:"tel",label:"Numero de Teléfono del Cliente",class:"q-ma-sm",outlined:"",dense:"","hide-bottom-space":"",rules:[e=>!!e||"Debe ingresar el numero de Teléfono",e=>8===e.length||"El numero de teléfono debe ser de 8 Digitos"]},{append:(0,l.w5)((()=>[(0,l.Wm)(bo,{name:"local_phone"})])),_:1},8,["modelValue","readonly","rules"])]),(0,l._)("div",q,[(0,l.Wm)(co,{readonly:e.numeroPedido>0||2===e.tipoPedido,modelValue:e.direccionInstalacion,"onUpdate:modelValue":o[25]||(o[25]=o=>e.direccionInstalacion=o),type:"text",class:"q-ma-sm",label:"Dirección de Instalacion",outlined:"",dense:"","hide-bottom-space":"",rules:[e=>!!e||"Debe Ingresar la Dirección de Instalacion",e=>e.length<=60||"La direccion de Instalacion no puede ser mayor a 60 Caracteres"]},null,8,["readonly","modelValue","rules"])])]),(0,l._)("div",F,[(0,l._)("div",M,[(0,l.Wm)(co,{for:"pos-correo",readonly:e.numeroPedido>0||2===e.tipoPedido,class:"q-ma-sm",outlined:"",label:"Correo electrónico",modelValue:e.correoCliente,"onUpdate:modelValue":o[26]||(o[26]=o=>e.correoCliente=o),dense:"",rules:[o=>e.validateEmail(o)||"Debe ingresar un email con el formato correcto"],"hide-bottom-space":""},{append:(0,l.w5)((()=>[(0,l.Wm)(bo,{name:"alternate_email"})])),_:1},8,["readonly","modelValue","rules"])]),(0,l._)("div",U,[(0,l.Wm)(co,{for:"pos-correo",class:"q-ma-sm",modelValue:e.dateString,"onUpdate:modelValue":o[28]||(o[28]=o=>e.dateString=o),label:"Fecha y Hora Inicio de Instalacion",dense:"",round:"",flat:"",readonly:!0,"hide-bottom-space":""},(0,l.Nv)({_:2},[e.numeroPedido>0?{name:"append",fn:(0,l.w5)((()=>[0!==e.numeroPedido?((0,l.wg)(),(0,l.j4)(vo,{key:0,id:"pos-date",disable:e.loadingNit||null===e.serie,icon:"calendar_month",color:"positive",onClick:o[27]||(o[27]=o=>e.showModalDate=!0)},null,8,["disable"])):(0,l.kq)("",!0)]))}:void 0]),1032,["modelValue"]),(0,l.Wm)(co,{for:"pos-correo",class:"q-ma-sm",modelValue:e.dateStringFin,"onUpdate:modelValue":o[30]||(o[30]=o=>e.dateStringFin=o),label:"Fecha y Hora Final de Instalacion",dense:"",round:"",flat:"",readonly:!0,"hide-bottom-space":""},(0,l.Nv)({_:2},[e.numeroPedido>0?{name:"append",fn:(0,l.w5)((()=>[0!==e.numeroPedido?((0,l.wg)(),(0,l.j4)(vo,{key:0,id:"pos-date",disable:e.loadingNit||null===e.serie,icon:"calendar_month",color:"negative",onClick:o[29]||(o[29]=o=>e.showModalDateFin=!0)},null,8,["disable"])):(0,l.kq)("",!0)]))}:void 0]),1032,["modelValue"])])])])),_:1},512)]),(0,l._)("div",z,[(0,l.Wm)(mo,null,{default:(0,l.w5)((()=>[(0,l.Wm)(uo,{class:"no-padding"},{default:(0,l.w5)((()=>[(0,l.Wm)(_o,{id:"pos-despachar",onCargarPedido:e.despachado},null,8,["onCargarPedido"])])),_:1}),(0,l.Wm)(uo,{id:"pos-pedido"},{default:(0,l.w5)((()=>[(0,l._)("div",Z,[(0,l._)("div",Q,[Y,(0,l._)("div",B,(0,i.zw)(e.numeroOrden),1),""!==e.estadoOrden?((0,l.wg)(),(0,l.iD)("div",j,(0,i.zw)("C"===e.estadoOrden?"En creación":"En proceso"),1)):(0,l.kq)("",!0)]),G])])),_:1}),(0,l.Wm)(ko,{color:"red"}),(0,l.Wm)(uo,{id:"pos-subtotal"},{default:(0,l.w5)((()=>[K,(0,l._)("div",$,"Q."+(0,i.zw)(e.subTotal),1)])),_:1}),0===e.numeroPedido?((0,l.wg)(),(0,l.j4)(vo,{key:0,id:"pos-crear-pedido",disable:e.loadingNit||null===e.serie,class:"q-ma-sm",label:"Crear Orden (F3)",color:"negative",onClick:e.crearOrden},null,8,["disable","onClick"])):(0,l.kq)("",!0),0!==e.numeroPedido&&"S"===e.estadoOrden?((0,l.wg)(),(0,l.j4)(vo,{key:1,id:"pos-convertir",disable:e.loadingNit||null===e.serie,class:"q-ma-sm",label:"Terminar y Facturar",color:"negative",onClick:o[31]||(o[31]=o=>e.convertirOrden("T"))},null,8,["disable"])):(0,l.kq)("",!0),0!==e.numeroPedido&&"C"===e.estadoOrden?((0,l.wg)(),(0,l.j4)(vo,{key:2,id:"pos-convertir",disable:e.loadingNit||null===e.serie,class:"q-ma-sm",label:"Procesar Orden",color:"indigo",onClick:o[32]||(o[32]=o=>e.convertirOrden("S"))},null,8,["disable"])):(0,l.kq)("",!0),0!==e.numeroPedido&&"C"!==e.estadoOrden?((0,l.wg)(),(0,l.j4)(vo,{key:3,id:"pos-imprimir",disable:e.loadingNit||null===e.serie,class:"q-ma-sm",label:"Imprimir Orden",color:"positive",onClick:e.reporteOrdenesInstalacion},null,8,["disable","onClick"])):(0,l.kq)("",!0)])),_:1})])]),(0,l._)("div",X,[(0,l.Wm)(mo,{class:"scroll col"},{default:(0,l.w5)((()=>[(0,l.Wm)(no,{class:"col-12 bg-white"},{default:(0,l.w5)((()=>[J,(0,l.Wm)(to),(0,l.Wm)(vo,{color:"positive",size:"14px",icon:"add",label:"Agregar",onClick:e.altaOrdenDet},null,8,["onClick"])])),_:1}),(0,l._)("div",ee,[(0,l._)("div",oe,[(0,l.Wm)(Oo,{filled:"",modelValue:e.modelOrden,"onUpdate:modelValue":[o[33]||(o[33]=o=>e.modelOrden=o),o[34]||(o[34]=o=>{e.getTipoInstalacion(o.value)})],options:e.optionsOrden,label:"TIPO ORDEN"},null,8,["modelValue","options"])]),(0,l._)("div",ae,[(0,l.Wm)(Oo,{outlined:"",modelValue:e.modelInstalacion,"onUpdate:modelValue":o[35]||(o[35]=o=>e.modelInstalacion=o),options:e.optionsInstalacion,label:"TIPO SERVICIO DE INSTALACIÓN"},null,8,["modelValue","options"])]),(0,l._)("div",le,[(0,l.Wm)(Oo,{outlined:"","use-chips":"",multiple:"",modelValue:e.modelTecnicos,"onUpdate:modelValue":o[36]||(o[36]=o=>e.modelTecnicos=o),options:e.optionsTecnicos,label:"TÉCNICOS"},null,8,["modelValue","options"])])]),(0,l._)("div",ie,[(0,l._)("div",te,[(0,l.Wm)(Io,{class:"puntosDialog",rows:e.rows,columns:e.columns_orden,columns_filter:!1},{"body-cell-Horas":(0,l.w5)((o=>[(0,l.Wm)(No,{props:o,style:{padding:"0px",width:"5px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(vo,{outline:"",color:"blue",icon:"watch_later",class:"",onClick:a=>e.mostrarModal(o.row)},null,8,["onClick"])])),_:2},1032,["props"])])),"body-cell-Eliminar":(0,l.w5)((o=>[(0,l.Wm)(No,{props:o,style:{padding:"0px",width:"5px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(vo,{outline:"",color:"red",icon:"delete_forever",class:"",onClick:a=>e.eliminarOrdenDet(o.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["rows","columns"])])]),(0,l.Wm)(ko,{color:"red"})])),_:1})]),(0,l._)("div",ne,[(0,l.Wm)(mo,{class:(0,i.C_)("scroll col "+(e.inFullscreen?"fullscreen":""))},{default:(0,l.w5)((()=>[(0,l._)("div",de,[(0,l.Wm)(no,{class:"col-12 bg-white"},{default:(0,l.w5)((()=>[(0,l.Wm)(To,{initProducto:e.maestroProducto,initLote:e.lote},null,8,["initProducto","initLote"]),(0,l.Wm)(xo),(0,l.Wm)(t.uT,{"enter-active-class":"animated heartBeat slower","leave-active-class":"animated heartBeat slower"},{default:(0,l.w5)((()=>[0!==e.numeroOrden?((0,l.wg)(),(0,l.iD)("div",re,[(0,l.Wm)(io,null,{default:(0,l.w5)((()=>[se])),_:1}),(0,l.Wm)(vo,{color:"indigo",label:"Sugeridos",onClick:o[37]||(o[37]=o=>e.mostrarModalDetalle())})])):(0,l.kq)("",!0)])),_:1}),e.$q.platform.is.mobile?((0,l.wg)(),(0,l.iD)("div",ue,[e.$q.platform.is.nativeMobile?((0,l.wg)(),(0,l.iD)("div",ce,[e.$q.platform.is.android?((0,l.wg)(),(0,l.j4)(vo,{key:0,class:"full-width",color:"negative",icon:"qr_code_scanner",onClick:e.scanBarraCordova},null,8,["onClick"])):(0,l.kq)("",!0)])):((0,l.wg)(),(0,l.j4)(So,{key:1,onBarra:e.scanBarra},null,8,["onBarra"]))])):(0,l.kq)("",!0),e.$q.platform.is.mobile?((0,l.wg)(),(0,l.j4)(to,{key:1})):(0,l.kq)("",!0),e.$q.platform.is.mobile?((0,l.wg)(),(0,l.iD)("div",ve,[(0,l.Wm)(vo,{color:"negative",label:"UM",onClick:o[39]||(o[39]=o=>e.showUMTool=!e.showUMTool)},{default:(0,l.w5)((()=>[(0,l.Wm)(io,{modelValue:e.showUMTool,"onUpdate:modelValue":o[38]||(o[38]=o=>e.showUMTool=o),anchor:"top middle",self:"bottom middle"},{default:(0,l.w5)((()=>[(0,l.Wm)(Vo,{dense:"",flat:"",bordered:"",separator:"cell"},{default:(0,l.w5)((()=>[pe,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.ums,(o=>((0,l.wg)(),(0,l.iD)("tr",{key:o.Codigo,onDblclick:a=>e.cantidadPedir=o.Factor,class:"cursor-pointer q-hoverable",style:{"user-select":"none"}},[(0,l._)("td",ge,(0,i.zw)(o.Codigo),1),(0,l._)("td",he,(0,i.zw)(o.Descripcion),1),(0,l._)("td",be,(0,i.zw)(o.Factor),1)],40,me)))),128))])])),_:1})])),_:1},8,["modelValue"])])),_:1})])):(0,l.kq)("",!0),(0,l.Wm)(to),(0,l.Wm)(vo,{flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:o[40]||(o[40]=o=>e.inFullscreen=!e.inFullscreen),class:"q-ml-md",size:"lg"},null,8,["icon"])])),_:1})]),e.inFullscreen?((0,l.wg)(),(0,l.iD)("div",fe,[(0,l._)("div",Pe,[(0,l._)("div",De,"Orden: "+(0,i.zw)(e.numeroOrden),1)]),(0,l._)("div",we,[(0,l._)("div",Ce,"Subtotal: Q."+(0,i.zw)(e.subTotal),1)]),ye])):(0,l.kq)("",!0),(0,l.Wm)(uo,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l._)("div",Ee,[(0,l._)("div",_e,[(0,l.Wm)(Eo,{ref:"formDetRef"},{default:(0,l.w5)((()=>[e.enableEliminar?((0,l.wg)(),(0,l.iD)("div",ke," Eliminando Producto "+(0,i.zw)(e.producto),1)):(0,l.kq)("",!0),(0,l._)("div",Oe,[(0,l._)("div",Ne,[(0,l.Wm)(co,{for:"pos-producto",disable:e.loadAgregando,"input-class":"text-uppercase",label:"Producto",dense:"",modelValue:e.producto,"onUpdate:modelValue":o[44]||(o[44]=o=>e.producto=o),class:"q-pr-md",color:"black",debounce:e.debounceProducto,onKeypress:o[45]||(o[45]=o=>e.keyPressProducto(o)),onKeydownCapture:o[46]||(o[46]=o=>e.keyDownProducto(o)),ref:"productoRef","hide-bottom-space":"",loading:e.loadProducto||e.loadAgregando,rules:[e=>!!e||"Debe ingresar un producto"],clearable:""},{append:(0,l.w5)((()=>[(0,l.Wm)(yo,{id:"pos-check-cantidad",modelValue:e.enableCantidad,"onUpdate:modelValue":o[41]||(o[41]=o=>e.enableCantidad=o),"checked-icon":"shopping_cart_checkout","unchecked-icon":"remove_shopping_cart","keep-color":""},null,8,["modelValue"])])),prepend:(0,l.w5)((()=>[(0,l.Wm)(Ro,{id:"pos-buscar-producto",producto:e.maestroProducto,nivel:null!==e.nivelPrecio?e.nivelPrecio:0,onSelectProd:e.productoDialog,onAgregarLote:e.agregarProductoLote,ref:"botonProd"},null,8,["producto","nivel","onSelectProd","onAgregarLote"])])),before:(0,l.w5)((()=>[e.$q.platform.is.nativeMobile?((0,l.wg)(),(0,l.j4)(yo,{key:0,id:"pos-eliminar-prod",class:"q-pa-sm",modelValue:e.enableConsulta,"onUpdate:modelValue":o[42]||(o[42]=o=>e.enableConsulta=o),size:"lg","checked-icon":"manage_search","unchecked-icon":"search_off","keep-color":"",dense:""},null,8,["modelValue"])):(0,l.kq)("",!0),(0,l.Wm)(yo,{id:"pos-eliminar-prod",class:"q-ma-none q-pa-none",modelValue:e.enableEliminar,"onUpdate:modelValue":o[43]||(o[43]=o=>e.enableEliminar=o),size:!1===e.enableEliminar?"md":"xl",color:!1===e.enableEliminar?"black":"red","checked-icon":"delete_forever","unchecked-icon":"delete","keep-color":"",dense:""},null,8,["modelValue","size","color"])])),_:1},8,["disable","modelValue","debounce","loading","rules"])]),(0,l._)("div",Ie,[(0,l.Wm)(co,{for:"pos-cantidad",label:"Cantidad",dense:"",type:"number",modelValue:e.cantidadPedir,"onUpdate:modelValue":o[47]||(o[47]=o=>e.cantidadPedir=o),disable:!e.enableCantidad,onKeydownCapture:o[48]||(o[48]=o=>e.keyDownProductoCant(o)),ref:"cantRef",rules:[e=>!!e||"Debe ingresar la cantidad",e=>parseInt(e)>=1||"La cantidad no puede ser menor o igual a cero"],"hide-bottom-space":""},null,8,["modelValue","disable","rules"])]),""!==e.descripcionProd?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,i.C_)(["col col-7 text-subtitle2 q-pa-xs","Producto no encotrado"===e.descripcionProd?"bg-red":""])},[(0,l.Uk)((0,i.zw)(e.maestroProducto)+" - "+(0,i.zw)(e.descripcionProd)+" ",1),Te,(0,l.Uk)(" Lote: "+(0,i.zw)(e.lote)+" - "+(0,i.zw)(e.descripcionLote),1)],2)):(0,l.kq)("",!0),""!==e.descripcionProd?((0,l.wg)(),(0,l.iD)("div",xe,[(0,l.Uk)(" Precio: Q."+(0,i.zw)(e.precioProducto.toFixed(2)),1),Se,Ve,(0,l._)("div",Re,"Q."+(0,i.zw)((e.precioProducto*e.cantidadPedir).toFixed(2)),1)])):(0,l.kq)("",!0)])])),_:1},512)]),(0,l._)("div",He,[(0,l.Wm)(Vo,{dense:"",flat:"",bordered:"",separator:"cell"},{default:(0,l.w5)((()=>[Ae,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.preciosProd,((o,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:o.Inicial},[(0,l._)("td",Le,(0,i.zw)(o.Inicial),1),(0,l._)("td",We,(0,i.zw)(o.Final),1),(0,l._)("td",qe,(0,i.zw)(o.Precio),1),0===a?((0,l.wg)(),(0,l.iD)("td",{key:0,class:"text-center",rowspan:e.preciosProd.length},(0,i.zw)(o.Disponible),9,Fe)):(0,l.kq)("",!0),0===a?((0,l.wg)(),(0,l.iD)("td",{key:1,class:"text-center",rowspan:e.preciosProd.length},(0,i.zw)(o.Reservado),9,Me)):(0,l.kq)("",!0)])))),128))])])),_:1})]),e.$q.platform.is.mobile?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",Ue,[(0,l.Wm)(Vo,{dense:"",flat:"",bordered:"",separator:"cell"},{default:(0,l.w5)((()=>[ze,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.ums,(o=>((0,l.wg)(),(0,l.iD)("tr",{key:o.Codigo,onDblclick:a=>e.cantidadPedir=o.Factor,class:"cursor-pointer q-hoverable",style:{"user-select":"none"}},[(0,l._)("td",Qe,(0,i.zw)(o.Codigo),1),(0,l._)("td",Ye,(0,i.zw)(o.Descripcion),1),(0,l._)("td",Be,(0,i.zw)(o.Factor),1)],40,Ze)))),128))])])),_:1})]))])])),_:1}),(0,l.Wm)(ko,{color:"red"}),(0,l.Wm)(uo,{class:"scroll",style:(0,i.j5)(e.getSuperMode()?"height: 700px":"450px")},{default:(0,l.w5)((()=>[(0,l.Wm)(Io,{title:"Productos agregados: "+e.rowsAgregados.length,dense:"",id:"pos-detalles",columns:e.columnsAgregados,rows:e.rowsAgregados,"row-key":"producto",filter:e.filterAgregados,pagination:{rowsPerPage:0},onRowDblclick:e.selectRow,loading:e.loadAgregando,style:{height:"400px"}},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(co,{for:"pos-buscar-detalles",borderless:"",dense:"",modelValue:e.filterAgregados,"onUpdate:modelValue":o[49]||(o[49]=o=>e.filterAgregados=o),placeholder:"Buscar detalles",clearable:""},{append:(0,l.w5)((()=>[(0,l.Wm)(bo,{name:"search"})])),_:1},8,["modelValue"])])),"body-cell-Cantidad":(0,l.w5)((o=>[(0,l.Wm)(No,{props:o},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(o.value)+" ",1),(0,l.Wm)(Ho,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e},{default:(0,l.w5)((a=>[(0,l.Wm)(co,{type:"number",modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,dense:"",autofocus:"",onKeydown:[(0,t.D2)((0,t.iM)(a.cancel,["prevent"]),["enter"]),(0,t.D2)((l=>e.cambiarCantidad(a.value,o.row.Producto,o.row.Lote,a.initialValue)),["enter"])]},{after:(0,l.w5)((()=>[(0,l.Wm)(vo,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:[(0,t.iM)(a.cancel,["stop"]),l=>e.cambiarCantidad(a.value,o.row.Producto,o.row.Lote,a.initialValue)],disable:!1===a.validate(a.value)||a.initialValue===a.value},null,8,["onClick","disable"])])),_:2},1032,["modelValue","onUpdate:modelValue","onKeydown"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"])])),"body-cell-Precio":(0,l.w5)((o=>[(0,l.Wm)(No,{props:o},{default:(0,l.w5)((()=>[(0,l.Uk)(" Q."+(0,i.zw)(o.value)+" ",1),e.permiteCambioPrecio?((0,l.wg)(),(0,l.j4)(Ho,{key:0,modelValue:o.value,"onUpdate:modelValue":e=>o.value=e},{default:(0,l.w5)((a=>[(0,l.Wm)(co,{type:"number",modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,dense:"",autofocus:"",onKeydown:[(0,t.D2)((0,t.iM)(a.cancel,["prevent"]),["enter"]),(0,t.D2)((l=>e.cambiarPrecio(a.value,o.row.Producto,a.initialValue)),["enter"])]},{after:(0,l.w5)((()=>[(0,l.Wm)(vo,{flat:"",dense:"",color:"positive",icon:"check_circle",onClick:[(0,t.iM)(a.cancel,["stop"]),l=>e.cambiarPrecio(a.value,o.row.Producto,a.initialValue)],disable:!1===a.validate(a.value)||a.initialValue===a.value},null,8,["onClick","disable"])])),_:2},1032,["modelValue","onUpdate:modelValue","onKeydown"])])),_:2},1032,["modelValue","onUpdate:modelValue"])):(0,l.kq)("",!0)])),_:2},1032,["props"])])),"body-cell-Eliminar":(0,l.w5)((o=>[(0,l.Wm)(No,{props:o,style:{padding:"0px",width:"5px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(vo,{outline:"",color:"red",icon:"delete_forever",class:"",onClick:a=>e.eliminarTodoProducto(o.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["title","columns","rows","filter","onRowDblclick","loading"]),e.getSuperMode()?((0,l.wg)(),(0,l.j4)(Io,{key:0,title:"Productos no agregados",dense:"",rows:e.productosErrorSuper,columns:[{name:"Producto",label:"Producto",field:"Producto",align:"center"},{name:"Descripcion",label:"Descripcion",field:"Descripcion",align:"center"},{name:"Lote",label:"Lote",field:"Lote",align:"center"}],pagination:{rowsPerPage:0},style:{height:"250px"}},null,8,["rows"])):(0,l.kq)("",!0)])),_:1},8,["style"])])),_:1},8,["class"])]),(0,l._)("template",null,[(0,l.Wm)(go,{modelValue:e.showModalHoras,"onUpdate:modelValue":o[52]||(o[52]=o=>e.showModalHoras=o),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(mo,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Eo,{ref:"formModal",onSubmit:e.guardarHoras},{default:(0,l.w5)((()=>[(0,l._)("div",je,[(0,l.Wm)(co,{class:"col-12",modelValue:e.horasModel,"onUpdate:modelValue":o[50]||(o[50]=o=>e.horasModel=o),type:"number",step:"0.5",label:"Horas Laboradas",rules:[e=>!!e||"El valor de Horas Laboradas es Obligatorio",e=>e>=0||"El valor de Horas Laboradas debe ser mayor a Cero"]},null,8,["modelValue","rules"]),(0,l.Wm)(co,{class:"col-12",modelValue:e.obsHorasModel,"onUpdate:modelValue":o[51]||(o[51]=o=>e.obsHorasModel=o),type:"text",label:"Observaciones",rules:[e=>!!e||"El valor de Observaciones es Obligatorio"]},null,8,["modelValue","rules"])]),(0,l.Wm)(po,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(vo,{label:"Cancelar",color:"negative",onClick:e.limpiarModal},null,8,["onClick"]),[[qo]]),(0,l.Wm)(vo,{label:"Guardar",type:"submit",color:"primary"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])]),(0,l._)("template",null,[(0,l.Wm)(go,{modelValue:e.showModalDetalle,"onUpdate:modelValue":o[53]||(o[53]=o=>e.showModalDetalle=o)},{default:(0,l.w5)((()=>[(0,l.Wm)(mo,{bordered:"",style:{width:"900px!important"}},{default:(0,l.w5)((()=>[(0,l._)("div",Ge,[(0,l.Wm)(Io,{style:{width:"700px!important"},rows:e.modalGridRows,columns:e.modalGridCols,columns_filter:!0,bordered:"",dense:"",pagination:e.initialPagination},{"body-cell-AGREGADO":(0,l.w5)((o=>[(0,l.Wm)(No,{props:o,style:{padding:"0px",width:"5px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(yo,{modelValue:o.row.AGREGADO,"onUpdate:modelValue":e=>o.row.AGREGADO=e,onClick:a=>e.checkSugeridos(o.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])])),_:2},1032,["props"])])),_:1},8,["rows","columns","pagination"])]),(0,l.Wm)(po,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(vo,{label:"Cerrar",color:"negative"},null,512),[[qo]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,l._)("template",null,[(0,l.Wm)(go,{modelValue:e.showModalDate,"onUpdate:modelValue":o[56]||(o[56]=o=>e.showModalDate=o)},{default:(0,l.w5)((()=>[(0,l.Wm)(mo,{dark:""},{default:(0,l.w5)((()=>[(0,l._)("div",Ke,[(0,l._)("div",$e,[(0,l.Wm)(Ao,{modelValue:e.myDate,"onUpdate:modelValue":o[54]||(o[54]=o=>e.myDate=o),mask:"YYYY-MM-DD HH:mm",color:"positive",dark:"","today-btn":""},null,8,["modelValue"])]),(0,l._)("div",Xe,[(0,l.Wm)(Lo,{modelValue:e.myDate,"onUpdate:modelValue":o[55]||(o[55]=o=>e.myDate=o),mask:"YYYY-MM-DD HH:mm",format24h:!1,color:"positive",dark:""},null,8,["modelValue"])])]),(0,l.Wm)(po,null,{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(vo,{flat:"",label:"Actualizar",onClick:e.updateFecha},null,8,["onClick"]),[[qo]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,l._)("template",null,[(0,l.Wm)(go,{modelValue:e.showModalDateFin,"onUpdate:modelValue":o[59]||(o[59]=o=>e.showModalDateFin=o)},{default:(0,l.w5)((()=>[(0,l.Wm)(mo,{dark:""},{default:(0,l.w5)((()=>[(0,l._)("div",Je,[(0,l._)("div",eo,[(0,l.Wm)(Ao,{modelValue:e.myDateFin,"onUpdate:modelValue":o[57]||(o[57]=o=>e.myDateFin=o),mask:"YYYY-MM-DD HH:mm",color:"negative",dark:"","today-btn":""},null,8,["modelValue"])]),(0,l._)("div",oo,[(0,l.Wm)(Lo,{modelValue:e.myDateFin,"onUpdate:modelValue":o[58]||(o[58]=o=>e.myDateFin=o),mask:"YYYY-MM-DD HH:mm",format24h:!1,color:"negative",dark:""},null,8,["modelValue"])])]),(0,l.Wm)(po,null,{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(vo,{flat:"",label:"Actualizar",onClick:e.updateFechaFin},null,8,["onClick"]),[[qo]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),_:1})],64)}var lo=a(57674),io=a(38346),to=a(34136),no=a(67825),ro=a(60499),so=a(68651),uo=a(19302),co=a(18910),vo=a(78618),po=a(4608),mo=a(28886),go=a(30336),ho=a(61549),bo=a(8118),fo=a(86248),Po=a(35084),Do=a(84619),wo=a(7781),Co=a(37655),yo=a(51745),Eo=a(87913);const _o={class:"row bordered"},ko=(0,l.Uk)(" Minimizar "),Oo=(0,l.Uk)(" Maximizar "),No=(0,l.Uk)("Cerrar"),Io={style:{width:"100vw",height:"80vh"},class:""},To={class:"text-h6"};function xo(e,o,a,t,n,d){const r=(0,l.up)("q-btn"),s=(0,l.up)("q-space"),u=(0,l.up)("q-tooltip"),c=(0,l.up)("q-bar"),v=(0,l.up)("q-td"),p=(0,l.up)("q-tr"),m=(0,l.up)("q-grid"),g=(0,l.up)("q-card-section"),h=(0,l.up)("q-card"),b=(0,l.up)("q-dialog"),f=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",_o,[(0,l.Wm)(r,{label:"Ordenes En Creación",dense:"",outline:"",color:"negative",icon:"handyman",onClick:o[0]||(o[0]=o=>e.modal=!0)})]),(0,l.Wm)(b,{modelValue:e.modal,"onUpdate:modelValue":o[3]||(o[3]=o=>e.modal=o),maximized:e.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s),(0,l.Wm)(r,{dense:"",flat:"",icon:"minimize",onClick:o[1]||(o[1]=o=>e.maximizedToggle=!1),disable:!e.maximizedToggle},{default:(0,l.w5)((()=>[e.maximizedToggle?((0,l.wg)(),(0,l.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,l.w5)((()=>[ko])),_:1})):(0,l.kq)("",!0)])),_:1},8,["disable"]),(0,l.Wm)(r,{dense:"",flat:"",icon:"crop_square",onClick:o[2]||(o[2]=o=>e.maximizedToggle=!0),disable:e.maximizedToggle},{default:(0,l.w5)((()=>[e.maximizedToggle?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(u,{key:0,class:"bg-white text-primary"},{default:(0,l.w5)((()=>[Oo])),_:1}))])),_:1},8,["disable"]),(0,l.wy)(((0,l.wg)(),(0,l.j4)(r,{dense:"",flat:"",icon:"close"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"bg-white text-primary"},{default:(0,l.w5)((()=>[No])),_:1})])),_:1})),[[f]])])),_:1}),(0,l.Wm)(g,{class:"row items-center"},{default:(0,l.w5)((()=>[(0,l._)("div",Io,[(0,l._)("div",To,[(0,l.Wm)(r,{color:"negative",icon:"refresh",label:"Cargar Ordenes Pendientes",onClick:e.getOrdenes,loading:e.loading},null,8,["onClick","loading"])]),(0,l.Wm)(m,{class:"puntosDialog",data:e.rows,columns:e.columns,columns_filter:!0,pagination:{rowsPerPage:0}},{body:(0,l.w5)((o=>[(0,l.Wm)(p,{props:o,class:"cursor-pointer",onDblclick:a=>e.selectRow(a,o.row)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.columns,(e=>((0,l.wg)(),(0,l.j4)(v,{key:e.name,class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.format?e.format(o.row[e.field]):o.row[e.field]),1)])),_:2},1024)))),128))])),_:2},1032,["props","onDblclick"])])),_:1},8,["data","columns"])])])),_:1})])),_:1})])),_:1},8,["modelValue","maximized"])],64)}var So=function(e,o,a,l){function i(e){return e instanceof a?e:new a((function(o){o(e)}))}return new(a||(a=Promise))((function(a,t){function n(e){try{r(l.next(e))}catch(o){t(o)}}function d(e){try{r(l["throw"](e))}catch(o){t(o)}}function r(e){e.done?a(e.value):i(e.value).then(n,d)}r((l=l.apply(e,o||[])).next())}))};const Vo=[{name:"NUMERO_ORDEN",label:"Número Orden",field:"NUMERO_ORDEN",align:"center",sortable:!0},{name:"FECHA_ORDEN",label:"Fecha Orden",field:"FECHA_ORDEN",align:"center",sortable:!0},{name:"NOMBRE_CLIENTE",label:"Nombre Cliente",field:"NOMBRE_CLIENTE",align:"center",sortable:!0},{name:"TOTAL_ORDEN",label:"Total Orden",field:"TOTAL_ORDEN",align:"center",sortable:!0,format:e=>`Q.${e}`},{name:"NOMBRE_VENDEDOR",label:"Vendedor",field:"NOMBRE_VENDEDOR",align:"center",sortable:!0}],Ro=(0,l.aZ)({name:"OrdenesPendientes",emits:["setPedido"],setup(e,{emit:o}){const a=(0,ro.iH)(!1),l=(0,ro.iH)([]),i=(0,ro.iH)(!1),t=()=>So(this,void 0,void 0,(function*(){i.value=!0,yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"OrdenesPendientes").then((e=>{l.value=e.data.ORDENES})).catch((e=>{})),i.value=!1})),n=(e,l)=>{o("setPedido",l.NUMERO_PEDIDO),a.value=!1};return{selectRow:n,getOrdenes:t,maximizedToggle:(0,ro.iH)(!0),modal:a,rows:l,columns:Vo,loading:i}},watch:{modal(e){e&&this.getOrdenes()}}});var Ho=a(11639),Ao=a(68879),Lo=a(32074),Wo=a(44458),qo=a(64526),Fo=a(90136),Mo=a(46858),Uo=a(63190),zo=a(31233),Zo=a(67220),Qo=a(62146),Yo=a(69984),Bo=a.n(Yo);const jo=(0,Ho.Z)(Ro,[["render",xo]]),Go=jo;Bo()(Ro,"components",{QBtn:Ao.Z,QDialog:Lo.Z,QCard:Wo.Z,QBar:qo.Z,QSpace:Fo.Z,QTooltip:Mo.Z,QCardSection:Uo.Z,QTr:zo.Z,QTd:Zo.Z}),Bo()(Ro,"directives",{ClosePopup:Qo.Z});var Ko=a(51392),$o=a(54170),Xo=a(17779),Jo=function(e,o,a,l){function i(e){return e instanceof a?e:new a((function(o){o(e)}))}return new(a||(a=Promise))((function(a,t){function n(e){try{r(l.next(e))}catch(o){t(o)}}function d(e){try{r(l["throw"](e))}catch(o){t(o)}}function r(e){e.done?a(e.value):i(e.value).then(n,d)}r((l=l.apply(e,o||[])).next())}))};const ea=(0,l.aZ)({name:"Ordenes",components:{ProductsDialog:ho.Z,ClientesDialog:po.Z,AClientesDialog:mo.Z,KeyPageDetect:go.Z,ProductosOfertadosDialog:bo.Z,PuntosCliente:fo.Z,ReservasDialog:Po.Z,qrscannerVue:Eo.Z,ProductosBuscados:Ko.Z,OrdenesPendientes:Go},setup(){const e=[{name:"Producto",label:"Producto",field:"Producto",align:"center"},{name:"Descripcion",label:"Descripción",field:"Descripcion",align:"center"},{name:"Lote",label:"Lote",field:"Lote",align:"center"},{name:"DescripcionLote",label:"Descripción Lote",field:"DescripcionLote",align:"center"},{name:"Cantidad",label:"Cantidad",field:"Cantidad",align:"center"},{name:"Precio",label:"Precio",field:"Precio",align:"center"},{name:"Subtotal",label:"Subtotal",field:"Subtotal",align:"center",format:e=>`Q.${e}`},{name:"Eliminar",label:"Eliminar",field:"Eliminar",align:"center",headerStyle:"padding:0px; padding-right:16px; width:50px;"}],o=[{name:"TIPO_INSTALACION",label:"Id Instal",field:"TIPO_INSTALACION",align:"center"},{name:"DESCRIPCION",label:"Descripcion",field:"DESCRIPCION",align:"center"},{name:"DETALLE",label:"Detalle",field:"DETALLE",align:"center"},{name:"CANTIDAD",label:"Cantidad",field:"CANTIDAD",align:"center"},{name:"PRODUCT0",label:"Producto",field:"PRODUCT0",align:"center"},{name:"LOTE",label:"Lote",field:"LOTE",align:"center"},{name:"AGREGADO",label:"Agregado",field:"AGREGADO",align:"center"}],a=e=>Jo(this,void 0,void 0,(function*(){e&&(yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"UpdateCheckSugeridos",null,{params:{nOrden:Y.value,idTipoInst:e.TIPO_INSTALACION,idDetalle:e.ID_DETALLE,val:e.AGREGADO}}).then((e=>{})).catch((e=>{(0,so.L1)(e)})))})),i=()=>Jo(this,void 0,void 0,(function*(){0!==Y.value&&(yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"SugeridosOrdenes",{params:{numeroOrden:Y.value,numPed:Q.value}}).then((e=>{h.value=e.data.DETALLE})).catch((e=>{(0,so.L1)(e)})),v.value=!0)})),t=(0,ro.iH)(""),n=(0,ro.iH)(""),d=(0,ro.iH)(""),r=(0,ro.iH)(""),s=(0,ro.iH)(""),u=(0,ro.iH)(null),c=(0,ro.iH)(null),v=(0,ro.iH)(!1),p=(0,ro.iH)(!1),m=(0,ro.iH)(!1),g=(0,ro.iH)(!0),h=(0,ro.iH)([]),b=(0,ro.iH)(0),f=(0,ro.iH)("");let P=(0,ro.iH)(!1);const D=(0,Do.z)(),w=(0,wo.L)(),C=(0,ro.iH)([]),y=(0,uo.Z)(),E=(0,co.tv)(),_=(0,ro.iH)(!1),k=(0,ro.iH)(""),O=(0,ro.iH)(""),N=(0,ro.iH)(null),I=(0,ro.iH)(""),T=(0,ro.iH)(""),x=(0,ro.iH)(""),S=(0,ro.iH)(""),V=(0,ro.iH)(""),R=(0,ro.iH)(""),H=(0,ro.iH)(""),A=(0,ro.iH)(""),L=(0,ro.iH)(""),W=(0,ro.iH)(0),q=(0,ro.iH)(!1),F=(0,ro.iH)(!1),M=(0,ro.iH)(!1),U=(0,ro.iH)(1),z=(0,ro.iH)(!0),Z=(0,ro.iH)(1),Q=(0,ro.iH)(0),Y=(0,ro.iH)(0),B=(0,ro.iH)(0),j=(0,ro.iH)(null),G=(0,ro.iH)(!1),K=(0,ro.iH)(null),$=(0,ro.iH)(null),X=(0,ro.iH)(""),J=(0,ro.iH)([]),ee=(0,ro.iH)(0),oe=(0,ro.iH)(""),ae=(0,ro.iH)(!1),le=(0,ro.iH)("S"),ie=(0,ro.iH)(!1),te=(0,ro.iH)(!1),ne=(0,ro.iH)(!1),de=(0,ro.iH)(!1),re=(0,ro.iH)(!1),se=(0,ro.iH)(!1),ue=(0,ro.iH)(!1),ce=(0,ro.iH)([]),ve=(0,ro.iH)(""),pe=(0,ro.iH)(!0),me=(0,ro.iH)(!0),ge=(0,ro.iH)(null),he=(0,ro.iH)(null),be=(0,ro.iH)(null),fe=(0,ro.iH)(null),Pe=(0,ro.iH)(null),De=(0,ro.iH)(null),we=(0,ro.iH)(null),Ce=(0,ro.iH)(null),ye=(0,ro.iH)(!1),Ee=(0,ro.iH)("fact"),_e=(0,ro.iH)(""),ke=(0,ro.iH)(null),Oe=(0,ro.iH)("NIT"),Ne=(0,ro.iH)([]),Ie=(0,ro.iH)(0),Te=(0,ro.iH)(!1),xe=(0,ro.iH)([]);(0,no.lz)()?Ie.value=0:Ie.value=300;const Se=()=>{const e=[];e.push({id:"layout-menu",texto:"Abre el menu lateral",titulo:"Menu"}),e.push({id:"layout-menu-paginas",texto:"Listado expandible de las páginas disponible en el POS",titulo:"Paginas"}),e.push({id:"layout-menu-ajustes",texto:"Listado expandible para ajustes de Impresoras y otros configurables del POS",titulo:"Ajustes"}),e.push({id:"layout-sucursal",texto:"Nombre de la sucursal actual",titulo:""}),e.push({id:"layout-serie",texto:"Serie en la cual se va a facturar",titulo:""}),e.push({id:"layout-vendedor",texto:"Nombre del vendedor actual en el sistema",titulo:""}),e.push({id:"layout-opciones",texto:"Menú con opciones disponibles en facturación",titulo:""}),e.push({id:"layout-abrir-caja",texto:"Opción para abrir la caja si se posee",titulo:""}),e.push({id:"pos-opcion-ticket",texto:"Opción para facturar de contado las facturar Ticket",titulo:""}),e.push({id:"pos-opcion-may",texto:"Opción para facturar a clientes mayorista o colaboradores",titulo:""}),e.push({id:"pos-buscar-aclientes",texto:"Botón para buscar los clientes guardados en el sistema"}),e.push({id:"pos-nit",texto:"Campo para buscar datos del cliente por el número de NIT"}),e.push({id:"pos-validaNit",texto:"Check para habilitar la validación del NIT online"}),e.push({id:"pos-nombre",texto:"Nombre del cliente"}),e.push({id:"pos-direccion",texto:"Dirección del cliente"}),e.push({id:"pos-correo",texto:"Correo del cliente"}),e.push({id:"pos-contingencia",texto:"En caso de fallar la certificación se debe habilitar la opción de contingecia, la cual genera únicamente una factura local y despúes se debe mandar a certificar"}),e.push({id:"depachar-btn",texto:"Botón para despachar productos pendientes de una cotización"}),e.push({id:"ofertados-btn",texto:"Botón de notificaciones de productos ofertados, para ver los productos debe dar click sobre el botón"}),e.push({id:"pos-pedido",texto:"Número de pedido actual, si se encuentra en 0, no hay creado ningún pedido"}),e.push({id:"pos-subtotal",texto:"SubTotal del pedido"}),e.push({id:"pos-crear-pedido",texto:"Botón para crear un nuevo pedido, también se puede crear precionando la tecla (F3)"}),e.push({id:"pos-eliminar-prod",texto:"Check para eliminar productos, si la opción se encuentra marcada el producto escaneado será eliminado del pedido",scroll:!0}),e.push({id:"pos-buscar-producto",texto:"Botón para abrir el buscador de productos",on:"bottom"}),e.push({id:"pos-producto",texto:"Campo de texto para ingrear el código del producto"}),e.push({id:"pos-check-cantidad",texto:"Check para habilitar el campo de cantidad, de caso contrario el valor por defecto sera 1"}),e.push({id:"pos-cantidad",texto:"Campo numérico para ingresar las unidad que se desean despachar"}),e.push({id:"pos-precios",texto:"Precios y secuencias del producto escaneado"}),e.push({id:"pos-detalles",texto:"Detalles del pedido agregados"}),e.push({id:"pos-buscar-detalles",texto:"Campo de texto para buscar un producto dentro de los detalles"});const o=(0,yo.Z)(e,"POS",(()=>{window.scrollTo(0,0),Ve(),(0,no.KY)("POS"),(0,no.KY)("MainLayout")}));null===o||void 0===o||o.start()},Ve=()=>Jo(this,void 0,void 0,(function*(){Z.value=2,yield(0,vo._R)(500);const e=[];e.push({id:"pos-buscar-clientes",texto:"Botón para abrir el buscardor de clientes"}),e.push({id:"pos-codigo-cliente",texto:"Campo de texto para ingresar el código del cliente"}),e.push({id:"puntos-estado",texto:"Estado de puntos para cliente ingresado, si se encuentra en rojo el clinte no acumula puntos, de caso contrario si se encuentra en verde, el cliente si acumula puntos"}),e.push({id:"puntos-btn",texto:"Botón para ver el historial de puntos del cliente"});const o=(0,yo.Z)(e,"POS-Clientes",(()=>{(0,no.KY)("POS-Clientes")}));null===o||void 0===o||o.start()}));(0,l.YP)(w,(()=>{w.cargarUltimo&&Ro(),w.cargarNumero&&Ho()}));const Re=e=>{switch(e){case"C+A":Ro();break;case"F3":eo();break;case"F6":E.push("/INIT/PENDIENTES");break;case"C+ ":Q.value=0;break;case"Delete":He();break;case"C+R":oa("fact");break;case"C+D":oa("nc");break;default:break}},He=()=>{0!==Q.value&&(0,so.wp)("Anular","¿Está seguro de anular la orden de instalacion "+Y.value+"? Esto no se puede revertir",{onPressOk:()=>{to.api.post(to.endPoints.PEDIDOENC+"Anular",Q.value).then((e=>{(0,so.dF)("Orden de instalacion anulada correctamente"),Q.value=0,Y.value=0})).catch((e=>{(0,so.L1)(e)}))},onPressCancel:()=>{}})},Ae=(e="FACT")=>Jo(this,void 0,void 0,(function*(){var o;yield to.api.get(to.endPoints.DATOSVEND+(0,no.Xw)(),(0,to.configApi)({queryParams:{tipo:e}})).then((o=>Jo(this,void 0,void 0,(function*(){if(ee.value=o.data.Cliente,1===Z.value&&(K.value=o.data.Cliente,$.value=parseInt(o.data.Nivel)),X.value=o.data.Descripcion,D.nombreSucursal=o.data.Nombre_Sucursal,D.nombreVendedor=o.data.Nombre,ve.value=o.data.Serie,de.value=o.data.TieneRutero,se.value=o.data.TieneTecnico,ue.value=o.data.CambioPrecio,(0,no.zD)(o.data.SerieRuta),2===Z.value&&"S"===o.data.BloqueaMayorista){let e=!1;do{if(e=yield Le(),null===e)break;null!=e&&1!=e&&(0,so.x2)("Clave Incorrecta",{position:"top"})}while(!e)}qe(e)})))).catch((e=>{(0,so.L1)(e,{position:"top"})})),null===(o=fe.value)||void 0===o||o.focus()})),Le=()=>Jo(this,void 0,void 0,(function*(){const e=yield(0,so.UA)("Contraseña Mayoristas","Ingrese la clave de autorización para clientes mayoristas","password");if(null===e)return Z.value=1,null;const o=yield We(e);return o})),We=e=>Jo(this,void 0,void 0,(function*(){let o=!1;return yield to.api.post(to.endPoints.DATOSVEND+"Clave",e).then((e=>{o=e.data})).catch((e=>{})),o})),qe=(e="")=>{var o,a,l,i;""!==e?"FACT"===e?ve.value=null!==(o=(0,no.dS)())&&void 0!==o?o:"":"FCRE"===e?ve.value=null!==(a=(0,no.JT)())&&void 0!==a?a:"":"FCON"===e?ve.value=null!==(l=(0,no.V6)())&&void 0!==l?l:"":"FRUT"===e&&(ve.value=null!==(i=(0,no.nZ)())&&void 0!==i?i:"",(0,lo.Z)("primary","#b88b11")):ve.value=""},Fe=()=>{_.value=!1;let e="",o="";if(2===Z.value){if(!K.value||""===K.value.toString())return Ze(),$.value=null,void(X.value="");e=to.endPoints.CLIENTE+K.value,o="Cliente no encontrado"}else{if(!k.value||""===k.value)return void Ze();e=to.endPoints.ACLIENTES+z.value.toString()+"/"+k.value+"/"+Oe.value,o="Nit/DPI no encotrado interno"}_.value=!0,to.api.get(e).then((e=>{var a;if(null==e.data)return(0,so.x2)(o,{timeout:1e3}),_.value=!1,null===(a=Ce.value)||void 0===a||a.select(),void Ze();2===Z.value&&(k.value=e.data.Nit,O.value=e.data.Nit,$.value=parseInt(e.data.Nivel),X.value=e.data.Descripcion,N.value=e.data.Dpi,Oe.value="NIT"),1===Z.value&&"CF"===k.value?(I.value="CONSUMIDOR FINAL",T.value="CIUDAD",x.value=""):(I.value=e.data.Nombre,T.value=e.data.Direccion,x.value=e.data.Email,void 0!==e.data.Tipo_especial&&(Oe.value=e.data.Tipo_especial)),_.value=!1})).catch((e=>{(0,so.L1)(e),_.value=!1,Ze()}))},Me=()=>Jo(this,void 0,void 0,(function*(){var e;if(null==V.value||!V.value||""===V.value)return L.value="",W.value=0,H.value="",R.value="",J.value=[],void(ce.value=[]);if(ie.value)while(ie.value)Xo.log("buscando..."),yield new Promise((e=>setTimeout(e,250)));ie.value=!0;const o=V.value.toUpperCase().replace(".","_");yield to.api.get(to.endPoints.PRODUCTO+$.value+"/"+o).then((e=>Jo(this,void 0,void 0,(function*(){if(Xo.log(e.data),null==e.data.Producto)return L.value="Producto no encotrado",W.value=0,H.value="",A.value="",R.value="",J.value=[],void(ce.value=[]);R.value=e.data.Producto.Producto,L.value=e.data.Producto.Descripcion,A.value=e.data.Producto.DescripcionLote,yield(0,vo._R)(100),H.value=e.data.Producto.Lote,J.value=e.data.Precios,ce.value=e.data.Um,ze()})))).catch((e=>{ie.value=!1,(0,so.L1)(e)})).finally((()=>{ie.value=!1})),null===(e=ge.value)||void 0===e||e.focus()})),Ue=()=>Jo(this,void 0,void 0,(function*(){var e;if(Xo.log("Consulater lote",V.value),A.value="",!V.value&&""===V.value)return;const o=V.value.toUpperCase().replace(".","_");yield to.api.get(to.endPoints.PRODUCTO+(null===(e=$.value)||void 0===e?void 0:e.toString())+"/"+o).then((e=>{if(null==e.data.Producto)return H.value="",void(A.value="Lote no encontrado");A.value=e.data.Producto.DescripcionLote})).catch((e=>{Xo.log(e),(0,so.L1)(e)}))})),ze=()=>{if(0===J.value.length)return void(W.value=0);let e=J.value.find((e=>0===e.Final||e.Inicial<=U.value&&e.Final>=U.value?e:void 0));e&&(W.value=e.Precio)},Ze=()=>{var e;I.value="",T.value="",x.value="",O.value="",N.value="",2===Z.value&&(k.value="",null===(e=fe.value)||void 0===e||e.resetValidation()),ne.value=!1,C.value=[],va.value=[]},Qe=e=>Jo(this,void 0,void 0,(function*(){var o,a;"+"===e.key&&e.preventDefault(),"*"===e.key&&e.preventDefault(),"-"===e.key&&(null===(o=k.value)||void 0===o?void 0:o.includes("-"))&&e.preventDefault(),"/"===e.key&&(null===(a=k.value)||void 0===a?void 0:a.includes("/"))&&e.preventDefault(),"F2"===e.key&&(k.value="CF",yield(0,vo._R)(500),eo()),e.key})),Ye=()=>Jo(this,void 0,void 0,(function*(){k.value="CF",yield(0,vo._R)(500),eo()})),Be=e=>Jo(this,void 0,void 0,(function*(){var o,a,l,i,t,n,d,r;if(yield new Promise((e=>setTimeout(e,Ie.value))),(0,no.lz)()){if("\n"===e.key)Me();else if("Enter"===e.key){let e=yield null===(o=he.value)||void 0===o?void 0:o.validate();e&&(q.value?null===(a=be.value)||void 0===a||a.focus():F.value?(yield po(),null===(l=ge.value)||void 0===l||l.focus()):(Ne.value.push(V.value),null===(i=ge.value)||void 0===i||i.select(),Te.value||je()))}}else{if(te.value)return;if("Enter"===e.key){if(ie.value)while(ie.value)Xo.log("esperando..."),yield new Promise((e=>setTimeout(e,500)));let e=yield null===(t=he.value)||void 0===t?void 0:t.validate();e&&(q.value?null===(n=be.value)||void 0===n||n.focus():M.value||(F.value?(yield po(),null===(d=ge.value)||void 0===d||d.focus()):(yield oo(),null===(r=ge.value)||void 0===r||r.focus())))}}})),je=()=>Jo(this,void 0,void 0,(function*(){var e;Te.value=!0;let o=[];while(Ne.value.length>0){let e,a,l,i,t,n=Ne.value.find(((e,o,a)=>0===o));if(void 0===n)return;if(Xo.log("agregando ->"+n),t=U.value,yield to.api.get(to.endPoints.PRODUCTO+$.value+"/"+n).then((o=>{null!=o.data.Producto?(e=o.data.Producto.Producto,a=o.data.Producto.Descripcion,l=o.data.Producto.Lote,i=o.data.Precios[0].Precio):(0,so.x2)("Producto",{subtitulo:"No se encontro el producto "+n})})).catch((e=>{(0,so.L1)(e)})),void 0!==e){const n={Pedido:Q.value,Producto:e,Cantidad:t,Precio:i,Lote:l,GeneraMov:!1,Despacho:"S"};yield to.api.post(to.endPoints.PEDIDODET,n).then((n=>{n.data.Mov&&o.push({Producto:e,Descripcion:a,Lote:l,Precio:i,Cantidad:t})})).catch((o=>{(0,so.L1)(o,{timeout:8e3,position:"top"}),xe.value.push({Producto:e,Descripcion:a,Lote:l,Precio:i,Cantidad:t})})).finally((()=>{}))}Ne.value.shift()}Vo(),Te.value=!1;let a=0;Te.value=!0,o.forEach((e=>Jo(this,void 0,void 0,(function*(){Xo.log("Agregando mov43-> ",e.Producto,e.Lote),yield(0,so.pW)("Existencia","El producto "+e.Producto+" "+e.Descripcion+" - "+e.Lote+" no tiene existencia, desea generar MOVIMIENTO_43",{onPressOk:()=>Jo(this,void 0,void 0,(function*(){const o={Pedido:Q.value,Producto:e.Producto,Cantidad:e.Cantidad,Precio:e.Precio,Lote:e.Lote,GeneraMov:!0,Despacho:"S"};yield to.api.post(to.endPoints.PEDIDODET,o).then((e=>{})).catch((e=>{(0,so.L1)(e,{timeout:8e3,position:"top"})})).finally((()=>{}))})),onPressCancel:()=>{}}),a++,a===o.length&&(yield(0,vo._R)(1500),Vo(),Te.value=!1)})))),Te.value=!1,null===(e=ge.value)||void 0===e||e.select()}));let Ge=!1,Ke="";const $e=e=>{var o;if(Ge){let o=parseInt(e.key);if(!Number.isNaN(o))return Ke+=e.key,U.value=parseInt(Ke),void e.preventDefault();"Escape"===e.key?(U.value=1,Ke="",Ge=!1):(Ke="",Ge=!1)}"F1"===e.key?(null===(o=Pe.value)||void 0===o||o.openDialog(),e.preventDefault()):e.ctrlKey&&"E"===e.key.toUpperCase()?(F.value=!F.value,e.preventDefault()):"+"===e.key?(e.ctrlKey?q.value=!0:(U.value++,(0,so.dF)("Más 1 agregado",{timeout:1e3,position:"top"})),e.preventDefault()):"-"===e.key?(e.ctrlKey?q.value=!1:U.value>1&&(U.value--,(0,so.dF)("Menos 1 agregado",{timeout:1e3,position:"top"})),e.preventDefault()):"*"===e.key&&(Ge=!0)},Xe=e=>Jo(this,void 0,void 0,(function*(){var o,a,l;if("Enter"===e.key){let e=yield null===(o=he.value)||void 0===o?void 0:o.validate();e&&(F.value?(yield po(),null===(a=ge.value)||void 0===a||a.focus()):(Ne.value.push(V.value),null===(l=ge.value)||void 0===l||l.select(),Te.value||(yield je())),U.value=1)}})),Je=()=>Jo(this,void 0,void 0,(function*(){var e,o;if(G.value=!1,_.value)while(_.value)Xo.log("esperando..."),yield new Promise((e=>setTimeout(e,500)));if(0!==Q.value)return void(0,so.dF)("Tiene un pedido cargado",{tipo:"warning"});let a=yield null===(e=we.value)||void 0===e?void 0:e.validate();if(a){if(2===Z.value&&K.value===ee.value)return void(0,so.x2)("No puede facturar al cliente Ticket");if(2===Z.value&&null===j.value&&!1===re.value)return void(G.value=!0);null===ve&&(0,so.x2)("No hay serie");const e={Nombre:I.value,Nit:k.value,Direccion:T.value,Cliente:K.value,Vendedor:(0,no.Xw)(),Credito:1!==Z.value&&j.value,Nivel:$.value,Despacho:le.value,Correro:x.value,ValidarNit:z.value,Observacion:S.value,Ruta:re.value,Tipo_especial:Oe.value};(0,Co.Q)("Creando Pedido..."),yield to.api.post(to.endPoints.PEDIDOENC,e,(0,to.configApi)({serie:ve.value})).then((e=>{Q.value=e.data,(0,so.dF)("Pedido "+Q.value.toString()+" creado"),ne.value=!0})).catch((e=>{(0,so.L1)(e,{timeout:0,position:"top"})})),(0,Co.E)(),null===(o=ge.value)||void 0===o||o.focus()}})),eo=()=>Jo(this,void 0,void 0,(function*(){var e;if(G.value=!1,_.value)while(_.value)Xo.log("esperando..."),yield new Promise((e=>setTimeout(e,500)));if(0!==Q.value)return void(0,so.dF)("Tiene un pedido cargado",{tipo:"warning"});let o=yield null===(e=we.value)||void 0===e?void 0:e.validate();if(o){if(2===Z.value&&K.value===ee.value)return void(0,so.x2)("No puede facturar al cliente Ticket");if(2===Z.value&&null===j.value&&!1===re.value)return void(G.value=!0);null===ve&&(0,so.x2)("No hay serie");const e={Nombre:I.value,Nit:k.value,Direccion:T.value,Cliente:K.value,Vendedor:(0,no.Xw)(),Credito:1!==Z.value&&j.value,Nivel:$.value,Despacho:le.value,Correro:x.value,ValidarNit:z.value,Observacion:S.value,Ruta:re.value,Tipo_especial:Oe.value,TelCliente:n.value,DireccionInstalacion:t.value};(0,Co.Q)("Creando Orden..."),yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"AltaOrden",e,(0,to.configApi)()).then((e=>{Q.value=e.data.Pedido,Y.value=e.data.Orden,(0,so.dF)("Orden: "+Y.value.toString()+" Creada Exitosamente")})).catch((e=>{(0,so.L1)(e,{timeout:0,position:"top"})})),Q.value=Q.value,Y.value=Y.value,(0,Co.E)()}})),oo=(e=!1)=>Jo(this,void 0,void 0,(function*(){var o,a,l;if(""!==R.value&&""===H.value)return void(null===(o=Pe.value)||void 0===o||o.openDialog());if(null===R.value||null===H.value)return void(0,so.x2)("El producto no existe");if(0===Q.value)return void(0,so.x2)("Debe crear un pedido primero");te.value=!0;let i=yield null===(a=he.value)||void 0===a?void 0:a.validate();if(i){const o={Pedido:Q.value,Producto:R.value,Cantidad:U.value,Precio:W.value,Lote:H.value,GeneraMov:e,Despacho:le.value};yield to.api.post(to.endPoints.PEDIDODET,o).then((e=>Jo(this,void 0,void 0,(function*(){e.data.Mov?yield(0,so.pW)("Existencia","El producto no tiene existencia, desea generar MOVIMIENTO 43",{onPressOk:()=>Jo(this,void 0,void 0,(function*(){yield oo(!0)})),onPressCancel:()=>{}}):((0,so.dF)("Producto "+R.value+" agregado correctamente"),V.value="",U.value=1)})))).catch((e=>{var o,a;te.value=!1,null===(o=ge.value)||void 0===o||o.select(),null===(a=ge.value)||void 0===a||a.focus(),(0,so.L1)(e,{timeout:8e3,position:"top"})})).finally((()=>{te.value=!1,Vo()}))}te.value=!1,null===(l=ge.value)||void 0===l||l.focus()})),ao=(e,o,a,l)=>Jo(this,void 0,void 0,(function*(){var i;if(0===Q.value)return void(0,so.x2)("Debe crear un pedido primero");const t={Pedido:Q.value,Producto:e.trim(),Cantidad:l,Precio:a,Lote:o.trim(),GeneraMov:!1,Despacho:le.value};yield to.api.post(to.endPoints.PEDIDODET,t).then((a=>{a.data.Mov?(0,so.x2)("El producto no tiene existencia suficiente para la cantidad de: "+l+" unidades"):((0,so.dF)("Producto "+e.trim()+" y lote "+o.trim()+" agregado correctamente",{position:"top"}),V.value="",U.value=1)})).catch((e=>{var o,a;te.value=!1,null===(o=ge.value)||void 0===o||o.select(),null===(a=ge.value)||void 0===a||a.focus(),(0,so.L1)(e,{timeout:8e3,position:"top"})})).finally((()=>{te.value=!1,Vo()})),te.value=!1,null===(i=ge.value)||void 0===i||i.focus()})),po=()=>Jo(this,void 0,void 0,(function*(){var e,o,a;if(0===Q.value)return void(0,so.x2)("Error",{subtitulo:"Debe crear un pedido primero"});if(""!==R.value&&""===H.value)return void(null===(e=Pe.value)||void 0===e||e.openDialog());te.value=!0;let l=yield null===(o=he.value)||void 0===o?void 0:o.validate();const i={Pedido:Q.value,Producto:R.value,Cantidad:U.value,Precio:W.value,Lote:H.value};l&&(yield to.api.delete(to.endPoints.PEDIDODET,(0,to.configApi)({datos:i})).then((e=>{(0,so.dF)("Producto eliminado correctamente"),V.value="",U.value=1})).catch((e=>{(0,so.L1)(e,{position:"right"})})).finally((()=>{te.value=!1,Vo()}))),te.value=!1,null===(a=ge.value)||void 0===a||a.focus()})),mo=e=>{const o={Pedido:Q.value,Producto:e.Producto,Cantidad:e.Cantidad,Precio:e.Precio,Lote:e.Lote};(0,so.wp)("Confirmar","¿Está seguro de eliminar todo el producto?",{onPressOk:()=>Jo(this,void 0,void 0,(function*(){var e;te.value=!0,yield to.api.delete(to.endPoints.PEDIDODET,(0,to.configApi)({datos:o})).then((e=>{(0,so.dF)("Producto eliminado correctamente"),V.value="",U.value=1})).catch((e=>{(0,so.L1)(e,{timeout:0,position:"right"})})).finally((()=>{te.value=!1,Vo()})),te.value=!1,null===(e=ge.value)||void 0===e||e.focus()}))})},go=()=>Jo(this,void 0,void 0,(function*(){fo?yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"AltaOrdenTecnicos",null,{params:{tipoInstalacion:fo.TIPO_INSTALACION,tecnico:fo.TECNICO,orden:Y.value,horas_extras:b.value,obser:f.value}}).then((e=>{(0,so.dF)("Agregado Correctamente"),P.value=!1})).catch((e=>{(0,so.L1)(e)})):(0,so.x2)("Error al seleccionar el vendedor-Row")})),ho=()=>{b.value=0,f.value=""},bo=e=>Jo(this,void 0,void 0,(function*(){yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"VOrdenDetVend",{params:{pedido:Q.value,orden:Y.value,tecnico:e.TECNICO,tipo_instalacion:e.TIPO_INSTALACION}}).then((e=>{b.value=e.data.Horas.HORAS_EXTRAS,f.value=e.data.Horas.OBSERVACIONES})).catch((e=>{(0,so.L1)(e)})),P.value=!0,fo=e}));let fo;const Po=e=>{(0,so.wp)("Confirmar","¿Está seguro de eliminar el detalle de Orden de Instalacion?, Se eliminaran Productos Sugeridos Agregados",{onPressOk:()=>Jo(this,void 0,void 0,(function*(){yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"BajaOrdenDet",null,{params:{tipo:e.TIPO_INSTALACION,orden:Y.value,pedido:Q.value,tecnico:e.TECNICO}}).then((e=>{(0,so.dF)("Detalle de Orden eliminado correctamente")})).catch((e=>{(0,so.L1)(e,{timeout:0,position:"right"})})).finally((()=>Jo(this,void 0,void 0,(function*(){yield ma(),Vo()}))))}))})},Eo=()=>Jo(this,void 0,void 0,(function*(){var e;let o,a,l=0;if(null!==sa.value){{const{value:e}=sa.value;o=e}if(null!==ua.value){{const{value:e}=ua.value;a=e}if(null!==ca.value){if(ae.value=!0,yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"AltaOrdenDet",null,{params:{tipoInstalacion:a,orden:Y.value,pedido:Q.value,tipoOrden:null===(e=sa.value)||void 0===e?void 0:e.value},validateStatus:()=>!0}).then((e=>{if(sa.value=null,ua.value=null,200!=e.status)throw l=99,ca.value=null,new Error("Error en Insertar el detalle de la Orden")})).catch((e=>{(0,so.L1)(e),ae.value=!1})),0===l)for(const{value:e,label:o}of[...ca.value])yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"AltaOrdenTecnicos",null,{params:{tipoInstalacion:a,orden:Y.value,tecnico:e,horas_extras:0,obser:""}}).then((e=>{200===e.status&&(0,so.dF)("Agregado Correctamente"),ca.value=null})).catch((e=>{(0,so.L1)(e)}));yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"AltaSugeridos",null,{params:{idTipo:a,orden:Y.value,pedido:Q.value}}).then((e=>{})).catch((e=>{(0,so.L1)(e)})),yield ma(),Vo(),ae.value=!1}else(0,so.x2)("Debe seleccionar por lo menos un Tecnico para la Orden de instalacion")}else(0,so.x2)("Debe seleccionar por lo menos un Tipo de Servicio de Instalacion")}else(0,so.x2)("Debe seleccionar por lo menos un Tipo de Orden de Instalacion")})),_o=()=>Jo(this,void 0,void 0,(function*(){yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"TipoOrden").then((e=>{const{data:o}=e;na.value=o.TIPOS_ORDENES})).catch((e=>{(0,so.L1)(e)}))})),ko=e=>Jo(this,void 0,void 0,(function*(){ua.value=null,yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"TipoInstalacion",{params:{}}).then((e=>{const{data:o}=e;da.value=o.TIPOS_INSTALACIONES})).catch((e=>{(0,so.L1)(e)}))})),Oo=()=>Jo(this,void 0,void 0,(function*(){yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"Tecnicos").then((e=>{const{data:o}=e;ra.value=o.TECNICOS})).catch((e=>{(0,so.L1)(e)}))})),No=()=>Jo(this,void 0,void 0,(function*(){var e;null!==u.value&&(yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"ActualizarFechaInst",null,{params:{pedido:Q.value,orden:Y.value,fecha:null===(e=u.value)||void 0===e?void 0:e.replace("/","-")}}).then((e=>{200===e.status&&(p.value=!1,r.value=$o.ZP.formatDate(u.value,"DD-MMMM-YYYY HH:mm"),(0,so.dF)("Fecha de Instalacion Actualizada Correctamente"))})).catch((e=>{(0,so.L1)(e)})))})),Io=()=>Jo(this,void 0,void 0,(function*(){var e;null!==c.value&&(yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"ActualizarFechaFin",null,{params:{ped:Q.value,ord:Y.value,date:null===(e=c.value)||void 0===e?void 0:e.replace("/","-")}}).then((e=>{200===e.status&&(p.value=!1,s.value=$o.ZP.formatDate(c.value,"DD-MMMM-YYYY HH:mm"),(0,so.dF)("Fecha de Instalacion Actualizada Correctamente"))})).catch((e=>{(0,so.L1)(e)})))})),To=e=>{if(null===u.value)return void(0,so.x2)("Debe Seleccionar la fecha Inicio de Instalacion");if(null===c.value)return void(0,so.x2)("Debe Seleccionar la fecha Final de Instalacion");let o,a,l=!1,i=!1,t=!0,n="T"===e?"Terminar":"Procesar";(0,so.wp)("Confirmar",`¿Está seguro de ${n} la Orden de Instalacion?`,{onPressOk:()=>Jo(this,void 0,void 0,(function*(){var n;if(yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"Validacion",{params:{fechaInstal:null===(n=u.value)||void 0===n?void 0:n.replace("/","-"),codOrden:Y.value}}).then((e=>{o=e.data.FECHAS,a=e.data.SUGERIDOS,Xo.log(o),Xo.log(a),o.length>0&&(l=!0),a.length>0&&(i=!0)})).catch((e=>{(0,so.L1)(e)})),l){let e="";o.forEach((o=>{e+="Tecnico: "+o.NOMBRE_TECNICO,e+=" ",e+="Orden: "+o.NUMERO_ORDEN,e+="\n"})),yield(0,so.pW)("Alerta","Existen Tecnicos asignados a otra orden con la misma fecha de instalacion, \n"+e+"\n ¿Desea continuar?",{onPressCancel:()=>{t=!1},onPressOk:()=>{t=!0}})}if(t){if(i){let e="";a.forEach((o=>{e+="Detalle: "+o.DETALLE,e+=" ",e+=o.PRODUCT0?"Cod Producto: "+o.PRODUCT0:"",e+="\n"})),yield(0,so.pW)("Alerta","Existen Productos Sugeridos Pendientes de agregar en el Checklist, \n"+e+"\n ¿Desea continuar?",{onPressCancel:()=>{t=!1},onPressOk:()=>{t=!0}})}t&&(yield to.api.post(to.endPoints.ORDENES_PENDIENTES+"ConvertirOrden",null,{params:{pedido:Q.value,orden:Y.value,estado:e}}).then((o=>Jo(this,void 0,void 0,(function*(){200===o.status&&(yield(0,vo._R)(1e3),"T"===e&&(yield E.push({name:"POS",params:{numeroPedido:Q.value}})),la(),Q.value=0,Y.value=0)})))).catch((e=>{(0,so.L1)(e)})))}}))})},xo=()=>Jo(this,void 0,void 0,(function*(){ae.value=!0;let e="";(0,Co.Q)("CARGANDO DATOS...","grey-9","dark","QSpinnerIos"),yield to.api.get(to.endPoints.ORDENES_PENDIENTES+Q.value).then((o=>Jo(this,void 0,void 0,(function*(){let a=o.data.Pedido,l=o.data.Orden,i=o.data.Fecha,v=o.data.FechaFin;return o.data.Pedido?"P"!==o.data.Pedido.Estado&&"O"!==o.data.Pedido.Estado?((0,so.x2)("El pedido ya no está pendiente ("+o.data.Pedido.Estado+")"),void(Q.value=0)):(k.value=a.Nit,yield(0,vo._R)(500),I.value=a.Nombre,T.value=a.Direccion,x.value=a.Correo,B.value=a.Total,$.value=parseInt(a.Nivel),le.value=a.Despacho,S.value=a.Observacion,n.value=l.TELEFONO,t.value=l.DIRECCION_INSTALACION,Y.value=l.NUMERO_ORDEN,u.value=i.FECHA_INSTALACION,c.value=v.FECHA_FIN_INSTALACION,d.value=l.ESTADO_ORDEN,null!==u.value&&(r.value=$o.ZP.formatDate(u.value,"DD-MMMM-YYYY HH:mm")),null!==c.value&&(s.value=$o.ZP.formatDate(c.value,"DD-MMMM-YYYY HH:mm")),a.Cliente===ee.value?(Z.value=1,e="FACT",qe(e)):(Z.value=2,K.value=a.Cliente,re.value=a.EsRuta,a.EsRuta||(j.value=a.Credito)),void Vo()):((0,so.x2)("No existe el pedido"),void(Q.value=0))})))).catch((e=>{(0,so.L1)(e),Q.value=0})),yield _o(),yield Oo(),yield ma(),(0,Co.E)(),ae.value=!1})),So=()=>{to.api.get(to.endPoints.PEDIDOENC+Q.value).then((e=>{let o=e.data.Pedido;B.value=o.Total})).catch((e=>{(0,so.L1)(e)}))},Vo=()=>{to.api.get(to.endPoints.PEDIDODET+Q.value).then((e=>{C.value=e.data.Detalles,So()})).catch((e=>{(0,so.L1)(e)}))},Ro=()=>Jo(this,void 0,void 0,(function*(){0!==Q.value&&(Q.value=0),(0,Co.Q)("CARGANDO ÚLTIMO PEDIDO...","grey-9","dark","QSpinnerIos"),yield to.api.get(to.endPoints.PEDIDOENC+"Ultimo").then((e=>{Q.value=e.data})).catch((e=>{(0,so.L1)(e),Q.value=0})),(0,Co.E)()})),Ho=()=>{y.dialog({title:"Pedido",message:"Ingrese el número de pedido",prompt:{model:"",type:"number"},cancel:!0,persistent:!1}).onOk((e=>{""!==e?Ao(parseInt(e)):Q.value=0})).onCancel((()=>{})).onDismiss((()=>{}))},Ao=e=>Jo(this,void 0,void 0,(function*(){0!==Q.value&&(Q.value=0,yield(0,vo._R)(500)),Q.value=e})),Lo=e=>{Ao(e)},Wo=e=>{Q.value,void 0!==e.Lote?V.value=e.Producto+"L"+e.Lote:(V.value=e.Producto,(0,vo.fC)("Enter"))},qo=e=>{var o;if(Q.value>0)return;K.value=null,K.value=e.Cliente;null===(o=Ce.value)||void 0===o||o.validate(e.Cliente)},Fo=e=>Jo(this,void 0,void 0,(function*(){k.value&&""!==k.value||(k.value=null,yield(0,vo._R)(500)),k.value=e.Nit})),Mo=()=>Jo(this,void 0,void 0,(function*(){var e,o;2===Z.value&&(K.value=null,re.value||(ve.value="")),k.value="",O.value="",N.value="",Oe.value="NIT",B.value=0,V.value="",H.value="",C.value.pop(),S.value="",x.value="",n.value="",t.value="",Ne.value=[],xe.value=[],u.value=null,r.value="",c.value=null,s.value="",d.value="",yield(0,vo._R)(500),1===Z.value?null===(e=fe.value)||void 0===e||e.focus():null===(o=Ce.value)||void 0===o||o.focus()})),Uo=(e,o,a,l)=>Jo(this,void 0,void 0,(function*(){var i;if(e===l)return;let t=0;t=e-l;const n={Pedido:Q.value,Producto:o,Cantidad:t,Precio:W.value,Lote:a,GeneraMov:!0,Despacho:le.value};yield to.api.post(to.endPoints.PEDIDODET,n).then((e=>{e.data.Mov?(0,so.wp)("Existencia","El producto no tiene existencia, desea generar MOVIMIENTO 43",{onPressOk:()=>{oo(!0)},onPressCancel:()=>{}}):((0,so.dF)("Cantidad cambiada para "+R.value+" correctamente"),V.value="",U.value=1)})).catch((e=>{var o,a;te.value=!1,null===(o=ge.value)||void 0===o||o.select(),null===(a=ge.value)||void 0===a||a.focus(),(0,so.L1)(e,{timeout:8e3,position:"top"})})).finally((()=>{te.value=!1,Vo()})),te.value=!1,null===(i=ge.value)||void 0===i||i.focus()})),zo=(e,o,a)=>Jo(this,void 0,void 0,(function*(){let a=0,l=!0;yield to.api.get(to.endPoints.PRODUCTO+"Precio",(0,to.configApi)({queryParams:{nivel:$.value,producto:o,numeroPedido:Q.value}})).then((e=>{a=e.data})).catch((e=>{(0,so.L1)(e),l=!1}));let i=null;if(e<a){if(i=yield(0,so.UA)("Contraña","INGRESE EL CODIGO DE AUTORIZACION","password"),!i)return void(0,so.x2)("Debe ingresar la contraseña para bajar el precio",{timeout:2500});yield to.api.post(to.endPoints.DATOSVEND+"validarContra",i).then((e=>{l=!0})).catch((e=>{(0,so.L1)(e),l=!1}))}if(!l)return;let t={Pedido:Q.value,Producto:o,Precio:e,Nivel:$.value,Pass:i};to.api.put(to.endPoints.PEDIDODET,t).then((e=>{Vo()})).catch((e=>{(0,so.L1)(e)}))})),Zo=()=>{Ae("")},Qo=e=>{var o;"Enter"===e.key||"F1"===e.key&&(null===(o=De.value)||void 0===o||o.openDialog(),e.preventDefault())},Yo=e=>{Xo.log("aplicado totoal"),Vo()},Bo=e=>{Ao(e)},jo=()=>{var e;Q.value=0,null===(e=fe.value)||void 0===e||e.focus()},Go=(e,o,a)=>{V.value=o.Producto+"L"+o.Lote},Ko=e=>{V.value=e},ea=()=>{cordova.plugins["barcodeScanner"].scan((function(e){if(0==e.cancelled&&(V.value=e.text,!q.value)){var o={key:"Enter"};Be(o)}}),(function(e){(0,so.dF)("Fallo al scanear: "+e)}),{showFlipCameraButton:!0,showTorchButton:!0,saveHistory:!0,resultDisplayDuration:0,formats:"CODABAR,CODE_128,EAN_13",orientation:"portrait"})},oa=e=>{if(null!==D.serie&&""!==D.serie)switch(Ee.value=e,ye.value=!0,e){case"nc":_e.value="Devolución";break;case"fact":_e.value="Factura";break;case"pedido":_e.value="Pedido";break;default:break}else(0,so.x2)("No hay serie, selecciones opción de ticket")},aa=()=>{var e,o,a;let l=10,i=10;screen.width,screen.height;let t="";"nc"===Ee.value?t="#/Reportes/NCDEV/"+D.serie+"/"+(null===(e=ke.value)||void 0===e?void 0:e.toString()):"fact"===Ee.value?t="#/Reportes/FACTURA/"+D.serie+"/"+(null===(o=ke.value)||void 0===o?void 0:o.toString()):"pedido"===Ee.value&&(t="#/Reportes/PEDIDOS/"+(null===(a=ke.value)||void 0===a?void 0:a.toString()),l=io.Z.width,i=io.Z.height),Xo.log(t),(0,Co.Q)("Imprimiendo...",void 0,void 0,"QSpinnerRadio");try{var n=window.open(t,"Factura","addressbar=no,directories=0,titlebar=0,toolbar=0,location=0,status=0,menubar=0,scrollbars=no,width="+l+", height="+i+", top=0, left=0");const e=setInterval((()=>{(null===n||void 0===n?void 0:n.closed)&&(clearInterval(e),ke.value=null,ye.value=!1,(0,Co.E)())}),500)}catch(d){Xo.log(d),(0,Co.E)()}},la=()=>{var e;if(null===u.value)return void(0,so.x2)("Debe Seleccionar la fecha de Instalacion");let o=10,a=10,l="";l="#/Reportes/ORDENES/"+(null===(e=Q.value)||void 0===e?void 0:e.toString()),o=io.Z.width,a=io.Z.height,Xo.log(l),(0,Co.Q)("Imprimiendo...",void 0,void 0,"QSpinnerRadio");try{var i=window.open(l,"Factura","addressbar=no,directories=0,titlebar=0,toolbar=0,location=0,status=0,menubar=0,scrollbars=no,width="+o+", height="+a+", top=0, left=0");const e=setInterval((()=>{(null===i||void 0===i?void 0:i.closed)&&(clearInterval(e),ke.value=null,ye.value=!1,(0,Co.E)())}),500)}catch(t){Xo.log(t),(0,Co.E)()}},ia=()=>Jo(this,void 0,void 0,(function*(){let e=yield(0,so.UA)("Ingrese la contraseña","","password");null!==e&&(yield to.api.post(to.endPoints.DATOSVEND+"validarContra",e).then((e=>{to.api.get(no.Rz+"Open?impresora="+(0,no.d4)()).then((e=>{})).catch((e=>{(0,so.L1)(e)}))})).catch((e=>{(0,so.L1)(e)})))})),ta=()=>{let e={NumeroPedido:Q.value,Observacion:S.value};to.api.put(to.endPoints.PEDIDOENC+"Observacion",e).then((e=>{(0,so.dF)("Observación guardada correctamente")})).catch((e=>{(0,so.L1)(e)}))},na=(0,ro.iH)([]),da=(0,ro.iH)([]),ra=(0,ro.iH)([]),sa=(0,ro.iH)(null),ua=(0,ro.iH)(null),ca=(0,ro.iH)(null),va=(0,ro.iH)([]),pa=[{name:"TIPO_INSTALACION",label:"Tipo de Instalación",field:"TIPO_INSTALACION",align:"center",sortable:!0},{name:"DESCRIPCION",label:"Descripción",field:"DESCRIPCION",align:"center",sortable:!0},{name:"TECNICO",label:"Código Técnico",field:"TECNICO",align:"center",sortable:!0},{name:"NOMBRE",label:"Nombre Tecnico",field:"NOMBRE",align:"center",sortable:!0},{name:"Horas",label:"Horas Laboradas",field:"Horas",align:"center",headerStyle:"padding:0px; padding-right:16px; width:50px;"},{name:"Eliminar",label:"Eliminar",field:"Eliminar",align:"center",headerStyle:"padding:0px; padding-right:16px; width:50px;"}],ma=()=>Jo(this,void 0,void 0,(function*(){yield to.api.get(to.endPoints.ORDENES_PENDIENTES+"VOrdenDet",{params:{pedido:Q.value,orden:Y.value}}).then((e=>{va.value=e.data.Ordenes})).catch((e=>{(0,so.x2)(e)}))}));return{dateString:r,initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:10},dateStringFin:s,estadoOrden:d,telefonoCliente:n,direccionInstalacion:t,updateFecha:No,updateFechaFin:Io,showModalDate:p,showModalDateFin:m,myDate:u,myDateFin:c,mostrarModalDetalle:i,modalGridCols:o,showModalDetalle:v,reloadModal:g,modalGridRows:h,convertirOrden:To,eliminarOrdenDet:Po,rows:va,columns_orden:pa,getOrdenDet:ma,modelOrden:sa,modelInstalacion:ua,modelTecnicos:ca,showModalHoras:P,optionsOrden:na,optionsInstalacion:da,optionsTecnicos:ra,horasModel:b,obsHorasModel:f,getTipoInstalacion:ko,altaOrdenDet:Eo,reporteOrdenesInstalacion:la,guardarHoras:go,mostrarModal:bo,limpiarModal:ho,abrirCaja:ia,aclienteDialog:Fo,agregandoListaProductos:Te,agregarProducto:oo,agregarProductoLote:ao,anularPedido:He,botonClientes:De,botonProd:Pe,buscarPrecio:ze,cambiarCantidad:Uo,cambiarPrecio:zo,cambiarTipo:Zo,cantidadPedir:U,cantRef:be,cargarNumero:Ho,cargarUltimo:Ro,clienteDialog:qo,clientePOS:ee,codigoCliente:K,codigoClienteRef:Ce,columnsAgregados:e,consultarLote:Ue,consultarNit:Fe,consultarProducto:Me,correoCliente:x,crearOrden:eo,crearPedido:Je,creditoContado:j,debounceProducto:Ie,descripcionLote:A,descripcionNivel:X,descripcionProd:L,despachado:Bo,direccionCliente:T,DPI:N,eliminarTodoProducto:mo,enableCantidad:q,enableConsulta:M,enableEliminar:F,enableMayorista:me,enableTicket:pe,errorCreditoContado:G,facturacion:D,filterAgregados:oe,formDetRef:he,formEncRef:we,getSuperMode:no.lz,guardarObservacion:ta,inFullscreen:ne,isFromLoad:ae,keyDownCliente:Qo,keyDownProducto:$e,keyDownProductoCant:Xe,keyPressProducto:Be,limpiarDatos:Ze,limpiarNuevo:Mo,loadAgregando:te,loadingNit:_,loadProducto:ie,lote:H,maestroProducto:R,NIT:k,NITAUX:O,NITRef:fe,nivelPrecio:$,nombreCliente:I,nuevoCF:Ye,numeroPedido:Q,numeroOrden:Y,numeroReimp:ke,observacion:S,obtenerDatosFacturacion:Ae,obtenerEnc:xo,obtenerProductos:Vo,obtenerSerieFacturacion:qe,onCuponAplicado:Yo,onFacturado:jo,opcion:le,openPrompt:oa,pageKey:Re,pedidoRuteros:re,permiteCambioPrecio:ue,precioProducto:W,preciosProd:J,producto:V,productoDialog:Wo,productoRef:ge,productosErrorSuper:xe,prompt:ye,reimprimirFactDoc:aa,rowsAgregados:C,scanBarra:Ko,scanBarraCordova:ea,selectRow:Go,serie:ve,setCF:Qe,setNumeroPedido:Ao,showUMTool:(0,ro.iH)(!1),subTotal:B,textReimpresion:_e,tieneRuteros:de,tieneTecnicos:se,tipo_especial:Oe,tipoPedido:Z,transformado:Lo,tutorial:Se,ums:ce,validarNit:z,checkSugeridos:a}},watch:{NIT(e){e&&e.includes("/")?this.NIT=null===e||void 0===e?void 0:e.replace("/",""):(this.NIT=null===e||void 0===e?void 0:e.toUpperCase(),this.isFromLoad||1===this.tipoPedido&&this.consultarNit())},codigoCliente(e){this.isFromLoad||(2===this.tipoPedido&&this.consultarNit(),e&&""!==e?this.errorCreditoContado=!1:this.creditoContado=null)},producto(e){let o="";o=e,null!=o&&(o=o.trim().replace("+","").replace("*","").replace("/","")),this.producto=o,(0,no.lz)()||this.consultarProducto()},lote(e){""===this.descripcionLote&&this.consultarLote()},tipoPedido(e){this.isFromLoad||(this.limpiarDatos(),1===this.tipoPedido?(this.obtenerDatosFacturacion(),this.opcion="S"):(this.obtenerDatosFacturacion(""),this.creditoContado=null,this.codigoCliente=null,this.nivelPrecio=null,this.descripcionNivel="",this.tipo_especial="NIT"),""!==this.producto&&(this.producto=""))},enableCantidad(e){var o,a;try{e?null===(o=this.cantRef)||void 0===o||o.select():this.cantidadPedir=1,null===(a=this.productoRef)||void 0===a||a.focus()}catch(l){Xo.log(l)}},numeroPedido(e){0!==e?this.obtenerEnc():this.limpiarNuevo()},opcion(e){},creditoContado(e){this.errorCreditoContado=!1,null===e?this.obtenerSerieFacturacion(""):e?this.obtenerSerieFacturacion("FCRE"):this.obtenerSerieFacturacion("FCON")},serie(e){this.facturacion.serie=this.serie},cantidadPedir(e){this.buscarPrecio()},pedidoRuteros(e){(0,lo.Z)("primary","#1976d2"),e?this.obtenerSerieFacturacion("FRUT"):this.obtenerSerieFacturacion("")},tipo_especial(e){2===this.tipoPedido&&("NIT"===e?this.NIT=this.NITAUX:"DPI"===e&&(this.NIT=this.DPI))}},created(){return Jo(this,void 0,void 0,(function*(){(0,lo.Z)("primary","#1976d2"),yield this.obtenerDatosFacturacion(),this.$nextTick((()=>{this.tutorial()})),this.$route.params.numeroPedido&&(yield this.setNumeroPedido(Number(this.$route.params.numeroPedido)))}))},unmounted(){(0,lo.Z)("primary","#1976d2")},methods:{forceUpdate(){Xo.log("Update"),setTimeout((()=>{location.reload()}),2e3)},validateEmail(e){if(null==e||""==e)return!0;const o=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return o.test(e)}}});var oa=a(69885),aa=a(13119),la=a(11821),ia=a(1389),ta=a(22857),na=a(8830),da=a(8326),ra=a(11221),sa=a(50926),ua=a(26384),ca=a(84277),va=a(66933),pa=a(85863),ma=a(92952),ga=a(86770);const ha=(0,Ho.Z)(ea,[["render",ao],["__scopeId","data-v-6eb4c562"]]),ba=ha;Bo()(ea,"components",{QBar:qo.Z,QBtn:Ao.Z,QTooltip:Mo.Z,QSpace:Fo.Z,QPage:oa.Z,QDialog:Lo.Z,QCard:Wo.Z,QCardSection:Uo.Z,QInput:aa.Z,QCardActions:la.Z,QBtnToggle:ia.Z,QIcon:ta.Z,QOptionGroup:na.Z,QForm:da.Z,QCheckbox:ra.Z,QSeparator:sa.Z,QSelect:ua.Z,QTable:ca.Z,QTd:Zo.Z,QMarkupTable:va.Z,QPopupEdit:pa.Z,QDate:ma.Z,QTime:ga.Z}),Bo()(ea,"directives",{ClosePopup:Qo.Z})}}]);