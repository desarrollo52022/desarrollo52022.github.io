"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[629],{20629:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Fe});var i=a(59835),l=a(86970);const n={class:"q-pa-sm report-ticket-p",id:"printFactura"},o={id:"factura"},s={class:"text-subtitle2 text-center text-weight-bold"},c={class:"text-caption text-center"},r={class:"text-caption text-center"},d={class:"text-caption text-center"},p={class:"text-caption text-center"},u={key:0},x=(0,i._)("div",{class:"text-caption text-center"},"DOCUMENTO TRIBUTARIO ELECTRÃ“NICO",-1),w=(0,i._)("div",{class:"text-caption text-center"},"FACTURA ELECTRÃ“NICA",-1),g={class:"text-caption text-center"},v={class:"text-caption text-center"},h=(0,i._)("div",{class:"text-caption text-center"},"NÃšMERO DE AUTORIZACIÃ“N",-1),m={class:"text-caption text-center text-weight-bolder"},b={key:1},_=(0,i._)("div",{class:"text-caption text-center"},"DOCUMENTO EMITIDO EN CONTINGENCIA",-1),f=(0,i._)("div",{class:"text-caption text-center"},"CÃ“DIGO DE ACCESO",-1),S={class:"text-caption text-center text-weight-bolder"},T={class:"text-caption text-center"},C={class:"text-caption text-center"},y=(0,i._)("div",{class:"text-caption text-center"},"NOMBRE:",-1),k={class:"text-caption text-center text-weight-bolder"},E={class:"text-caption text-center text-weight-bolder"},I=(0,i._)("div",{class:"text-caption text-center"},"DIRECCIÃ“N:",-1),z={class:"text-caption text-center text-weight-bolder"},F={class:"no-padding",style:{"line-height":"1.5em",height:"1.5em","white-space":"normal",overflow:"hidden","text-overflow":"ellipsis","font-size":"0.5rem"}},D={class:"no-padding",style:{"line-height":"1em",height:"1.5rem","white-space":"normal",overflow:"hidden","text-overflow":"ellipsis","font-size":"0.4rem"}},q={key:2},N={class:"no-padding",style:{"line-height":"1.5rem",height:"1.5rem","white-space":"normal",overflow:"hidden","text-overflow":"ellipsis","font-size":"0.5rem"}},R={class:"no-padding",style:{"line-height":"1em",height:"1.5em","white-space":"normal",overflow:"hidden","text-overflow":"ellipsis","font-size":"0.4rem"}},O={class:"row"},A=(0,i._)("div",{class:"col-7 text-caption q-pl-lg"},"Subtotal",-1),P=(0,i._)("div",{class:"col-1 text-caption text-right"},"Q.",-1),H={class:"col-4 text-caption text-right q-pr-lg"},L={class:"row"},M={class:"col-7 text-caption q-pl-lg"},U=(0,i._)("div",{class:"col-1 text-caption text-right"},"Q.",-1),Q={class:"col-4 text-caption text-right q-pr-lg"},W={class:"row"},G=(0,i._)("div",{class:"col-7 text-caption text-weight-bolder q-pl-lg"},"Total a pagar",-1),Z=(0,i._)("div",{class:"col-1 text-caption text-weight-bolder text-right"},"Q.",-1),B={class:"col-4 text-caption text-weight-bolder text-right q-pr-lg"},j=(0,i._)("br",null,null,-1),$={key:4},J={class:"text-caption text-center text-weight-bolder"},V=(0,i._)("div",{class:"text-caption text-center"},"SegÃºn art. 7 num. 15 Ley del IVA del Congreso de la RepÃºblica",-1),K={class:"text-caption text-center"},X=(0,i._)("div",{class:"text-caption text-center"},"DATOS DEL CERTIFICADOR",-1),Y=(0,i._)("div",{class:"text-caption text-center"},"INFILE, S.A.",-1),ee=(0,i._)("div",{class:"text-caption text-center"},"NIT: 12521337",-1),te={key:6,class:"text-center"},ae=(0,i._)("canvas",{id:"canvasQR"},null,-1),ie=[ae],le=(0,i._)("div",{class:"text-caption text-weight-bolder text-center"},"SUJETO A PAGOS TRIMESTRALES",-1),ne=["innerHTML"],oe=["innerHTML"],se=["innerHTML"],ce=(0,i._)("br",null,null,-1);function re(e,t,a,ae,re,de){const pe=(0,i.up)("q-circular-progress"),ue=(0,i.up)("q-separator"),xe=(0,i.up)("q-td"),we=(0,i.up)("q-table");return(0,i.wg)(),(0,i.iD)("div",n,[null===e.enc?((0,i.wg)(),(0,i.j4)(pe,{key:0,indeterminate:"",size:"150px",thickness:.5,color:"primary","center-color":"grey-8","track-color":"transparent",class:"q-ma-md fixed-center"},null,8,["thickness"])):(0,i.kq)("",!0),null!==e.enc?((0,i.wg)(),(0,i.j4)(i.n4,{key:1},{default:(0,i.w5)((()=>[(0,i._)("div",o,[(0,i._)("div",s,(0,l.zw)(e.enc.NombreComercial),1),(0,i._)("div",c,(0,l.zw)(e.enc.Emisor),1),(0,i._)("div",r,(0,l.zw)(e.enc.Direccion),1),(0,i._)("div",d,"NIT: "+(0,l.zw)(e.enc.Nit),1),(0,i._)("div",p,"TELÃ‰FONO: "+(0,l.zw)(e.enc.Telefono),1),e.enc.Uuid?((0,i.wg)(),(0,i.iD)("div",u,[x,w,(0,i._)("div",g,"SERIE: "+(0,l.zw)(e.enc.SerieFel),1),(0,i._)("div",v,"NÃšMERO: "+(0,l.zw)(e.enc.FacturaFel),1),h,(0,i._)("div",m,(0,l.zw)(e.enc.Uuid),1)])):((0,i.wg)(),(0,i.iD)("div",b,[_,f,(0,i._)("div",S,(0,l.zw)(e.enc.Contingencia),1)])),(0,i._)("div",T,"FECHA EMISIÃ“N:"+(0,l.zw)(e.enc.Fecha),1),(0,i._)("div",C," NÃšMERO INTERNO:"+(0,l.zw)(e.enc.Serie)+" | "+(0,l.zw)(e.enc.Factura),1),(0,i.Wm)(ue,{spaced:"",inset:""}),y,(0,i._)("div",k,(0,l.zw)(e.enc.NombreCliente),1),(0,i._)("div",E,"NIT: "+(0,l.zw)(e.enc.NitCliente),1),I,(0,i._)("div",z,(0,l.zw)(e.enc.DireccionCliente),1),(0,i.Wm)(we,{class:"q-ml-sm",rows:e.rows,columns:e.columns,separator:"cell","hide-bottom":"",square:"",flat:"",bordered:"","wrap-cells":"",pagination:{rowsPerPage:0}},{"body-cell":(0,i.w5)((e=>[(0,i.Wm)(xe,{props:e,style:{"max-width":"20px"},class:"no-padding"},{default:(0,i.w5)((()=>[(0,i._)("div",F,(0,l.zw)(e.value),1)])),_:2},1032,["props"])])),"body-cell-Descripcion":(0,i.w5)((e=>[(0,i.Wm)(xe,{props:e,style:{"max-width":"55px"},class:"no-padding"},{default:(0,i.w5)((()=>[(0,i._)("div",D,(0,l.zw)(e.value),1)])),_:2},1032,["props"])])),_:1},8,["rows","columns"]),e.enc.TotalGenerico>0?((0,i.wg)(),(0,i.iD)("div",q,"Exentos de IVA")):(0,i.kq)("",!0),e.enc.TotalGenerico>0?((0,i.wg)(),(0,i.j4)(we,{key:3,class:"q-ml-sm",rows:e.rowsSinIva,columns:e.columns,separator:"cell","hide-bottom":"",square:"",flat:"",bordered:"","wrap-cells":"",pagination:{rowsPerPage:0}},{"body-cell":(0,i.w5)((e=>[(0,i.Wm)(xe,{props:e,style:{"max-width":"20px"},class:"no-padding"},{default:(0,i.w5)((()=>[(0,i._)("div",N,(0,l.zw)(e.value),1)])),_:2},1032,["props"])])),"body-cell-Descripcion":(0,i.w5)((e=>[(0,i.Wm)(xe,{props:e,style:{"max-width":"55px"},class:"no-padding"},{default:(0,i.w5)((()=>[(0,i._)("div",R,(0,l.zw)(e.value),1)])),_:2},1032,["props"])])),_:1},8,["rows","columns"])):(0,i.kq)("",!0),(0,i.Wm)(ue,{spaced:"",inset:"",color:"white"}),(0,i._)("div",O,[A,P,(0,i._)("div",H,(0,l.zw)(e.subTotal.toFixed(2)),1)]),(0,i._)("div",L,[(0,i._)("div",M," Descuento "+(0,l.zw)(e.enc.MontoCupon>0?e.enc.Cupon:""),1),U,(0,i._)("div",Q,(0,l.zw)(e.enc.Descuento.toFixed(2)),1)]),(0,i.Wm)(ue,{inset:"",color:"black"}),(0,i._)("div",W,[G,Z,(0,i._)("div",B,(0,l.zw)(e.enc.Total.toFixed(2)),1)]),j,e.enc.TotalGenerico>0?((0,i.wg)(),(0,i.iD)("div",$,[(0,i._)("div",J,"* Total No Afecto a Iva Q."+(0,l.zw)(e.enc.TotalGenerico.toFixed(2)),1),V])):(0,i.kq)("",!0),(0,i._)("div",K,"Le atendio "+(0,l.zw)(e.enc.Vendedor),1),(0,i.Wm)(ue,{spaced:"",inset:""}),X,Y,ee,e.enc.Uuid?((0,i.wg)(),(0,i.j4)(ue,{key:5,spaced:"",inset:"",style:{margin:"0px!important"}})):(0,i.kq)("",!0),e.enc.Uuid?((0,i.wg)(),(0,i.iD)("div",te,ie)):(0,i.kq)("",!0),(0,i.Wm)(ue,{spaced:"",inset:"",style:{margin:"0px!important"}}),le,(0,i._)("div",{class:"text-caption text-center",innerHTML:e.textos[0]},null,8,ne),(0,i._)("div",{class:"text-caption text-center",innerHTML:e.textos[1]},null,8,oe),(0,i.Wm)(ue,{spaced:"",inset:"",color:"white"}),(0,i._)("div",{class:"text-caption text-center",innerHTML:e.textos[2]},null,8,se),ce])])),_:1})):(0,i.kq)("",!0)])}var de=a(34136),pe=a(68651),ue=a(78618),xe=a(32222),we=a(60499),ge=a(18910),ve=a(67825),he=a(75700),me=a(32316),be=a(17779);const _e=[{name:"Cantidad",required:!0,label:"Cant",align:"center",field:"Cantidad",headerClasses:"no-padding",headerStyle:"width:1px; max-width:12px; white-space: break-spaces; overflow-wrap: break-word;"},{name:"Descripcion",align:"center",label:"DescripciÃ³n",field:"Descripcion",headerClasses:"no-padding",headerStyle:"width: 1px; max-width:1px; white-space: break-spaces; overflow-wrap: break-word;"},{name:"Precio",label:"Precio",align:"center",field:"Precio",headerClasses:"no-padding",headerStyle:"width:1px; max-width:10px; white-space: break-spaces; overflow-wrap: break-word;"},{name:"Subtotal",label:"Subtotal",align:"center",field:"Subtotal",headerClasses:"no-padding",headerStyle:"width:1px; max-width:22px; white-space: break-spaces; overflow-wrap: break-word;"}],fe=(0,i.aZ)({name:"Factura",setup(){(0,ge.tv)();const e=(0,we.iH)(null),t=(0,we.iH)(""),a=(0,we.iH)(null),i=(0,we.iH)([]),l=(0,we.iH)([]),n=(0,we.iH)(0),o=(0,we.iH)(!1),s=(0,we.iH)(!1),c=(0,we.iH)([]),r=async()=>{if(o.value=!0,null==e.value)return;if(await de.api.get(de.endPoints.FACTURAR,(0,de.configApi)({serie:t.value,queryParams:{numeroFactura:e.value}})).then((e=>{if(null===e.data.Encabezado)return(0,pe.x2)("No existe la factura"),void setTimeout((()=>{window.close()}),1500);a.value=e.data.Encabezado,i.value=e.data.Detalles,be.log("ðŸš€ ~ file: Factura.vue ~ line 290 ~ .then ~ Detalles",i.value),l.value=e.data.DetallesSinIva,i.value.map((e=>{n.value+=e.Subtotal;let t=0,a=0;t=e.Precio,a=e.Subtotal;let i=t.toString().split(".");if(i[0].length>=4&&void 0!==i[1]&&i[1].length>=3)e.Precio=i[0]+". "+i[1];else if(i[0].length>=8){let a=t.toString(),i=a.substring(0,8)+" "+a.substring(8,a.length);e.Precio=i}else e.Precio=e.Precio.toFixed(2);if(i=e.Subtotal.toString().split("."),i[0].length>3&&void 0!==i[1]&&i[1].length>2)e.Subtotal=i[0]+". "+i[1];else if(i[0].length>=8){let t=a.toString(),i=t.substring(0,8)+" "+t.substring(8,t.length);e.Subtotal=i}else e.Subtotal=e.Subtotal.toFixed(2)})),l.value.map((e=>{n.value+=e.Subtotal;let t=0,a=0;t=e.Precio,a=e.Subtotal;let i=t.toString().split(".");if(i[0].length>=4&&i[1].length>=3)e.Precio=i[0]+". "+i[1];else if(i[0].length>=8){let a=t.toString(),i=a.substring(0,8)+" "+a.substring(8,a.length);e.Precio=i}else e.Precio=e.Precio.toFixed(2);if(i=e.Subtotal.toString().split("."),i[0].length>3&&i[1].length>2)e.Subtotal=i[0]+". "+i[1];else if(i[0].length>=8){let t=a.toString(),i=t.substring(0,8)+" "+t.substring(8,t.length);e.Subtotal=i}else e.Subtotal=e.Subtotal.toFixed(2)})),n.value=parseFloat(n.value.toFixed(2))})).catch((e=>{(0,pe.L1)(e)})).finally((()=>{o.value=!1})),null===a.value)return void setTimeout((()=>{window.close()}),1e3);let s=ve.qC+a.value.Uuid;me.toCanvas(document.getElementById("canvasQR"),s,{toSJISFunc:me.toSJIS,width:100},(function(e){e&&be.error(e),be.log("success!")})),c.value=await(0,he.E)("Factura"),setTimeout((()=>{(0,ve.Qe)()?(0,xe.Bx)("printFactura","ticket",!1,!0,"Factura_"+e.value):d()}),500),endLoading()},d=async()=>{be.log("creando b64");let e=document.getElementById("printFactura"),t=await(0,xe.UC)(e,"ticket"),a={printer:(0,ve.d4)(),factura:t,filename:"facturaTicket.pdf"};de.api.post(ve.Rz,a).then((e=>{be.log(e)})).catch((e=>{be.log("er",e)})).finally((()=>{s.value,window.close()}))};return{getData:r,numeroFactura:e,serie:t,enc:a,columns:_e,rows:i,rowsSinIva:l,subTotal:n,loading:o,print:s,textos:c}},created(){this.numeroFactura=this.$router.currentRoute.value.params.Factura,this.serie=this.$router.currentRoute.value.params.Serie,this.$router.currentRoute.value.query.print?(this.print=!1,this.print=(0,ue.gx)(this.$router.currentRoute.value.query.print?.toString())):this.print=!0,window.blur(),window.parent.focus(),this.getData()}});var Se=a(11639),Te=a(83302),Ce=a(50926),ye=a(84277),ke=a(67220),Ee=a(69984),Ie=a.n(Ee);const ze=(0,Se.Z)(fe,[["render",re]]),Fe=ze;Ie()(fe,"components",{QCircularProgress:Te.Z,QSeparator:Ce.Z,QTable:ye.Z,QTd:ke.Z})}}]);