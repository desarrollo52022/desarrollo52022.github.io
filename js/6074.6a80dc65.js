"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[6074],{76074:(e,a,l)=>{l.r(a),l.d(a,{default:()=>J});var i=l(59835),t=l(86970);const n={class:"row"},o={class:"col-xs-12 col-sm-2"},r={class:"col-xs-12 col-sm-3"},c={class:"col-xs-12 col-sm-5"},s={class:"block text-h4"};function u(e,a,l,u,d,m){const p=(0,i.up)("q-btn"),f=(0,i.up)("GymClientes"),g=(0,i.up)("q-icon"),h=(0,i.up)("q-input"),v=(0,i.up)("q-table"),C=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(C,{padding:""},{default:(0,i.w5)((()=>[(0,i._)("div",n,[(0,i._)("div",o,[(0,i.Wm)(p,{color:"primary",label:"Cagar Facturas",onClick:e.getFacturas},null,8,["onClick"])]),(0,i._)("div",r,[(0,i.Wm)(f,{factura:e.factura,serie:e.serie,onAsignado:e.limpiar},null,8,["factura","serie","onAsignado"])]),(0,i._)("div",c,[(0,i._)("div",s,(0,t.zw)(e.serie)+" - "+(0,t.zw)(e.factura),1)])]),(0,i.Wm)(v,{title:"Facturas",rows:e.facturas,filter:e.filter,columns:e.columns,"row-key":"name",pagination:{rowsPerPage:20},onRowClick:e.setDatos,dense:""},{"top-right":(0,i.w5)((()=>[(0,i.Wm)(h,{borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":a[0]||(a[0]=a=>e.filter=a),placeholder:"Buscar Factura",clearable:""},{append:(0,i.w5)((()=>[(0,i.Wm)(g,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["rows","filter","columns","onRowClick"])])),_:1})}var d=l(34136);const m=(0,i.Uk)("Cerrar"),p={class:"row"},f={class:"col-xs-12 col-sm-6"},g={class:"row full-width"},h={class:"row full-width justify-between"},v={class:"col-5"},C={class:"col-5"},b={class:"row items-center justify-end"},w={class:"col-xs-12 col-sm-6"};function F(e,a,l,n,o,r){const c=(0,i.up)("q-btn"),s=(0,i.up)("q-space"),u=(0,i.up)("q-tooltip"),d=(0,i.up)("q-bar"),F=(0,i.up)("q-td"),_=(0,i.up)("q-tr"),y=(0,i.up)("q-table"),P=(0,i.up)("q-separator"),E=(0,i.up)("q-icon"),k=(0,i.up)("q-input"),D=(0,i.up)("q-date"),W=(0,i.up)("q-popup-proxy"),N=(0,i.up)("q-card"),V=(0,i.up)("q-dialog"),I=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",null,[(0,i.Wm)(c,{color:"blue-grey",icon:"group_add",label:"Asignar",onClick:a[0]||(a[0]=a=>e.show=!0),disable:0==e.numeroFactura},null,8,["disable"])]),(0,i.Wm)(V,{modelValue:e.show,"onUpdate:modelValue":a[8]||(a[8]=a=>e.show=a),maximized:""},{default:(0,i.w5)((()=>[(0,i.Wm)(N,null,{default:(0,i.w5)((()=>[(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Wm)(s),(0,i.wy)(((0,i.wg)(),(0,i.j4)(c,{dense:"",flat:"",icon:"close"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{class:"bg-white text-primary"},{default:(0,i.w5)((()=>[m])),_:1})])),_:1})),[[I]])])),_:1}),(0,i.Wm)(c,{color:"red",icon:"check",label:"Completar",onClick:e.completarAsignacion},null,8,["onClick"]),(0,i.Wm)(y,{title:"Factura "+e.serieUsar+"-"+e.numeroFactura,rows:e.facturaProductos,columns:[{name:"serie",field:"Serie",label:"Serie",align:"center"},{name:"factura",field:"Factura",label:"Factura",align:"center"},{name:"Nombre",field:"Nombre",label:"Nombre",align:"center"},{name:"Disponible",field:"Disponible",label:"Disponible",align:"center"},{name:"Producto",field:"Producto",label:"Producto",align:"center"}],"row-key":"name"},{body:(0,i.w5)((a=>[(0,i.Wm)(_,{props:a,onClick:l=>{e.producto=a.row.Producto},class:(0,t.C_)(e.producto===a.row.Producto?"bg-grey":"")},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.cols,(e=>((0,i.wg)(),(0,i.j4)(F,{key:e.name,props:a},{default:(0,i.w5)((()=>[(0,i.Uk)((0,t.zw)(e.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props","onClick","class"])])),_:1},8,["title","rows"]),(0,i.Wm)(P,{spaced:"",inset:"",vertical:"",dark:""}),(0,i.Wm)(P,{spaced:"",inset:"",vertical:"",dark:""}),(0,i._)("div",p,[(0,i._)("div",f,[(0,i.Wm)(y,{style:{height:"50vh"},title:"Clientes",rows:e.clientes,columns:[{name:"cliente",label:"Cliente",field:"Cliente",align:"center"},{name:"nombre",label:"Nombre",field:"Nombre",align:"center"},{name:"Nit",label:"Nit",field:"Nit",align:"center"},{name:"Dpi",label:"Dpi",field:"Dpi",align:"center"}],"row-key":"name",pagination:{rowsPerPage:0},"rows-per-page-options":[0],dense:"",onRowDblclick:e.asignarCliente,onRowClick:a[7]||(a[7]=(a,l,i)=>{e.selectedCliente(l)})},{top:(0,i.w5)((()=>[(0,i._)("div",g,[(0,i.Wm)(k,{autofocus:"",dense:"",debounce:"500",clearable:"",modelValue:e.nombreCliente,"onUpdate:modelValue":a[1]||(a[1]=a=>e.nombreCliente=a),placeholder:"Buscar Cliente",class:"col"},{append:(0,i.w5)((()=>[(0,i.Wm)(E,{name:"search"})])),_:1},8,["modelValue"]),(0,i.Wm)(k,{autofocus:"",dense:"",debounce:"500",clearable:"",modelValue:e.nit,"onUpdate:modelValue":a[2]||(a[2]=a=>e.nit=a),placeholder:"Buscar nit",class:"col"},{append:(0,i.w5)((()=>[(0,i.Wm)(E,{name:"search"})])),_:1},8,["modelValue"]),(0,i.Wm)(k,{autofocus:"",dense:"",debounce:"500",clearable:"",modelValue:e.dpi,"onUpdate:modelValue":a[3]||(a[3]=a=>e.dpi=a),placeholder:"Buscar dpi",class:"col"},{append:(0,i.w5)((()=>[(0,i.Wm)(E,{name:"search"})])),_:1},8,["modelValue"])]),(0,i._)("div",h,[(0,i._)("div",v,[(0,i.Wm)(k,{filled:"",modelValue:e.fechaVencimiento,"onUpdate:modelValue":a[4]||(a[4]=a=>e.fechaVencimiento=a),placeholder:"Fecha Final Vigente",label:"Fecha Final Vigente",disable:"",readonly:""},null,8,["modelValue"])]),(0,i._)("div",C,[(0,i.Wm)(k,{placeholder:"Fecha Inicio",filled:"",modelValue:e.fechaInicio,"onUpdate:modelValue":a[6]||(a[6]=a=>e.fechaInicio=a),mask:"date",rules:["date"]},{append:(0,i.w5)((()=>[(0,i.Wm)(E,{name:"event",class:"cursor-pointer"},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(D,{modelValue:e.fechaInicio,"onUpdate:modelValue":[a[5]||(a[5]=a=>e.fechaInicio=a),e.optionsFn]},{default:(0,i.w5)((()=>[(0,i._)("div",b,[(0,i.wy)((0,i.Wm)(c,{label:"Close",color:"primary",flat:""},null,512),[[I]])])])),_:1},8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])])),body:(0,i.w5)((a=>[(0,i.Wm)(_,{props:a,onClick:l=>e.selectedCliente(a.row),onDblclick:l=>e.asignarCliente(a.row),class:(0,t.C_)(e.clienteSelect===a.row.Cliente?"bg-grey":"")},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.cols,(e=>((0,i.wg)(),(0,i.j4)(F,{key:e.name,props:a},{default:(0,i.w5)((()=>[(0,i.Uk)((0,t.zw)(e.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props","onClick","onDblclick","class"])])),_:1},8,["rows","onRowDblclick"])]),(0,i._)("div",w,[(0,i.Wm)(y,{style:{height:"50vh"},title:"Clientes Asignados",rows:e.facturaClientes,columns:[{name:"cliente",label:"Cliente",field:"Cliente",align:"center"},{name:"nombre",label:"Nombre",field:"Nombre",align:"center"},{name:"Producto",label:"Producto",field:"Producto",align:"center"},{name:"nombre",label:"Cantidad",field:"Cantidad",align:"center"},{name:"Delete",label:"Eliminar",field:"Delete",align:"center"}],"row-key":"name"},{"body-cell-Delete":(0,i.w5)((a=>[(0,i.Wm)(F,{props:a},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{size:"md",outline:"",color:"red",icon:"delete",onClick:l=>e.eliminarAsignacion(a.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["rows"])])])])),_:1})])),_:1},8,["modelValue"])],64)}var _=l(54170),y=l(88656),P=l(68651),E=l(60499),k=function(e,a,l,i){function t(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,n){function o(e){try{c(i.next(e))}catch(a){n(a)}}function r(e){try{c(i["throw"](e))}catch(a){n(a)}}function c(e){e.done?l(e.value):t(e.value).then(o,r)}c((i=i.apply(e,a||[])).next())}))};const D=(0,i.aZ)({name:"GymClientes",props:{factura:{type:Number,required:!0},serie:{type:String,required:!0}},emits:["asignado"],setup(e,{emit:a}){const l=(0,E.iH)(!1),t=(0,E.iH)(e.factura),n=(0,E.iH)(e.serie),o=(0,E.iH)([]),r=(0,E.iH)([]),c=(0,E.iH)(""),s=(0,E.iH)(""),u=(0,E.iH)(""),m=(0,E.iH)([]),p=(0,E.iH)(null),f=(0,E.iH)(null),g=(0,E.iH)(""),h=(0,E.iH)("");let v=(0,E.iH)(""),C=(0,E.iH)("");(0,i.YP)(e,(()=>{n.value=e.serie,t.value=e.factura,g.value="",b(),F()}));const b=()=>{d.api.get(d.endPoints.GYMCLIENTES+"TiempoFactura",(0,d.configApi)({queryParams:{factura:t.value,serie:n.value}})).then((e=>{o.value=e.data})).catch((e=>{(0,P.L1)(e)}))},w=()=>k(this,void 0,void 0,(function*(){let e={rowsPerPage:100,nombre:c.value,nit:s.value,dpi:u.value};yield d.api.get(d.endPoints.CLIENTE+"NombreGym",(0,d.configApi)({queryParams:e})).then((e=>{let a=[]=e.data.Clientes;r.value=a})).catch((e=>{(0,P.L1)(e)}))})),F=()=>k(this,void 0,void 0,(function*(){yield d.api.get(d.endPoints.GYMCLIENTES+"FacturaClientes",(0,d.configApi)({queryParams:{factura:t.value,serie:n.value}})).then((e=>{m.value=e.data})).catch((e=>{(0,P.L1)(e)}))})),D=e=>k(this,void 0,void 0,(function*(){if(""===g.value)return void(0,P.x2)("Debe seleccionar el producto a asignar");if(null===f.value||""===f.value)return void(0,P.x2)("Debe seleccionar la fecha de inicio");let a=yield(0,P.UA)("Asignar","Tiempo a asignar","number");if(null===a||!Number(a))return void(0,P.x2)("Debe Ingresar el Tiempo a asignar.");if(a<0)return void(0,P.x2)("El tiempo ingresado no es valido, no debe ser menor a cero");let l={serie:n.value,factura:t.value,cliente:e.Cliente,producto:g.value,tiempo:a,fechaInicio:f.value};yield d.api.post(d.endPoints.GYMCLIENTES+"asignarFactura",l).then((e=>{(0,P.dF)("Asigando Correctamente"),F(),b(),v.value="",C.value="",f.value=null})).catch((e=>{(0,P.L1)(e)}))})),W=e=>k(this,void 0,void 0,(function*(){const a=yield(0,P.pW)("Confirmacion","Esta seguro de eliminar el registro?",{});if(!a)return;let l={serie:n.value,factura:t.value,cliente:e.Cliente,producto:e.Producto,tiempo:0,fechaInicio:"2000-01-01 00:00:00.000"};yield d.api.post(d.endPoints.GYMCLIENTES+"asignarFactura",l).then((e=>{(0,P.dF)("Eliminado Correctamente"),F(),b()})).catch((e=>{(0,P.L1)(e)}))})),N=()=>k(this,void 0,void 0,(function*(){if(0===m.value.length)return void(0,P.x2)("Error: No ha ingresado ninguna asignación!");let e={serie:n.value,factura:t.value},i=yield(0,P.pW)("Confirmación","¿Está seguro de generar los tiempos y fechas para los usuarios?",{});i&&(yield d.api.post(d.endPoints.GYMCLIENTES+"completarFactura",e).then((e=>{if((0,P.dF)("Proceso completado correctamente!"),l.value=!1,a("asignado"),200===e.status){const a=e.data.clientesContrato;a.forEach((e=>k(this,void 0,void 0,(function*(){return yield(0,y.x)(e.CODIGO_CLIENTE)}))))}})).catch((e=>{(0,P.L1)(e,{timeout:5e3})})))})),V=()=>k(this,void 0,void 0,(function*(){let e={cliente:p.value,huella:h.value};yield d.api.post(d.endPoints.CLIENTE+"Huella",e).then((e=>{(0,P.dF)("Huella guardada correctamente")})).catch((e=>{(0,P.L1)(e)}))})),I=()=>k(this,void 0,void 0,(function*(){let e={cliente:1,huella:h.value};yield d.api.post(d.endPoints.CLIENTE+"HuellaCV",e).then((e=>{alert(e.data.Cliente)})).catch((e=>{(0,P.L1)(e)}))})),H=e=>{p.value=e.Cliente,v.value="",d.api.get(d.endPoints.GYMCLIENTES+"datosCliente",{params:{codigoSpc:e.Cliente,numContrato:0}}).then((e=>{e.data.cliente?(C.value=null===e.data.cliente.FECHA_ACCESO_FIN?"Sin Fecha":_.ZP.formatDate(e.data.cliente.FECHA_ACCESO_FIN,"YYYY-MM-DD"),v.value=null===e.data.cliente.FECHA_ACCESO_FIN?"Sin Fecha":_.ZP.formatDate(e.data.cliente.FECHA_ACCESO_FIN,"DD-MMMM-YYYY")):(v.value="",C.value="")})).catch((e=>{(0,P.L1)(e)}))};return{show:l,numeroFactura:t,serieUsar:n,facturaProductos:o,clientes:r,nombreCliente:c,nit:s,dpi:u,facturaClientes:m,producto:g,imgsrc:h,clienteSelect:p,fechaInicio:f,getClientes:w,asignarCliente:D,completarAsignacion:N,searchFinger:V,searchFinger2:I,getFactura:b,getClientesAsignados:F,fechaVencimiento:v,selectedCliente:H,fechaString:C,eliminarAsignacion:W,optionsFn(e){"Sin Fecha"!=v.value?"Sin Fecha"!=v.value&&_.ZP.getDateDiff(e,C.value)<=1&&((0,P.x2)("La fecha no debe ser menor o igual a la fecha de vencimiento del Cliente"),f.value=null):null==p.value&&((0,P.x2)("Seleccionar al Cliente"),f.value=null)}}},created(){this.getClientes()},watch:{nombreCliente(){this.getClientes()},nit(){this.getClientes()},dpi(){this.getClientes()},show(e){e?(this.getFactura(),this.getClientesAsignados()):(this.numeroFactura=0,this.serieUsar="",this.facturaClientes=[],this.facturaProductos=[])}}});var W=l(11639),N=l(68879),V=l(32074),I=l(44458),H=l(64526),Z=l(90136),S=l(46858),q=l(84277),A=l(31233),Y=l(67220),L=l(50926),Q=l(91487),T=l(13119),x=l(22857),M=l(52765),U=l(92952),G=l(62146),B=l(69984),j=l.n(B);const z=(0,W.Z)(D,[["render",F]]),O=z;j()(D,"components",{QBtn:N.Z,QDialog:V.Z,QCard:I.Z,QBar:H.Z,QSpace:Z.Z,QTooltip:S.Z,QTable:q.Z,QTr:A.Z,QTd:Y.Z,QSeparator:L.Z,QImg:Q.Z,QInput:T.Z,QIcon:x.Z,QPopupProxy:M.Z,QDate:U.Z}),j()(D,"directives",{ClosePopup:G.Z});const R=(0,i.aZ)({components:{GymClientes:O},setup(){const e=(0,E.iH)([]),a=(0,E.iH)(0),l=(0,E.iH)(""),i=(0,E.iH)(""),t=[{name:"factura",field:"Fecha",label:"Fecha",align:"center",format:(e,a)=>`${_.ZP.formatDate(e,"DD-MMMM-YYYY  hh:mm aa")}`},{name:"serie",field:"Serie",label:"Serie",align:"center"},{name:"factura",field:"Factura",label:"Factura",align:"center"},{name:"factura",field:"Nombre",label:"Nombre",align:"center"},{name:"factura",field:"Cantidad",label:"Cantidad",align:"center"}],n=(e,i,t)=>{a.value=i.Factura,l.value=i.Serie},o=()=>{d.api.get(d.endPoints.GYMCLIENTES+"Facturas").then((a=>{e.value=a.data})).catch((e=>{(0,P.L1)(e)}))},r=()=>{o(),a.value=0,l.value=""};return{facturas:e,factura:a,serie:l,getFacturas:o,setDatos:n,limpiar:r,filter:i,columns:t}},created(){this.getFacturas()}});var K=l(69885);const $=(0,W.Z)(R,[["render",u]]),J=$;j()(R,"components",{QPage:K.Z,QBtn:N.Z,QTable:q.Z,QInput:T.Z,QIcon:x.Z})}}]);