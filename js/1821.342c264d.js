"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[1821],{71821:(a,e,l)=>{l.r(e),l.d(e,{default:()=>E});var t=l(59835),r=l(86970),n=l(61957);const o={class:"row"},s={class:"col-xs-12 col-sm-2"},c={class:"col-xs-12 col-sm-3"},i={class:"col-xs-12 col-sm-5"},u={class:"block text-h4"},d=(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th",{class:"text-left"},"Cliente")])],-1),p={class:"text-left"};function w(a,e,l,w,m,f){const g=(0,t.up)("q-btn"),v=(0,t.up)("q-icon"),b=(0,t.up)("q-input"),h=(0,t.up)("q-th"),k=(0,t.up)("q-tr"),C=(0,t.up)("q-td"),F=(0,t.up)("q-markup-table"),_=(0,t.up)("q-table"),y=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(y,{padding:""},{default:(0,t.w5)((()=>[(0,t._)("div",o,[(0,t._)("div",s,[(0,t.Wm)(g,{color:"primary",label:"Cagar Facturas",onClick:a.getFacturas},null,8,["onClick"])]),(0,t._)("div",c,[(0,t.Wm)(g,{color:"red",icon:"cancel",label:"Desasignar",onClick:a.validacion},null,8,["onClick"])]),(0,t._)("div",i,[(0,t._)("div",u,(0,r.zw)(a.serie)+" - "+(0,r.zw)(a.factura),1)])]),(0,t.Wm)(_,{flat:"",bordered:"",title:"Facturas",filter:a.filter,rows:a.facturas,onRowClick:a.setDatos,columns:[{name:"Fecha",field:"Fecha",label:"Fecha",align:"center"},{name:"Serie",field:"Serie",label:"Serie",align:"center"},{name:"Factura",field:"Factura",label:"Factura",align:"center"},{name:"Nombre",field:"Nombre",label:"Nombre",align:"center"}],"row-key":"Factura",dense:"","rows-per-page-options":[0]},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(b,{borderless:"",dense:"",modelValue:a.filter,"onUpdate:modelValue":e[0]||(e[0]=e=>a.filter=e),placeholder:"Buscar Factura",clearable:""},{append:(0,t.w5)((()=>[(0,t.Wm)(v,{name:"search"})])),_:1},8,["modelValue"])])),header:(0,t.w5)((a=>[(0,t.Wm)(k,{props:a},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{"auto-width":""}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.cols,(e=>((0,t.wg)(),(0,t.j4)(h,{key:e.name,props:a},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(e.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,t.w5)((e=>[(0,t.Wm)(k,{props:e,onClick:l=>a.setDatos(e.row),class:(0,r.C_)(e.row.Factura===a.factura?"bg-grey":"")},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{"auto-width":""},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"sm",color:"primary",round:"",dense:"",onClick:a=>e.expand=!e.expand,icon:e.expand?"remove":"add"},null,8,["onClick","icon"])])),_:2},1024),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(a=>((0,t.wg)(),(0,t.j4)(C,{key:a.name,props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,r.zw)(a.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props","onClick","class"]),(0,t.wy)((0,t.Wm)(k,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{colspan:"100%"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,null,{default:(0,t.w5)((()=>[d,(0,t._)("tbody",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.Detalles,(a=>((0,t.wg)(),(0,t.iD)("tr",{key:a.name},[(0,t._)("td",p,(0,r.zw)(a.CodCli+" - "+a.Nombre),1)])))),128))])])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"]),[[n.F8,e.expand]])])),_:1},8,["filter","rows","onRowClick"])])),_:1})}var m=l(34136),f=l(68651),g=l(60499),v=function(a,e,l,t){function r(a){return a instanceof l?a:new l((function(e){e(a)}))}return new(l||(l=Promise))((function(l,n){function o(a){try{c(t.next(a))}catch(e){n(e)}}function s(a){try{c(t["throw"](a))}catch(e){n(e)}}function c(a){a.done?l(a.value):r(a.value).then(o,s)}c((t=t.apply(a,e||[])).next())}))};const b=(0,t.aZ)({components:{},setup(){const a=(0,g.iH)([]),e=(0,g.iH)(0),l=(0,g.iH)(""),t=(0,g.iH)(""),r=a=>{e.value=a.Factura,l.value=a.Serie},n=()=>{m.api.get(m.endPoints.GYMCLIENTES+"FacturasAplicadas").then((e=>{a.value=e.data})).catch((a=>{(0,f.L1)(a)}))},o=()=>{n(),e.value=0,l.value=""},s=()=>{null!=l.value&&0!=e.value&&""!=l.value?(0,f.wp)("Confirmación",`¿Está seguro de Desasignar la Factura:  ${l.value} - ${e.value}  ?`,{onPressOk:()=>v(this,void 0,void 0,(function*(){yield c()}))}):(0,f.x2)("Error",{subtitulo:"Debe Seleccionar una factura",timeout:2e3})},c=()=>v(this,void 0,void 0,(function*(){let a=!1;const t=yield(0,f.UA)("Contraseña","Ingresar el codigo de Autorizacion","password");t?(yield m.api.post(m.endPoints.GYMCLIENTES+"validatePassword",null,{params:{password:t}}).then((e=>{a=!0})).catch((e=>{(0,f.L1)(e),a=!1})),a&&(yield m.api.post(m.endPoints.GYMCLIENTES+"AnularFactura",null,(0,m.configApi)({queryParams:{serie:l.value,factura:e.value}})).then((a=>{(0,f.dF)("Factura desasignada correctamente"),n(),e.value=0,l.value=""})).catch((a=>{(0,f.L1)(a,{timeout:1e4})})))):(0,f.x2)("Debe ingresar la contraseña para Desasignar la factura",{timeout:2500})}));return{facturas:a,factura:e,serie:l,getFacturas:n,setDatos:r,limpiar:o,desasignarFactura:c,validacion:s,filter:t}},created(){this.getFacturas()}});var h=l(11639),k=l(69885),C=l(68879),F=l(84277),_=l(13119),y=l(22857),x=l(31233),D=l(21682),W=l(67220),Z=l(66933),q=l(69984),T=l.n(q);const Q=(0,h.Z)(b,[["render",w]]),E=Q;T()(b,"components",{QPage:k.Z,QBtn:C.Z,QTable:F.Z,QInput:_.Z,QIcon:y.Z,QTr:x.Z,QTh:D.Z,QTd:W.Z,QMarkupTable:Z.Z})}}]);