"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[2551],{32551:(e,a,l)=>{l.r(a),l.d(a,{default:()=>ye});var i=l(59835),o=l(86970),t=l(61957);const n={class:"row"},c={class:"col"},d=(0,i.Uk)("Facturar"),r=(0,i.Uk)("Cambio ubicación destino"),u=(0,i.Uk)("Tomar Pedido"),s=(0,i.Uk)("Liberar pedido"),m=(0,i.Uk)("Cambiar Nit/Dpi"),p={class:"col"},b=(0,i.Uk)("Imprimir"),g=(0,i.Uk)("Cambio dirección"),f=(0,i.Uk)("Cambio Destinatario"),w=(0,i.Uk)("Certificar"),v=(0,i._)("span",{class:"q-ml-sm col-12"},"Ingrese nuevos datos",-1),h={class:"col-12 row"},C=(0,i._)("span",{class:"col-1 q-pt-sm"},"NIT",-1),D=(0,i._)("span",{class:"col q-pt-sm"},"CUI",-1);function k(e,a,l,k,y,P){const W=(0,i.up)("q-btn"),S=(0,i.up)("q-item-section"),_=(0,i.up)("q-item"),I=(0,i.up)("q-separator"),q=(0,i.up)("q-list"),F=(0,i.up)("q-menu"),E=(0,i.up)("q-td"),V=(0,i.up)("q-tr"),U=(0,i.up)("q-table"),Z=(0,i.up)("GLFacturacionDialog"),L=(0,i.up)("GLCambioEnvioDialog"),Q=(0,i.up)("q-toggle"),N=(0,i.up)("q-input"),H=(0,i.up)("q-card-section"),T=(0,i.up)("q-card-actions"),O=(0,i.up)("q-card"),x=(0,i.up)("q-dialog"),j=(0,i.up)("q-page"),G=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(j,{padding:""},{default:(0,i.w5)((()=>[(0,i._)("div",n,[(0,i._)("div",c,[(0,i.Wm)(U,{title:"Pedidos",rows:e.pedidos,columns:e.columnasPedidos,"row-key":"name","rows-per-page-options":[0],style:{height:"400px"},dense:""},{"top-right":(0,i.w5)((()=>[(0,i.Wm)(W,{color:"primary",label:"Cargar",onClick:e.getPedidos},null,8,["onClick"])])),body:(0,i.w5)((a=>[(0,i.Wm)(V,{props:a,onClick:l=>e.getDetalles(a.row.Pedido,a.row.Cliente),class:(0,o.C_)(a.row.Usuario&&e.pedidoSelect===a.row.Pedido?"bg-light-green-14":a.row.Usuario?"bg-light-green-12":"")},{default:(0,i.w5)((()=>[(0,i.Wm)(F,{"touch-position":"","context-menu":"",onBeforeShow:()=>{e.pedidoSelect=a.row.Pedido,e.clienteSelect=a.row.Cliente}},{default:(0,i.w5)((()=>[(0,i.Wm)(q,{style:{"min-width":"100px"}},{default:(0,i.w5)((()=>[(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:e.facturar},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[d])),_:1})])),_:1},8,["onClick"])),[[G]]),(0,i.Wm)(I),(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:e.cambiarDestino},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[r])),_:1})])),_:1},8,["onClick"])),[[G]]),(0,i.Wm)(I),(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:e.tomarPedido},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[u])),_:1})])),_:1},8,["onClick"])),[[G]]),(0,i.Wm)(I),(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:e.liberarPedido},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[s])),_:1})])),_:1},8,["onClick"])),[[G]]),(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:()=>{e.showCambio=!0,e.obsCambio=a.row,e.nitCambio=a.row.Nit}},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[m])),_:1})])),_:2},1032,["onClick"])),[[G]])])),_:2},1024)])),_:2},1032,["onBeforeShow"]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.cols,(e=>((0,i.wg)(),(0,i.j4)(E,{key:e.name,props:a},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props","onClick","class"])])),_:1},8,["rows","columns"]),(0,i.Wm)(U,{title:"Detalles",rows:e.detalles,columns:e.columnasDetalles,"row-key":"name",style:{height:"400px"}},null,8,["rows","columns"])]),(0,i._)("div",p,[(0,i.Wm)(U,{title:"Facturas",rows:e.facturas,columns:e.columnasFacturas,"row-key":"name",dense:"","rows-per-page-options":[0],style:{"min-height":"400px"}},{"top-right":(0,i.w5)((()=>[(0,i.Wm)(W,{color:"primary",label:"Cargar",onClick:e.getFacturas},null,8,["onClick"])])),body:(0,i.w5)((l=>[(0,i.Wm)(V,{props:l},{default:(0,i.w5)((()=>[(0,i.Wm)(F,{"touch-position":"","context-menu":"",onBeforeShow:()=>{e.facturaRowSelect=l.row}},{default:(0,i.w5)((()=>[(0,i.Wm)(q,{style:{"min-width":"100px"}},{default:(0,i.w5)((()=>[(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:e.imprimir},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[b])),_:1})])),_:1},8,["onClick"])),[[G]]),(0,i.Wm)(I),(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:a[0]||(a[0]=a=>e.cambiarDireccion(1))},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[g])),_:1})])),_:1})),[[G]]),(0,i.Wm)(I),(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:a[1]||(a[1]=a=>e.cambiarDireccion(2))},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[f])),_:1})])),_:1})),[[G]]),(0,i.Wm)(I)])),_:1})])),_:2},1032,["onBeforeShow"]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.cols,(e=>((0,i.wg)(),(0,i.j4)(E,{key:e.name,props:l},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns"]),(0,i.Wm)(U,{title:"Pendientes",rows:e.pendientes,columns:e.columnasPendientes,"row-key":"name",style:{height:"400px"}},{"top-right":(0,i.w5)((()=>[(0,i.Wm)(W,{color:"primary",label:"Cargar",onClick:e.getPendientes},null,8,["onClick"])])),body:(0,i.w5)((a=>[(0,i.Wm)(V,{props:a},{default:(0,i.w5)((()=>[(0,i.Wm)(F,{"touch-position":"","context-menu":"",onBeforeShow:()=>{e.facturaRowSelect=a.row}},{default:(0,i.w5)((()=>[(0,i.Wm)(q,{style:{"min-width":"100px"}},{default:(0,i.w5)((()=>[(0,i.wy)(((0,i.wg)(),(0,i.j4)(_,{class:"",clickable:"",dense:"",onClick:e.certificar},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[w])),_:1})])),_:1},8,["onClick"])),[[G]]),(0,i.Wm)(I)])),_:1})])),_:2},1032,["onBeforeShow"]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.cols,(e=>((0,i.wg)(),(0,i.j4)(E,{key:e.name,props:a},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns"])])]),(0,i.Wm)(Z,{ref:"facturacionDialog",Pedido:e.pedidoSelect,onFacturado:a[2]||(a[2]=()=>{e.getPedidos(),e.getFacturas()})},null,8,["Pedido"]),(0,i.Wm)(L,{ref:"cambioEnvioDialog",Cliente:e.clienteSelect},null,8,["Cliente"]),(0,i.Wm)(x,{modelValue:e.showCambio,"onUpdate:modelValue":a[5]||(a[5]=a=>e.showCambio=a)},{default:(0,i.w5)((()=>[(0,i.Wm)(O,null,{default:(0,i.w5)((()=>[(0,i.Wm)(H,{class:"row items-center"},{default:(0,i.w5)((()=>{var l;return[v,(0,i._)("div",h,[C,(0,i.Wm)(Q,{class:"col-2",color:"pink","false-value":"","true-value":"CUI",modelValue:e.tipoCambio,"onUpdate:modelValue":a[3]||(a[3]=a=>e.tipoCambio=a)},null,8,["modelValue"]),D]),(0,i.Wm)(N,{disable:!(null!==(l=e.obsCambio.Observaciones)&&void 0!==l?l:"").includes("ecommerce"),class:"col-12",modelValue:e.nitCambio,"onUpdate:modelValue":a[4]||(a[4]=a=>e.nitCambio=a),type:"text",label:"Nuevo nit",onKeypress:(0,t.D2)(e.cambiarNit,["enter"]),autofocus:"",ref:"nuevoNitRef"},null,8,["disable","modelValue","onKeypress"])]})),_:1}),(0,i.Wm)(T,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(W,{flat:"",label:"Cancel",color:"primary"},null,512),[[G]]),(0,i.Wm)(W,{flat:"",label:"Cambiar",color:"primary",onClick:e.cambiarNit},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var y=l(54170),P=l(34136);function W(e,a,l,t,n,c){const d=(0,i.up)("q-skeleton"),r=(0,i.up)("q-select"),u=(0,i.up)("q-card-section"),s=(0,i.up)("q-btn"),m=(0,i.up)("q-card-actions"),p=(0,i.up)("q-card"),b=(0,i.up)("q-dialog"),g=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(b,{modelValue:e.showDialog,"onUpdate:modelValue":a[3]||(a[3]=a=>e.showDialog=a),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{class:"my-card q-pa-sm",dark:""},{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.ubicacion)+" ",1),e.loading?((0,i.wg)(),(0,i.j4)(d,{key:0,type:"QInput"})):((0,i.wg)(),(0,i.j4)(r,{key:1,dark:"",modelValue:e.departamento,"onUpdate:modelValue":a[0]||(a[0]=a=>e.departamento=a),options:e.departamentos,label:"DEPARTAMENTO",filled:"","option-value":"Departamento","option-label":"Departamento","emit-value":""},null,8,["modelValue","options"])),(0,i.Wm)(r,{dark:"",disable:0==e.municipios.length,modelValue:e.municipio,"onUpdate:modelValue":a[1]||(a[1]=a=>e.municipio=a),options:e.municipios,label:"MUNICIPIO",filled:"","option-value":"Municipio","option-label":"Municipio","emit-value":""},null,8,["disable","modelValue","options"]),(0,i.Wm)(r,{dark:"",disable:0==e.ubicaciones.length,modelValue:e.ubicacion,"onUpdate:modelValue":a[2]||(a[2]=a=>e.ubicacion=a),options:e.ubicaciones,label:"UBICACION",filled:"","option-value":"Codigo","map-options":"","option-label":"Ubicacion","emit-value":""},null,8,["disable","modelValue","options"])])),_:1}),(0,i.Wm)(m,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(s,{flat:"",label:"Cancel",color:"primary"},null,512),[[g]]),(0,i.wy)((0,i.Wm)(s,{label:"Aceptar",color:"primary",onClick:e.guardar},null,8,["onClick"]),[[g]])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var S=l(68651),_=l(60499),I=function(e,a,l,i){function o(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,t){function n(e){try{d(i.next(e))}catch(a){t(a)}}function c(e){try{d(i["throw"](e))}catch(a){t(a)}}function d(e){e.done?l(e.value):o(e.value).then(n,c)}d((i=i.apply(e,a||[])).next())}))};const q=(0,i.aZ)({methods:{show(){this.getData(),this.showDialog=!0}},props:{ref:{type:String},Cliente:{type:Number,required:!0}},emits:["cambioEnvio"],setup(e,{emit:a}){const l=(0,_.iH)(!1),i=(0,_.iH)(!1),o=(0,_.iH)([]),t=(0,_.iH)(""),n=(0,_.iH)(""),c=(0,_.iH)(""),d=()=>I(this,void 0,void 0,(function*(){t.value="",n.value="",c.value="",o.value.length>0||(o.value=[],i.value=!0,yield P.api.get(P.endPoints.PEDIDOSGL+"DeptosGuatex").then((e=>{o.value=e.data})).catch((e=>{(0,S.L1)(e)})),i.value=!1)})),r=()=>{P.api.post(P.endPoints.PEDIDOSGL+"ClienteGuatex",null,(0,P.configApi)({queryParams:{codigo:c.value,cliente:e.Cliente}})).then((e=>{(0,S.dF)("Configuracion guardada"),a("cambioEnvio",!0)})).catch((e=>{(0,S.L1)(e)}))};return{showDialog:l,loading:i,departamentos:o,departamento:t,municipio:n,ubicacion:c,getData:d,guardar:r}},watch:{municipio(){this.ubicacion=""}},computed:{municipios(){let e=this.departamentos.find((e=>e.Departamento===this.departamento));return e?e.Municipios:[]},ubicaciones(){let e=this.departamentos.find((e=>e.Departamento===this.departamento));if(e){let a=e.Municipios.find((e=>e.Municipio===this.municipio));if(a)return a.Ubicaciones}return[]}}});var F=l(11639),E=l(32074),V=l(44458),U=l(63190),Z=l(57133),L=l(26384),Q=l(11821),N=l(68879),H=l(62146),T=l(69984),O=l.n(T);const x=(0,F.Z)(q,[["render",W],["__scopeId","data-v-65719df3"]]),j=x;O()(q,"components",{QDialog:E.Z,QCard:V.Z,QCardSection:U.Z,QSkeleton:Z.ZP,QSelect:L.Z,QCardActions:Q.Z,QBtn:N.Z}),O()(q,"directives",{ClosePopup:H.Z});const G=e=>((0,i.dD)("data-v-4a08284e"),e=e(),(0,i.Cn)(),e),A={key:1,class:"row"},M={class:"row"},B={class:"col-3 q-pa-sm"},R=G((()=>(0,i._)("div",{class:"text-h6"},"DATOS DE ENVIO",-1))),Y={class:"col"},z={key:1};function K(e,a,l,o,t,n){const c=(0,i.up)("q-select"),d=(0,i.up)("q-card-section"),r=(0,i.up)("q-separator"),u=(0,i.up)("q-skeleton"),s=(0,i.up)("q-input"),m=(0,i.up)("q-btn"),p=(0,i.up)("q-card-actions"),b=(0,i.up)("q-card"),g=(0,i.up)("q-dialog"),f=(0,i.up)("GLCambioEnvioDialog"),w=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(g,{modelValue:e.showDialog,"onUpdate:modelValue":a[6]||(a[6]=a=>e.showDialog=a),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{dark:"",bordered:"",class:"my-card"},{default:(0,i.w5)((()=>[(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,{modelValue:e.serie,"onUpdate:modelValue":a[0]||(a[0]=a=>e.serie=a),options:e.series,label:"Serie a facturar",filled:"",dark:""},null,8,["modelValue","options"])])),_:1}),(0,i.Wm)(r,{dark:"",inset:""}),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[e.loading?((0,i.wg)(),(0,i.j4)(u,{key:0,height:"250px",square:""})):((0,i.wg)(),(0,i.iD)("div",A,[(0,i.Wm)(s,{class:"col-6 q-pa-sm","model-value":e.Pedido,type:"text",label:"PEDIDO",dark:"",outlined:"",disable:""},null,8,["model-value"]),(0,i.Wm)(s,{class:"col-6 q-pa-sm","model-value":e.total,type:"text",label:"TOTAL",dark:"",outlined:"",disable:""},null,8,["model-value"]),(0,i.Wm)(s,{class:"col-10 q-pa-sm","model-value":e.nombre,type:"text",label:"NOMBRE",dark:"",outlined:"",disable:""},null,8,["model-value"]),(0,i.Wm)(s,{class:"col-2 q-pa-sm","model-value":e.codigo,type:"text",label:"CÓDIGO",dark:"",outlined:"",disable:""},null,8,["model-value"]),(0,i.Wm)(s,{class:"col-12 q-pa-sm","model-value":e.observaciones,type:"text",label:"OBSERVACIONES",dark:"",outlined:"",disable:""},null,8,["model-value"])]))])),_:1}),(0,i.Wm)(r,{dark:"",inset:""}),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i._)("div",M,[(0,i._)("div",B,[R,(0,i.Wm)(m,{color:"primary",label:"CAMBIO",onClick:a[1]||(a[1]=a=>{var l;return null===(l=e.cambioDialog)||void 0===l?void 0:l.show()})})]),(0,i._)("div",Y,[e.loading?((0,i.wg)(),(0,i.j4)(u,{key:0,height:"200px",width:"100%",square:""})):((0,i.wg)(),(0,i.iD)("div",z,[(0,i.Wm)(s,{modelValue:e.departamento,"onUpdate:modelValue":a[2]||(a[2]=a=>e.departamento=a),type:"text",label:"DEPARTAMENTO",dark:"",outlined:"",disable:""},null,8,["modelValue"]),(0,i.Wm)(s,{modelValue:e.municipio,"onUpdate:modelValue":a[3]||(a[3]=a=>e.municipio=a),type:"text",label:"MUNICIPIO",dark:"",outlined:"",disable:""},null,8,["modelValue"]),(0,i.Wm)(s,{modelValue:e.ubicacion,"onUpdate:modelValue":a[4]||(a[4]=a=>e.ubicacion=a),type:"text",label:"UBICACIÓN",dark:"",outlined:"",disable:""},null,8,["modelValue"])]))])]),e.loading?((0,i.wg)(),(0,i.j4)(u,{key:0,type:"QInput"})):((0,i.wg)(),(0,i.j4)(s,{key:1,modelValue:e.direccion,"onUpdate:modelValue":a[5]||(a[5]=a=>e.direccion=a),type:"text",label:"DIRECCIÓN",dark:"",outlined:"",disable:""},null,8,["modelValue"]))])),_:1}),(0,i.Wm)(p,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(m,{flat:"",label:"Cancelar",color:"primary"},null,512),[[w]]),e.loading?((0,i.wg)(),(0,i.j4)(u,{key:0,type:"QBtn",size:"lg"})):((0,i.wg)(),(0,i.j4)(m,{key:1,label:"Facturar",color:"primary",size:"lg",onClick:e.facturar},null,8,["onClick"]))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.Wm)(f,{ref:"cambioDialog",Cliente:e.codigo,onCambioEnvio:e.getDatos},null,8,["Cliente","onCambioEnvio"])],64)}var X=l(78618),J=function(e,a,l,i){function o(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,t){function n(e){try{d(i.next(e))}catch(a){t(a)}}function c(e){try{d(i["throw"](e))}catch(a){t(a)}}function d(e){e.done?l(e.value):o(e.value).then(n,c)}d((i=i.apply(e,a||[])).next())}))};const $=(0,i.aZ)({components:{GLCambioEnvioDialog:j},name:"GLFacturacionDialog",methods:{show(){this.showDialog=!0,this.getDatos()}},props:{ref:{type:String},Pedido:{type:Number,required:!0}},emits:["facturado"],setup(e,{emit:a}){const l=(0,_.iH)(!1),i=(0,_.iH)(!1),o=(0,_.iH)(0),t=(0,_.iH)(-1),n=(0,_.iH)(""),c=(0,_.iH)(""),d=(0,_.iH)(""),r=(0,_.iH)(""),u=(0,_.iH)(""),s=(0,_.iH)(""),m=(0,_.iH)([]),p=(0,_.iH)(""),b=(0,_.iH)(null),g=()=>J(this,void 0,void 0,(function*(){i.value=!0,yield P.api.get(P.endPoints.PEDIDOSGL+"DatosFacturacion?Pedido="+e.Pedido).then((e=>{o.value=e.data.Total,t.value=e.data.Codigo,n.value=e.data.Nombre,c.value=e.data.Observaciones,d.value=e.data.Departamento,r.value=e.data.Municipio,u.value=e.data.Ubicacion,s.value=e.data.Direccion})).catch((e=>{(0,S.L1)(e)})),i.value=!1})),f=e=>J(this,void 0,void 0,(function*(){e<=0||(yield P.api.get(P.endPoints.SERIES,(0,P.configApi)({queryParams:{bodega:e}})).then((e=>{var a,l,i=(0,X.vM)(e.data.Series,"Tipo");m.value=null!==(l=null===(a=i.find((e=>"FCRE"===e.key)))||void 0===a?void 0:a.values.map((e=>e["Serie"])))&&void 0!==l?l:[],p.value=m.value[0]})).catch((e=>{(0,S.L1)(e)})))})),w=()=>J(this,void 0,void 0,(function*(){yield P.api.post(P.endPoints.PEDIDOSGL+"Facturar",null,(0,P.configApi)({queryParams:{pedido:e.Pedido,serie:p.value}})).then((e=>{(0,S.dF)("Pedido facturado"),l.value=!1,a("facturado",!0)})).catch((e=>{(0,S.L1)(e)}))}));return{showDialog:l,getDatos:g,facturar:w,bodegaClick:f,total:o,codigo:t,nombre:n,observaciones:c,departamento:d,municipio:r,ubicacion:u,direccion:s,loading:i,cambioDialog:b,series:m,serie:p}},created(){this.bodegaClick(16)}});var ee=l(50926),ae=l(13119);const le=(0,F.Z)($,[["render",K],["__scopeId","data-v-4a08284e"]]),ie=le;O()($,"components",{QDialog:E.Z,QCard:V.Z,QCardSection:U.Z,QSelect:L.Z,QSeparator:ee.Z,QSkeleton:Z.ZP,QInput:ae.Z,QBtn:N.Z,QCardActions:Q.Z}),O()($,"directives",{ClosePopup:H.Z});var oe=l(67825),te=l(37655),ne=l(17779),ce=function(e,a,l,i){function o(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,t){function n(e){try{d(i.next(e))}catch(a){t(a)}}function c(e){try{d(i["throw"](e))}catch(a){t(a)}}function d(e){e.done?l(e.value):o(e.value).then(n,c)}d((i=i.apply(e,a||[])).next())}))};const de=[{name:"Pedido",label:"Pedido",field:"Pedido",align:"center",sortable:!0},{name:"Fecha",label:"Fecha",field:"Fecha",align:"center",sortable:!0,format:e=>y.ZP.formatDate(e,"DD/MM/YYYY")},{name:"Total",label:"Total",field:"Total",align:"center"},{name:"Cliente",label:"Cliente",field:"Cliente",align:"center"},{name:"Nit",label:"Nit",field:"Nit",align:"center"},{name:"Nombre cliente",label:"Nombre cliente",field:"Nombre",align:"center"},{name:"Estado",label:"Estado",field:"Estado",align:"center"},{name:"Observaciones",label:"Observaciones",field:"Observaciones",align:"center"},{name:"COD",label:"COD",field:"COD",align:"center"},{name:"Usuario Toma",label:"Usuario Toma",field:"Usuario",align:"center"},{name:"Fecha Toma",label:"Fecha Toma",field:"FechaToma",align:"center",format:e=>y.ZP.formatDate(e,"DD/MM/YYYY hh:mm a")}],re=[{name:"Pedido",label:"Pedido",field:"Pedido",align:"center"},{name:"Codigo",label:"Codigo",field:"Codigo",align:"center"},{name:"Descripcion",label:"Descripcion",field:"Descripcion",align:"center"},{name:"Cantidad",label:"Cantidad",field:"Cantidad",align:"center"},{name:"Precio Venta",label:"Precio Venta",field:"Precio",align:"center"},{name:"Subtotal",label:"Subtotal",field:"Subtotal",align:"center"}],ue=[{name:"Fecha",label:"Fecha",field:"Fecha",align:"center"},{name:"Serie",label:"Serie",field:"Serie",align:"center"},{name:"Factura",label:"Numero Factura",field:"Factura",align:"center"},{name:"Cliente",label:"Cliente",field:"Cliente",align:"center"},{name:"Nombre",label:"Nombre Cliente",field:"Nombre",align:"center"},{name:"Total",label:"Total",field:"Total",align:"center"}],se=[{name:"Fecha",label:"Fecha",field:"Fecha",align:"center"},{name:"Serie",label:"Serie",field:"Serie",align:"center"},{name:"Factura",label:"Factura",field:"Factura",align:"center"},{name:"Contingencia",label:"Contingencia",field:"Contingencia",align:"center"},{name:"Vendedor",label:"Vendedor",field:"Vendedor",align:"center"},{name:"Impresion",label:"Impresion",field:"Impresion",align:"center"}],me=(0,i.aZ)({components:{GLFacturacionDialog:ie,GLCambioEnvioDialog:j},setup(){const e=(0,_.iH)([]),a=(0,_.iH)([]),l=(0,_.iH)([]),i=(0,_.iH)([]),o=(0,_.iH)(0),t=(0,_.iH)(0),n=(0,_.iH)(),c=(0,_.iH)(null),d=(0,_.iH)(null),r=(0,_.iH)(""),u=(0,_.iH)(""),s=(0,_.iH)(),m=(0,_.iH)(!1),p=(0,_.iH)(null),b=()=>{P.api.get(P.endPoints.PEDIDOSGL).then((a=>{e.value=a.data})).catch((e=>{(0,S.L1)(e)}))},g=(e,l)=>{o.value=e,t.value=l,P.api.get(P.endPoints.PEDIDOSGL+e).then((e=>{a.value=e.data})).catch((e=>{(0,S.L1)(e)}))},f=()=>{P.api.get(P.endPoints.PEDIDOSGL+"Facturas").then((e=>{l.value=e.data})).catch((e=>{(0,S.L1)(e)}))},w=()=>{var e;null===(e=c.value)||void 0===e||e.show()},v=()=>{var e;null===(e=d.value)||void 0===e||e.show()},h=()=>{P.api.post(P.endPoints.PEDIDOSGL+"TomarPedido",o.value).then((e=>{b()})).catch((e=>{(0,S.L1)(e)}))},C=()=>{P.api.post(P.endPoints.PEDIDOSGL+"LiberarPedido",o.value).then((e=>{b()})).catch((e=>{(0,S.L1)(e)}))},D=()=>{let e={Factura:n.value.Factura,Serie:n.value.Serie,Sucursal:(0,oe.TT)()};P.api.post(P.endPoints.PEDIDOSGL+"Imprimir",e).then((e=>{k()})).catch((e=>{(0,S.L1)(e)}))},k=()=>ce(this,void 0,void 0,(function*(){yield P.api.post(P.endPoints.FELPENDIENTES,n.value.Factura,(0,P.configApi)({serie:n.value.Serie})).then((e=>{ne.log(e.data);let a=e.data.Uuid;(0,S.dF)("Factura "+n.value.Factura.toString()+" generada correctamente con UUID "+a,{position:"top"}),ne.log(a),y(a)})).catch((e=>{(0,S.L1)(e,{timeout:0})})).finally((()=>{}))})),y=e=>{if((0,oe.Qe)()||(0,oe.tq)()){window.open(oe.qC+e);return}let a={printer:(0,oe.LX)(),url:oe.qC+e,filename:"factura.pdf"};(0,te.Q)("Imprimiendo..."),P.api.post("http://localhost:8001",a).then((e=>{ne.log(e.data),(0,S.dF)(e.data)})).catch((e=>{(0,S.L1)(e)})).finally((()=>{(0,te.E)()}))},W=e=>ce(this,void 0,void 0,(function*(){let a=yield(0,S.UA)("Dirección","Ingrese la nueva dirección"),l={Factura:n.value.Factura,Serie:n.value.Serie,Direccion:a,Tipo:e};P.api.post(P.endPoints.PEDIDOSGL+"CambiarDireccion",l).then((e=>{(0,S.dF)("Dirección cambiada correctamente")})).catch((e=>{(0,S.L1)(e)}))})),I=()=>{P.api.get(P.endPoints.FELPENDIENTES).then((e=>{i.value=e.data})).catch((e=>{(0,S.L1)(e)})).finally((()=>{}))},q=()=>{let e={Pedido:o.value,Sucursal:(0,oe.TT)(),Nit:u.value,Tipo:r.value};P.api.post(P.endPoints.PEDIDOSGL+"CambiarNit",e).then((e=>{(0,S.dF)("Cambiado correctamente"),m.value=!1,b(),u.value="",r.value=""})).catch((e=>{var a;(0,S.L1)(e),null===(a=p.value)||void 0===a||a.select()}))};return{pedidos:e,detalles:a,facturas:l,pendientes:i,columnasPedidos:de,columnasDetalles:re,columnasFacturas:ue,columnasPendientes:se,pedidoSelect:o,clienteSelect:t,facturacionDialog:c,cambioEnvioDialog:d,facturaRowSelect:n,tipoCambio:r,nitCambio:u,obsCambio:s,showCambio:m,nuevoNitRef:p,getPedidos:b,getDetalles:g,getFacturas:f,getPendientes:I,facturar:w,cambiarDestino:v,tomarPedido:h,liberarPedido:C,imprimir:D,cambiarDireccion:W,certificar:k,cambiarNit:q}},created(){this.getPedidos(),this.getFacturas(),this.getPendientes()},watch:{nitCambio(){},tipoCambio(e){var a;(null!==(a=this.obsCambio.Observaciones)&&void 0!==a?a:"").includes("ecommerce")||(this.nitCambio="CUI"===e?this.obsCambio.Dpi:this.obsCambio.NitCliente)}}});var pe=l(69885),be=l(84277),ge=l(31233),fe=l(56362),we=l(13246),ve=l(490),he=l(76749),Ce=l(67220),De=l(23175);const ke=(0,F.Z)(me,[["render",k]]),ye=ke;O()(me,"components",{QPage:pe.Z,QTable:be.Z,QBtn:N.Z,QTr:ge.Z,QMenu:fe.Z,QList:we.Z,QItem:ve.Z,QItemSection:he.Z,QSeparator:ee.Z,QTd:Ce.Z,QDialog:E.Z,QCard:V.Z,QCardSection:U.Z,QToggle:De.Z,QInput:ae.Z,QCardActions:Q.Z}),O()(me,"directives",{ClosePopup:H.Z})}}]);