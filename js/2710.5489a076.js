"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[2710],{32710:(e,n,a)=>{a.r(n),a.d(n,{default:()=>S});var o=a(59835);const l=(0,o.Uk)(" Sin resultados "),i={class:"row"},t={class:"col-xs-12 col-sm-6"},s={class:"col-xs-12 col-sm-6"};function d(e,n,a,d,c,r){const u=(0,o.up)("q-item-section"),p=(0,o.up)("q-item"),g=(0,o.up)("q-select"),v=(0,o.up)("q-btn"),m=(0,o.up)("q-table"),P=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(P,{padding:""},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{modelValue:e.vendedor,"onUpdate:modelValue":n[0]||(n[0]=n=>e.vendedor=n),options:e.vendedoresSelect,label:"Vendedor",filled:"","option-value":"Codigo","option-label":"Nombre",onFilter:e.filterFn,"use-input":"","input-debounce":"0"},{"no-option":(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,{class:"text-grey"},{default:(0,o.w5)((()=>[l])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter"]),(0,o._)("div",i,[(0,o._)("div",t,[(0,o.Wm)(v,{color:"primary",icon:"check",label:"Guardar",onClick:e.savePermission},null,8,["onClick"]),(0,o.Wm)(m,{title:"Páginas",rows:e.paginas,columns:e.columns,"row-key":"IdPagina",selection:"multiple",selected:e.selected,"onUpdate:selected":n[1]||(n[1]=n=>e.selected=n),pagination:{rowsPerPage:0},onRowClick:e.getOpciones},null,8,["rows","columns","selected","onRowClick"])]),(0,o._)("div",s,[(0,o.Wm)(v,{color:"primary",icon:"check",label:"Guardar Opciones",onClick:e.saveOp},null,8,["onClick"]),(0,o.Wm)(m,{title:"Opciones "+e.nombrePagina,rows:e.opciones,columns:e.columnsOp,"row-key":"IdOpcion",selection:"multiple",selected:e.selectedOp,"onUpdate:selected":n[2]||(n[2]=n=>e.selectedOp=n),pagination:{rowsPerPage:0},onRowClick:e.getOpciones},null,8,["title","rows","columns","selected","onRowClick"])])])])),_:1})}var c=a(34136),r=a(68651),u=a(60499);const p=[{name:"IdPagina",label:"Código",field:"IdPagina",align:"center"},{name:"Pagina",label:"Página",field:"Pagina",align:"center"}],g=[{name:"IdOpcion",label:"Código",field:"IdOpcion",align:"center"},{name:"Opcion",label:"Opción",field:"Opcion",align:"center"}],v=(0,o.aZ)({setup(){const e=(0,u.iH)(null);let n=[];const a=(0,u.iH)(n),o=(0,u.iH)([]),l=(0,u.iH)([]),i=(0,u.iH)(""),t=(0,u.iH)(""),s=(0,u.iH)([]),d=(0,u.iH)([]),v=()=>{c.api.get(c.endPoints.DATOSVEND+"List").then((e=>{n=e.data,a.value=n})).catch((e=>{(0,r.L1)(e)}))},m=()=>{c.api.get(c.endPoints.PAGINAS).then((e=>{o.value=e.data})).catch((e=>{(0,r.L1)(e)})),O()},P=(e,n,a)=>{i.value=n.Pagina,t.value=n.IdPagina,c.api.post(c.endPoints.OPCIONES,[n.IdPagina]).then((e=>{l.value=e.data})).catch((e=>{(0,r.L1)(e)})),h()},O=()=>{s.value=[],d.value=[],null!==e.value&&c.api.get(c.endPoints.PERMISOS+"List",(0,c.configApi)({queryParams:{vendedor:e.value.Codigo}})).then((e=>{s.value=[],s.value=e.data.Permisos})).catch((e=>{(0,r.L1)(e)}))},h=()=>{null!==e.value&&c.api.get(c.endPoints.PERMISOS+"ListOpciones",(0,c.configApi)({queryParams:{vendedor:e.value.Codigo,pagina:t.value}})).then((e=>{d.value=[],d.value=e.data.Permisos})).catch((e=>{(0,r.L1)(e)}))},w=()=>{if(null===e.value)return void(0,r.x2)("Debe seleccionar un vendedor");let n=d.value;n.map((n=>{n.Vendedor=e.value.Codigo,n.IdPagina=t.value})),c.api.post(c.endPoints.PERMISOS+"Opciones",n,(0,c.configApi)({queryParams:{vendedor:e.value.Codigo,pagina:t.value}})).then((e=>{(0,r.dF)("Permisos asignados")})).catch((n=>{e.value=null,m(),(0,r.L1)(n)}))},b=()=>{if(null===e.value)return void(0,r.x2)("Debe seleccionar un vendedor");let n=s.value;n.map((n=>{n.Vendedor=e.value.Codigo})),c.api.post(c.endPoints.PERMISOS,n,(0,c.configApi)({queryParams:{vendedor:e.value.Codigo}})).then((e=>{(0,r.dF)("Permisos asignados")})).catch((n=>{e.value=null,m(),(0,r.L1)(n)}))},C=(e,o)=>{o(""!==e?()=>{const o=e.toLowerCase();a.value=n.filter((e=>e.Nombre.toLowerCase().indexOf(o)>-1))}:()=>{a.value=n})};return{getPaginas:m,getVendedores:v,getPermisos:O,getOpciones:P,savePermission:b,saveOp:w,filterFn:C,vendedor:e,vendedores:n,columns:p,paginas:o,opciones:l,vendedoresSelect:a,selected:s,selectedOp:d,columnsOp:g,nombrePagina:i,idPagina:t}},watch:{vendedor(e){this.getPermisos()}},created(){this.getVendedores(),this.getPaginas()}});var m=a(11639),P=a(69885),O=a(26384),h=a(490),w=a(76749),b=a(68879),C=a(84277),f=a(69984),k=a.n(f);const I=(0,m.Z)(v,[["render",d]]),S=I;k()(v,"components",{QPage:P.Z,QSelect:O.Z,QItem:h.Z,QItemSection:w.Z,QBtn:b.Z,QTable:C.Z})}}]);