"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[8774],{8774:(e,a,l)=>{l.r(a),l.d(a,{default:()=>J});var t=l(59835),i=l(86970);const o={class:"row"},r={class:"col col-xs-12 col-sm-4"},n={class:"row"},c={class:"col"},s={key:0,class:"q-pb-sm"},u={class:"row q-mt-sm"},d={class:"col-xs-12 col-sm-6 col-md-5 col-lg-4"},m={class:"col-xs-12 col-sm-6 col-md-7"},v={class:"row full-height"},p={class:"col col-xs-12 col-sm-12"},w={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},f={class:"row"},b={class:"text-center col-2"},h={class:"text-subtitle2"},g={class:"text-center col-2 border-All"},_={class:"col"};function C(e,a,l,C,q,D){const F=(0,t.up)("KeyPageDetect"),k=(0,t.up)("q-select"),Z=(0,t.up)("q-date"),y=(0,t.up)("q-input"),x=(0,t.up)("q-btn"),H=(0,t.up)("q-icon"),V=(0,t.up)("q-card-section"),z=(0,t.up)("q-card"),S=(0,t.up)("q-table"),W=(0,t.up)("q-page-sticky"),Y=(0,t.up)("q-page");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(F),(0,t.Wm)(Y,{class:"q-pa-sm"},{default:(0,t.w5)((()=>{var l,C,q,D;return[(0,t._)("div",o,[(0,t._)("div",r,[(0,t._)("div",n,[(0,t._)("div",c,[(0,t.Wm)(k,{filled:"",modelValue:e.series,"onUpdate:modelValue":a[0]||(a[0]=a=>e.series=a),options:e.seriesVendedor,"use-chips":"","stack-label":"",label:"Series de facturación",multiple:""},null,8,["modelValue","options"])])]),(0,t.Uk)(" "+(0,i.zw)(e.factura)+" - "+(0,i.zw)(e.serie),1)])]),e.dates?((0,t.wg)(),(0,t.iD)("div",s," Del: "+(0,i.zw)(null!==(l=e.dates["from"])&&void 0!==l?l:null!==(C=e.dates)&&void 0!==C?C:"")+" al "+(0,i.zw)(null!==(q=e.dates["to"])&&void 0!==q?q:null!==(D=e.dates)&&void 0!==D?D:""),1)):(0,t.kq)("",!0),(0,t._)("div",u,[(0,t._)("div",d,[(0,t.Wm)(Z,{modelValue:e.dates,"onUpdate:modelValue":a[1]||(a[1]=a=>e.dates=a),range:"","today-btn":"",landscape:""},null,8,["modelValue"])]),(0,t._)("div",m,[(0,t.Wm)(y,{class:"q-mt-lg",modelValue:e.nombreCliente,"onUpdate:modelValue":a[2]||(a[2]=a=>e.nombreCliente=a),type:"text",label:"Nombre del cliente"},null,8,["modelValue"]),(0,t.Wm)(x,{class:"q-pa-sm",color:"primary",icon:"search",label:"Buscar",onClick:e.loadData},null,8,["onClick"])])]),(0,t._)("div",v,[(0,t._)("div",p,[(0,t.Wm)(S,{grid:"",title:"Historial de facturas",filter:e.filter,rows:e.data,columns:e.columns,onRowClick:e.selectFact,"virtual-scroll":"","virtual-scroll-item-size":48,"virtual-scroll-sticky-size-start":48,"rows-per-page-options":[0],pagination:{rowsPerPage:0},loading:e.recargarLoad},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(y,{borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":a[3]||(a[3]=a=>e.filter=a),placeholder:"Buscar factura",clearable:""},{append:(0,t.w5)((()=>[(0,t.Wm)(H,{name:"search"})])),_:1},8,["modelValue"])])),item:(0,t.w5)((a=>[(0,t._)("div",w,[(0,t.Wm)(z,{class:(0,i.C_)(["cursor-pointer q-hoverable",e.factura===a.row.Factura?"shadow-24 bg-grey":""]),onClick:l=>e.selectFact(null,a.row,a.rowIndex)},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{class:"q-pa-none"},{default:(0,t.w5)((()=>[(0,t._)("div",f,[(0,t._)("div",b,[(0,t._)("div",null,(0,i.zw)(e.date.formatDate(a.row.Fecha,"MMM")),1),(0,t._)("div",h,(0,i.zw)(e.date.formatDate(a.row.Fecha,"DD")),1),(0,t._)("div",null,(0,i.zw)(e.date.formatDate(a.row.Fecha,"YYYY")),1)]),(0,t._)("div",g,[(0,t._)("div",null,(0,i.zw)(a.row.Serie),1),(0,t._)("div",null,(0,i.zw)(a.row.Factura),1)]),(0,t._)("div",_,[(0,t._)("div",null,(0,i.zw)(a.row.NitCliente),1),(0,t._)("div",null,(0,i.zw)(a.row.NombreCliente),1),(0,t._)("div",null,"Q."+(0,i.zw)(a.row.Total),1)])])])),_:2},1024)])),_:2},1032,["class","onClick"])])])),_:1},8,["filter","rows","columns","onRowClick","loading"])])]),(0,t.Wm)(W,{position:"top",offset:[25,40]},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{disable:0===e.factura,class:"q-ma-xs",color:"primary",icon:"send",label:"Enviar Factura: "+e.factura+" - "+e.serie,onClick:e.send},null,8,["disable","label","onClick"]),(0,t.Wm)(x,{disable:0===e.factura,class:"q-ma-xs",color:"primary",icon:"print",label:"Reimprimir "+e.factura+" - "+e.serie,onClick:e.reimprimir},null,8,["disable","label","onClick"])])),_:1})]})),_:1})],64)}var q=l(34136),D=l(68651),F=l(60499),k=l(30336),Z=l(54170),y=l(67825),x=(l(37655),l(78618)),H=(l(17779),function(e,a,l,t){function i(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,o){function r(e){try{c(t.next(e))}catch(a){o(a)}}function n(e){try{c(t["throw"](e))}catch(a){o(a)}}function c(e){e.done?l(e.value):i(e.value).then(r,n)}c((t=t.apply(e,a||[])).next())}))});const V=[{name:"Fecha",label:"Fecha",field:"Fecha",align:"center",format:(e,a)=>`${Z.ZP.formatDate(e,"DD-MM-YYYY hh:mm aa")}`},{name:"Nit",label:"Nit",field:"NitCliente",align:"center"},{name:"Cliente",label:"Cliente",field:"NombreCliente",align:"center"},{name:"Total",label:"Total",field:"Total",align:"center"},{name:"Serie",label:"Serie",field:"Serie",align:"center"},{name:"Factura",label:"Factura",field:"Factura",align:"center"},{name:"UUID",label:"UUID",field:"Uuid",align:"center"}],z=(0,t.aZ)({name:"HistorialFacturas",components:{KeyPageDetect:k.Z},setup(e,{emit:a}){const l=(0,F.iH)([]),t=(0,F.iH)(""),i=(0,F.iH)(0),o=(0,F.iH)(""),r=(0,F.iH)(!1),n=(0,F.iH)(!1),c=(0,F.iH)(""),s=((0,F.iH)(""),(0,F.iH)(!1)),u=(0,F.iH)(""),d=(0,F.iH)([]),m=(0,F.iH)([]),v=Z.ZP.formatDate(Date.now(),"YYYY/MM/DD"),p=(0,F.iH)(v);(0,y.JT)()&&m.value.push((0,y.JT)()),(0,y.V6)()&&m.value.push((0,y.V6)()),(0,y.dS)()&&m.value.push((0,y.dS)()),(0,y.nZ)()&&m.value.push((0,y.nZ)()),d.value=m.value;const w=()=>{var e,a;if(i.value=0,o.value="",r.value=!0,null==p.value)return;const t={FechaInicial:null!==(e=p.value["from"])&&void 0!==e?e:p.value,FechaFinal:null!==(a=p.value["to"])&&void 0!==a?a:p.value,NombreCliente:u.value,Series:d.value};q.api.post(q.endPoints.FACTURAS,t).then((e=>{l.value=e.data.Encabezado})).catch((e=>{(0,D.L1)(e)})).finally((()=>{r.value=!1}))},f=(e,a,l)=>{i.value=0,o.value=a.Serie,c.value=a.Uuid,i.value=a.Factura},b=()=>{window.open(y.qC+c.value,"Facturawt")},h=()=>H(this,void 0,void 0,(function*(){b(),yield(0,x._R)(500),i.value=0,o.value=""})),g=()=>{let e=y.qC+c.value,a="Puede ver tú factura en el siguiente enlace \n "+e;var l="https://wa.me/?text="+a;window.open(l,"Facturawt")};return{date:Z.ZP,loadData:w,selectFact:f,reimprimir:h,send:g,factura:i,serie:o,data:l,loadError:n,recargarLoad:r,columns:V,filter:t,showImprimir:s,dates:p,nombreCliente:u,series:d,seriesVendedor:m}},created(){this.loadData()}});var S=l(11639),W=l(69885),Y=l(68879),P=l(26384),Q=l(92952),U=l(13119),T=l(84277),N=l(22857),I=l(44458),M=l(63190),R=l(50926),A=l(30627),B=l(69984),E=l.n(B);const L=(0,S.Z)(z,[["render",C]]),J=L;E()(z,"components",{QPage:W.Z,QBtn:Y.Z,QSelect:P.Z,QDate:Q.Z,QInput:U.Z,QTable:T.Z,QIcon:N.Z,QCard:I.Z,QCardSection:M.Z,QSeparator:R.Z,QPageSticky:A.Z})}}]);