"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[4221],{84221:(e,a,l)=>{l.r(a),l.d(a,{default:()=>A});var t=l(59835),i=l(86970);const r={class:"row"},o={class:"col col-xs-12 col-sm-2"},n={class:"row"},c={class:"col"},s={class:"q-mt-xl",style:{height:"75vh"}},u={class:"row full-height"},d={class:"col col-xs-12 col-sm-12"},m={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},p={class:"row"},v={class:"text-center col-2"},w={class:"text-subtitle2"},f={class:"col"};function h(e,a,l,h,g,b){const _=(0,t.up)("KeyPageDetect"),C=(0,t.up)("q-btn"),F=(0,t.up)("q-icon"),k=(0,t.up)("q-input"),q=(0,t.up)("q-card-section"),D=(0,t.up)("q-card"),y=(0,t.up)("q-table"),x=(0,t.up)("q-page-sticky"),H=(0,t.up)("q-page");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(_),(0,t.Wm)(H,{class:"q-pa-sm"},{default:(0,t.w5)((()=>[(0,t._)("div",r,[(0,t._)("div",o,[(0,t._)("div",n,[(0,t._)("div",c,[(0,t.Wm)(C,{color:"primary",icon:"cached",label:"Recargar",onClick:e.loadData,loading:e.recargarLoad},null,8,["onClick","loading"])])]),(0,t.Uk)(" "+(0,i.zw)(e.factura)+" - "+(0,i.zw)(e.serie),1)])]),(0,t._)("div",s,[(0,t._)("div",u,[(0,t._)("div",d,[(0,t.Wm)(y,{grid:"",title:"Historial",class:"full-height q-pa-xs",filter:e.filter,rows:e.data,columns:e.columns,onRowClick:e.selectFact,"rows-per-page-options":[0],pagination:{rowsPerPage:0},loading:e.recargarLoad},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(k,{borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":a[0]||(a[0]=a=>e.filter=a),placeholder:"Buscar factura",clearable:""},{append:(0,t.w5)((()=>[(0,t.Wm)(F,{name:"search"})])),_:1},8,["modelValue"])])),item:(0,t.w5)((a=>[(0,t._)("div",m,[(0,t.Wm)(D,{class:(0,i.C_)(["cursor-pointer q-hoverable",e.factura===a.row.Factura?"shadow-24 bg-grey":""]),onClick:l=>e.selectFact(null,a.row,a.rowIndex)},{default:(0,t.w5)((()=>[(0,t.Wm)(q,{class:"q-pa-none"},{default:(0,t.w5)((()=>[(0,t._)("div",p,[(0,t._)("div",v,[(0,t._)("div",null,(0,i.zw)(e.date.formatDate(a.row.Fecha,"MMM")),1),(0,t._)("div",w,(0,i.zw)(e.date.formatDate(a.row.Fecha,"DD")),1),(0,t._)("div",null,(0,i.zw)(e.date.formatDate(a.row.Fecha,"YYYY")),1)]),(0,t._)("div",f,[(0,t._)("div",null,(0,i.zw)(a.row.NitCliente),1),(0,t._)("div",null,(0,i.zw)(a.row.NombreCliente),1),(0,t._)("div",null,"Q."+(0,i.zw)(a.row.Total),1)])])])),_:2},1024)])),_:2},1032,["class","onClick"])])])),_:1},8,["filter","rows","columns","onRowClick","loading"])])])]),(0,t.Wm)(x,{position:"top",offset:[25,40]},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{disable:0===e.factura,class:"q-ma-xs",color:"primary",icon:"send",label:"Enviar Factura: "+e.factura+" - "+e.serie,onClick:e.send},null,8,["disable","label","onClick"]),(0,t.Wm)(C,{disable:0===e.factura,class:"q-ma-xs",color:"primary",icon:"print",label:"Reimprimir "+e.factura+" - "+e.serie,onClick:e.reimprimir},null,8,["disable","label","onClick"])])),_:1})])),_:1})],64)}var g=l(34136),b=l(68651),_=l(60499),C=l(30336),F=l(54170),k=l(67825),q=l(37655),D=l(78618),y=l(17779),x=function(e,a,l,t){function i(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,r){function o(e){try{c(t.next(e))}catch(a){r(a)}}function n(e){try{c(t["throw"](e))}catch(a){r(a)}}function c(e){e.done?l(e.value):i(e.value).then(o,n)}c((t=t.apply(e,a||[])).next())}))};const H=[{name:"Fecha",label:"Fecha",field:"Fecha",align:"center",format:(e,a)=>`${F.ZP.formatDate(e,"DD-MM-YYYY hh:mm aa")}`},{name:"Nit",label:"Nit",field:"NitCliente",align:"center"},{name:"Cliente",label:"Cliente",field:"NombreCliente",align:"center"},{name:"Total",label:"Total",field:"Total",align:"center"},{name:"Serie",label:"Serie",field:"Serie",align:"center"},{name:"Factura",label:"Factura",field:"Factura",align:"center"},{name:"UUID",label:"UUID",field:"Uuid",align:"center"}],Z=(0,t.aZ)({name:"HistorialFacturas",components:{KeyPageDetect:C.Z},setup(e,{emit:a}){const l=(0,_.iH)([]),t=(0,_.iH)([]),i=(0,_.iH)(""),r=(0,_.iH)(0),o=(0,_.iH)(""),n=(0,_.iH)(!1),c=(0,_.iH)(!1),s=(0,_.iH)(""),u=((0,_.iH)(""),(0,_.iH)(!1)),d=()=>{r.value=0,o.value="",t.value=[],n.value=!0,g.api.get(g.endPoints.FACTURAS+"Historial").then((e=>{l.value=e.data.Encabezado})).catch((e=>{(0,b.L1)(e)})).finally((()=>{n.value=!1}))},m=(e,a,l)=>{r.value=0,o.value=a.Serie,s.value=a.Uuid,r.value=a.Factura},p=()=>{let e=5,l=5;screen.width,screen.height;let t="#/Reportes/FACTURA/"+o.value+"/"+r.value.toString();y.log(t),(0,q.Q)("Imprimiendo...",void 0,void 0,"QSpinnerRadio");try{var i=window.open(t,"Factura","addressbar=no,directories=0,titlebar=0,toolbar=0,location=0,status=0,menubar=0,scrollbars=no,width="+e+", height="+l+", top=0, left=0");(0,q.E)();const r=setInterval((()=>{(null===i||void 0===i?void 0:i.closed)&&(clearInterval(r),a("facturado",!0))}),500)}catch(n){y.log(n)}(0,q.E)()},v=()=>x(this,void 0,void 0,(function*(){p(),yield(0,D._R)(500),r.value=0,o.value="",t.value=[]})),w=()=>{let e=k.qC+s.value,a="Puede ver t√∫ factura en el siguiente enlace \n "+e;var l="https://wa.me/?text="+a;window.open(l,"Facturawt")};return{date:F.ZP,loadData:d,selectFact:m,reimprimir:v,send:w,factura:r,serie:o,data:l,dataErrores:t,loadError:c,recargarLoad:n,columns:H,filter:i,showImprimir:u}},created(){this.loadData()}});var Q=l(11639),P=l(69885),W=l(68879),S=l(84277),U=l(13119),z=l(22857),I=l(44458),R=l(63190),T=l(50926),Y=l(30627),E=l(69984),N=l.n(E);const M=(0,Q.Z)(Z,[["render",h]]),A=M;N()(Z,"components",{QPage:P.Z,QBtn:W.Z,QTable:S.Z,QInput:U.Z,QIcon:z.Z,QCard:I.Z,QCardSection:R.Z,QSeparator:T.Z,QPageSticky:Y.Z})}}]);