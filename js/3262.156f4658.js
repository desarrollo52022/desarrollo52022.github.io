"use strict";(globalThis["webpackChunkposweb"]=globalThis["webpackChunkposweb"]||[]).push([[3262],{73262:(e,l,o)=>{o.r(l),o.d(l,{default:()=>F});var a=o(59835),t=o(86970);const d={class:"row q-gutter-md"},i={class:"col-xs-3 col-md-2"},n={class:"col-xs-9 col-md-4"},c={class:"col-xs-9 col-md-3 q-pl-m2"},s={class:"col-xs-4 col-sm-2 col-md-2"},u={style:{height:"500px"}},r={class:"row q-ma-md q-gutter-xs"},p={class:"col-12"},m={class:"row q-ma-md"},v={class:"col"},g={class:"col col-xs-12 col-md-8"},b={class:"row"},w={class:"col"},D={class:"row q-pt-lg q-pb-lg"},E={class:"col q-pa-sm col-md-4"},P={class:"col q-pa-sm col-md-8"};function h(e,l,o,h,_,f){const I=(0,a.up)("q-input"),C=(0,a.up)("q-select"),S=(0,a.up)("q-toggle"),y=(0,a.up)("q-btn"),T=(0,a.up)("q-form"),W=(0,a.up)("q-td"),V=(0,a.up)("q-table"),R=(0,a.up)("q-card-actions"),N=(0,a.up)("q-card"),q=(0,a.up)("q-dialog"),L=(0,a.up)("q-icon"),O=(0,a.up)("q-page"),x=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(O,{padding:""},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{onSubmit:e.submitForm,class:"q-gutter-md",onReset:e.clearForm},{default:(0,a.w5)((()=>[(0,a._)("div",d,[(0,a._)("div",i,[(0,a.Wm)(I,{outlined:"",modelValue:e.codigo,"onUpdate:modelValue":l[0]||(l[0]=l=>e.codigo=l),type:"number",label:"Codigo Tipo Instalación",disable:""},null,8,["modelValue"])]),(0,a._)("div",n,[(0,a.Wm)(I,{outlined:"",modelValue:e.descripcion,"onUpdate:modelValue":l[1]||(l[1]=l=>e.descripcion=l),type:"text",label:"Descripción Instalación",rules:[e=>!!e||"La descripcion no puede estar vacia",e=>e.length<=50||"La descripcion no puede ser mayor a 50 caracteres",e=>""!==e.trim()||"La descripcion no puede estar vacia"]},null,8,["modelValue","rules"])]),(0,a._)("div",c,[(0,a.Wm)(C,{outlined:"",modelValue:e.modelOrden,"onUpdate:modelValue":[l[2]||(l[2]=l=>e.modelOrden=l),l[3]||(l[3]=l=>e.changeSelectedTipo(l.value))],options:e.optionsOrden,label:"Tipo Orden de Instalacion"},null,8,["modelValue","options"])]),(0,a._)("div",s,[(0,a.Wm)(S,{modelValue:e.estado,"onUpdate:modelValue":l[4]||(l[4]=l=>e.estado=l),color:"green",label:"Estado","left-label":""},null,8,["modelValue"])])]),(0,a._)("div",null,[(0,a.Wm)(y,{label:"Guardar",type:"submit",color:"primary",icon:"save"}),(0,a.Wm)(y,{label:"Limpiar",type:"reset",color:"primary",icon:"restart_alt",flat:"",class:"q-ml-sm"})])])),_:1},8,["onSubmit","onReset"]),(0,a._)("div",u,[(0,a.Wm)(V,{class:"full-height full-with",title:"Tipos Instalaciones",rows:e.gridRows,columns:e.gridCols,pagination:{rowsPerPage:0},onRowClick:e.selectedInstal},{"body-cell-Detalle":(0,a.w5)((l=>[(0,a.Wm)(W,{props:l,style:{padding:"0px",width:"5px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{outline:"",color:"blue",icon:"description",onClick:o=>e.mostrarModal(l.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["rows","columns","onRowClick"])]),(0,a._)("template",null,[(0,a.Wm)(q,{modelValue:e.showModalDetalle,"onUpdate:modelValue":l[7]||(l[7]=l=>e.showModalDetalle=l),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{ref:"formModal",onSubmit:e.updateDetalleInst,onReset:e.clearModal},{default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a._)("h6",p,(0,t.zw)(e.selectedTipoInstal),1),(0,a.Wm)(I,{outlined:"",class:"col-8",modelValue:e.DescripcionModel,"onUpdate:modelValue":l[5]||(l[5]=l=>e.DescripcionModel=l),type:"text",label:"Descripcion",rules:[e=>!!e||"Obligatorio"]},null,8,["modelValue","rules"]),(0,a.Wm)(I,{outlined:"",class:"col-3",modelValue:e.cantidadModel,"onUpdate:modelValue":l[6]||(l[6]=l=>e.cantidadModel=l),type:"number",label:"Cantidad",rules:[e=>!!e||"Obligatorio",e=>e>=0||"Debe ser mayor a Cero"]},null,8,["modelValue","rules"])]),(0,a.Wm)(V,{class:"puntosDialog",rows:e.modalGridRows,columns:e.modalGridCols,columns_filter:!1,onRowClick:e.selectedDetalle},{"body-cell-Producto":(0,a.w5)((l=>[(0,a.Wm)(W,{props:l,style:{padding:"0px",width:"5px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{outline:"",color:"primary",icon:"edit_note",onClick:o=>e.loadModalProducts(null,l.row,null)},null,8,["onClick"])])),_:2},1032,["props"])])),"body-cell-Eliminar":(0,a.w5)((l=>[(0,a.Wm)(W,{props:l,style:{padding:"0px",width:"5px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{outline:"",color:"red",icon:"delete_forever",onClick:o=>e.deleteDetalle(l.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["rows","columns","onRowClick"]),(0,a.Wm)(R,{align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(y,{label:"Cancelar",color:"negative",onClick:e.limpiarModal},null,8,["onClick"]),[[x]]),(0,a.Wm)(y,{label:"Guardar",type:"submit",color:"primary"})])),_:1})])),_:1},8,["onSubmit","onReset"])])),_:1})])),_:1},8,["modelValue"])]),(0,a._)("template",null,[(0,a.Wm)(q,{modelValue:e.showModalProd,"onUpdate:modelValue":l[12]||(l[12]=l=>e.showModalProd=l),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{bordered:""},{default:(0,a.w5)((()=>[(0,a._)("div",m,[(0,a._)("div",v,[(0,a._)("p",null,(0,t.zw)(e.DescripcionModel),1)]),(0,a._)("div",g,[(0,a.Wm)(I,{filled:"",dense:"",debounce:"500",clearable:"",modelValue:e.filtroBusqueda,"onUpdate:modelValue":[l[8]||(l[8]=l=>e.filtroBusqueda=l),l[9]||(l[9]=l=>e.buscarProd())],label:"Buscar código de producto"},{append:(0,a.w5)((()=>[(0,a.Wm)(L,{name:"search"})])),_:1},8,["modelValue"])])]),(0,a._)("div",b,[(0,a._)("div",w,[(0,a.Wm)(V,{dense:"",style:{height:"400px"},title:"Productos Sugeridos",rows:e.productRows,columns:e.productCols,pagination:{rowsPerPage:0},"no-data-label":"Sin Registros",onRowClick:e.onSelectedProd},null,8,["rows","columns","onRowClick"]),(0,a.Wm)(T,{onSubmit:e.submitProd,class:"q-gutter-md"},{default:(0,a.w5)((()=>[(0,a._)("div",D,[(0,a._)("div",E,[(0,a.Wm)(I,{outlined:"",modelValue:e.selectedCodProd,"onUpdate:modelValue":l[10]||(l[10]=l=>e.selectedCodProd=l),disable:"",type:"text",label:"Codigo Producto"},null,8,["modelValue"])]),(0,a._)("div",P,[(0,a.Wm)(I,{outlined:"",modelValue:e.selectedDescProd,"onUpdate:modelValue":l[11]||(l[11]=l=>e.selectedDescProd=l),disable:"",type:"text",label:"Descripción Producto"},null,8,["modelValue"])])]),(0,a.Wm)(R,{align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(y,{label:"Cancelar",color:"negative",onClick:e.limpiarModalProd},null,8,["onClick"]),[[x]]),(0,a.Wm)(y,{label:"Guardar",type:"submit",color:"primary"})])),_:1})])),_:1},8,["onSubmit"])])])])),_:1})])),_:1},8,["modelValue"])])])),_:1})}var _=o(34136),f=o(68651),I=o(60499),C=function(e,l,o,a){function t(e){return e instanceof o?e:new o((function(l){l(e)}))}return new(o||(o=Promise))((function(o,d){function i(e){try{c(a.next(e))}catch(l){d(l)}}function n(e){try{c(a["throw"](e))}catch(l){d(l)}}function c(e){e.done?o(e.value):t(e.value).then(i,n)}c((a=a.apply(e,l||[])).next())}))};const S=(0,a.aZ)({name:"InstalacionesAdmin",setup(){let e,l=(0,I.iH)(""),o=(0,I.iH)(""),a=(0,I.iH)(""),t=(0,I.iH)(""),d=(0,I.iH)("");const i=(0,I.iH)(!1),n=(0,I.iH)(""),c=(0,I.iH)(!1),s=(0,I.iH)(0),u=(0,I.iH)(""),r=(0,I.iH)(0),p=(0,I.iH)(0),m=(0,I.iH)(null),v=(0,I.iH)(null),g=(0,I.iH)(!0);let b=(0,I.iH)(null);const w=(0,I.iH)([]),D=(0,I.iH)([]);let E=(0,I.iH)(null);const P=(0,I.iH)([]),h=(0,I.iH)([]),S=(0,I.iH)([]),y=()=>{s.value=0,u.value="",A()},T=e=>{b.value=e},W=(e,l,t)=>{o.value=l.Producto,a.value=l.Descripcion,d.value=l.Lote},V=()=>{o.value="",a.value="",d.value="",S.value=[],n.value=""},R=()=>C(this,void 0,void 0,(function*(){null!==n.value&&""!==n.value?yield _.api.get(_.endPoints.ORDENES_PENDIENTES+"busquedaProd",{params:{producto:n.value}}).then((e=>{S.value=e.data.Productos})).catch((e=>{(0,f.L1)(e)})):S.value=[]})),N=(e,l,t)=>C(this,void 0,void 0,(function*(){Q(e,l,t),yield _.api.get(_.endPoints.ORDENES_PENDIENTES+"detalleTipoInstalacion",{params:{idTipoInstalacion:r.value}}).then((e=>{const l=e.data.Producto;l&&(o.value=l.Producto,a.value=l.Descripcion)})).catch((e=>{(0,f.L1)(e)})),c.value=!0})),q=()=>{p.value=0,m.value=null,v.value=null,g.value=!0,b.value=null,D.value=[],E.value=null,H()},L=()=>{null!==b.value?_.api.post(_.endPoints.ORDENES_PENDIENTES+"AltaTiposInst",null,{params:{tipo_instalacion:p.value,desc:m.value,tipo_orden:b.value,estado:1==g.value?"A":"I"}}).then((e=>{(0,f.dF)("Registro guardado"),q(),M()})).catch((e=>{(0,f.L1)(e)})):(0,f.x2)("Debe seleccionar un tipo de instalacion!")},O=()=>C(this,void 0,void 0,(function*(){o.value&&a.value?yield _.api.post(_.endPoints.ORDENES_PENDIENTES+"UpdateProdSugerido",null,{params:{idDet:r.value,idTipo:p.value,prodDet:o.value,loteDet:d.value}}).then((e=>{200===e.status&&(0,f.dF)("Registro Guardado")})).catch((e=>{(0,f.L1)(e)})):(0,f.x2)("Error, Debe Seleccionar un Producto!")})),x=(e,l,o)=>{p.value=l.value,m.value=l.label,v.value=l.tipo_orden,E.value=l.tipo_orden,g.value="A"==l.estado,D.value.forEach((e=>{e.label===l.tipo_orden&&(b.value=e.value)}))},M=()=>{_.api.get(_.endPoints.ORDENES_PENDIENTES+"TiposInstalaciones").then((e=>{P.value=e.data.TIPOS_INSTALACIONES})).catch((e=>{(0,f.L1)(e)}))},H=()=>{_.api.get(_.endPoints.ORDENES_PENDIENTES+"TipoOrden").then((e=>{const{data:l}=e;D.value=l.TIPOS_ORDENES})).catch((e=>{(0,f.L1)(e)}))},k=o=>C(this,void 0,void 0,(function*(){e=o,l.value=o.label,yield _.api.get(_.endPoints.ORDENES_PENDIENTES+"DetalleTipoInst",{params:{tipoInstalacion:o.value}}).then((e=>{h.value=e.data.DETALLE})).catch((e=>{(0,f.L1)(e)})),i.value=!0})),Z=l=>C(this,void 0,void 0,(function*(){i.value=!1,yield _.api.post(_.endPoints.ORDENES_PENDIENTES+"Updetalles",null,{params:{id:r.value,tipoInstalacion:p.value,detalle:u.value,cantidad:s.value}}).then((e=>{h.value=e.data.DETALLE})).catch((e=>{(0,f.L1)(e)})),yield k(e),y(),A(),(0,f.dF)("Registro Actualizado"),i.value=!0})),U=l=>C(this,void 0,void 0,(function*(){i.value=!1,yield _.api.post(_.endPoints.ORDENES_PENDIENTES+"Updetalles",null,{params:{id:l.Id,tipoInstalacion:-1,detalle:u.value,cantidad:s.value}}).then((e=>{h.value=e.data.DETALLE})).catch((e=>{(0,f.L1)(e)})),yield k(e),(0,f.dF)("Registro Eliminado"),i.value=!0})),Q=(e,l,o)=>{r.value=l.Id,s.value=l.Cantidad,u.value=l.Descripcion},A=()=>{r.value=0,s.value=0,u.value=""},F=[{name:"Producto",label:"Producto",field:"Producto",align:"center"},{name:"Descripcion",label:"Descripcion",field:"Descripcion",align:"center"},{name:"Lote",label:"Lote",field:"Lote",align:"center"},{name:"DescripcionLote",label:"DescripcionLote",field:"DescripcionLote",align:"center"}],G=[{name:"value",label:"Código",field:"value",align:"center"},{name:"label",label:"Descripcion",field:"label",align:"center"},{name:"estado",label:"Estado",field:"estado",align:"center"},{name:"tipo_orden",label:"Tipo Orden",field:"tipo_orden",align:"center"},{name:"Detalle",label:"Detalle Sugeridos",field:"Detalle",align:"center",headerStyle:"padding:0px; padding-right:16px; width:50px;"}],B=[{name:"Id",label:"Id",field:"Id",align:"center"},{name:"Descripcion",label:"Descripcion",field:"Descripcion",align:"center"},{name:"Cantidad",label:"Cantidad Sugerida",field:"Cantidad",align:"center"},{name:"Producto",label:"Producto",field:"Producto",align:"center"},{name:"Eliminar",label:"Eliminar",field:"Eliminar",align:"center"}];return{selectedId:t,clearModal:A,deleteDetalle:U,selectedDetalle:Q,selectedIdDetalle:r,updateDetalleInst:Z,selectedTipoInstal:l,modalGridCols:B,modalGridRows:h,mostrarModal:k,limpiarModal:y,showModalDetalle:i,showModalProd:c,DescripcionModel:u,cantidadModel:s,codigo:p,descripcion:m,tipoOrden:v,instalaciones:w,optionsOrden:D,modelOrden:E,clearForm:q,submitForm:L,gridRows:P,gridCols:G,selectedInstal:x,getInstalaciones:M,estado:g,getTipoOrden:H,changeSelectedTipo:T,loadModalProducts:N,filtroBusqueda:n,productCols:F,productRows:S,selectedDescProd:a,selectedCodProd:o,onSelectedProd:W,selectedLote:d,limpiarModalProd:V,buscarProd:R,submitProd:O}},created(){this.getInstalaciones(),this.getTipoOrden()}});var y=o(11639),T=o(69885),W=o(8326),V=o(13119),R=o(26384),N=o(23175),q=o(68879),L=o(84277),O=o(67220),x=o(32074),M=o(44458),H=o(11821),k=o(22857),Z=o(62146),U=o(69984),Q=o.n(U);const A=(0,y.Z)(S,[["render",h]]),F=A;Q()(S,"components",{QPage:T.Z,QForm:W.Z,QInput:V.Z,QSelect:R.Z,QToggle:N.Z,QBtn:q.Z,QTable:L.Z,QTd:O.Z,QDialog:x.Z,QCard:M.Z,QCardActions:H.Z,QIcon:k.Z}),Q()(S,"directives",{ClosePopup:Z.Z})}}]);